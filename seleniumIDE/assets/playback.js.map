{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///./content/commands-api.js","webpack:///../node_modules/scroll-into-view-if-needed/es/index.js","webpack:///../node_modules/compute-scroll-into-view/es/index.js","webpack:///./content/escape.js","webpack:///./content/selenium-api.js","webpack:///./content/selenium-browserbot.js","webpack:///./content/PatternMatcher.js","webpack:///./content/targetSelector.js","webpack:///./content/region.js","webpack:///./content/prompt-injector.js"],"names":["root","factory","exports","module","define","amd","a","i","self","this","__WEBPACK_IMPORTED_MODULE_7__prompt_injector__","__webpack_require__","selenium","__WEBPACK_IMPORTED_MODULE_3__selenium_api__","__WEBPACK_IMPORTED_MODULE_4__selenium_browserbot__","createForWindow","window","__webpack_exports__","locatorBuilders","__WEBPACK_IMPORTED_MODULE_5__locatorBuilders__","targetSelector","contentSideexTabId","doCommands","request","_sender","sendResponse","commands","preprocessParameter","new_page","sideex_new_page","page_done","sideex_page_done","ajax_done","sideex_ajax_done","dom_time","value","target","result","e","message","upperCase","charAt","toUpperCase","slice","document","body","setAttribute","returnValue","Promise","then","removeAttribute","catch","reason","mySideexTabId","prepareToInteract","rect","prepareToInteract_","locator","buildLocators","element","browserbot","findElement","locators","buildAll","resolveLocator","find","loc","strat","test","selectMode","selecting","__WEBPACK_IMPORTED_MODULE_2__targetSelector__","win","detach","Array","__WEBPACK_IMPORTED_MODULE_0_webextension_polyfill___default","runtime","sendMessage","selectTarget","selectNext","cancelSelectTarget","region","cleanup","Object","__WEBPACK_IMPORTED_MODULE_6__region__","_listener","onMessage","addListener","showElement","targetValue","resolve","isOptionsObject","options","keys","length","behavior","__WEBPACK_IMPORTED_MODULE_0_compute_scroll_into_view__","computeOptions","block","inline","getOptions","actions","canSmoothScroll","style","forEach","_ref","el","top","left","scroll","scrollTop","scrollLeft","defaultBehavior","isElement","nodeType","canOverflow","overflow","skipOverflowHiddenElements","isScrollable","clientHeight","scrollHeight","clientWidth","scrollWidth","getComputedStyle","overflowY","overflowX","alignNearest","scrollingEdgeStart","scrollingEdgeEnd","scrollingSize","scrollingBorderStart","scrollingBorderEnd","elementEdgeStart","elementEdgeEnd","elementSize","scrollMode","boundary","checkBoundary","node","TypeError","scrollingElement","documentElement","frames","cursor","parentNode","host","push","viewportWidth","visualViewport","width","innerWidth","viewportHeight","height","innerHeight","viewportX","scrollX","pageXOffset","viewportY","scrollY","pageYOffset","_target$getBoundingCl","getBoundingClientRect","targetHeight","targetWidth","targetTop","targetRight","right","targetBottom","bottom","targetLeft","targetBlock","targetInline","computations","index","frame","_frame$getBoundingCli","_height","_width","_top","_left","frameStyle","borderLeft","parseInt","borderLeftWidth","borderTop","borderTopWidth","borderRight","borderRightWidth","borderBottom","borderBottomWidth","blockScroll","inlineScroll","scrollbarWidth","offsetWidth","scrollbarHeight","offsetHeight","Math","max","min","unescapeHtml","str","replace","escapeAttr","spaceS","spaceE","tempStr","tempAttr","tempValue","processedTag","flag","finishedProcessing","indexOf","substring","equal","quotS","quotE","lastIndexOf","replaceChar","dquotS","dquotE","doEscape","m","&","\"","'","<",">","checkType","cutStr","replaceStr","mode","charType","pos","doFlag","ampersandExists","escapeHTML","smallIndex","greatIndex","tempTag","processed","tempSmallIndex","tagsExists","__WEBPACK_IMPORTED_MODULE_8__utils__","Selenium","constructor","optionLocatorFactory","OptionLocatorFactory","page","defaultTimeout","DEFAULT_TIMEOUT","mouseSpeed","DEFAULT_MOUSE_SPEED","throwIfNoVarNameProvided","varName","Error","waitUntil","condition","timeout","failureMessage","reject","count","retryInterval","interval","setInterval","clearInterval","error","getClientXY","coordString","x","y","coords","split","Number","prototype","getElementPositionLeft","getElementPositionTop","getCoords","_element","__WEBPACK_IMPORTED_MODULE_6__closure_polyfill__","math","Coordinate","unableToLocateTargetElementError","RIGHT_MOUSE_CLICK","decorateFunctionWithTimeout","f","callback","timeoutTime","Date","getTime","__WEBPACK_IMPORTED_MODULE_2__SeleniumError__","proxyInjectionMode","location","__WEBPACK_IMPORTED_MODULE_5__selenium_browserbot__","reset","selectWindow","resetPopups","eval","script","argv","scoped","isExpression","JSON","stringify","doEvaluateConditional","doVerifyChecked","type","checked","doVerifyNotChecked","doVerifyEditable","isEditable","doVerifyNotEditable","doVerifySelectedValue","doVerifyNotSelectedValue","doVerifyText","doAssertText","doVerifyNotText","doAssertNotText","doVerifyValue","doVerifyTitle","string","normalizeSpaces","getTitle","doVerifyElementPresent","match","doVerifyElementNotPresent","doVerify","variableName","expected","doAssert","res","rej","getVar","variable","actual","doAssertChecked","doAssertNotChecked","doAssertEditable","doAssertNotEditable","doAssertSelectedValue","doVerifySelectedLabel","selectLocator","selectedLabel","findSelectedOptionProperty","doAssertSelectedLabel","doAssertNotSelectedValue","findElementVisible","dom","isShown","visibleText","getVisibleText","trim","doAssertValue","doAssertTitle","doAssertElementPresent","doAssertElementNotPresent","doStore","storeStr","storeVar","doStoreEval","doStoreJson","json","parse","doStoreText","text","innerHTML","doStoreValue","doStoreTitle","doc","__WEBPACK_IMPORTED_MODULE_3__commands_api__","getDocument","title","doStoreXpathCount","xpath","evaluateXPathCount","doStoreAttribute","attributeValue","findAttribute","doWaitForElementPresent","isElementPresent","bind","doWaitForElementNotPresent","doWaitForElementVisible","isVisible","doWaitForElementNotVisible","doWaitForElementEditable","doWaitForElementNotEditable","doWaitPreparation","doPrePageWait","doPageWait","doAjaxWait","doDomWait","sideex_dom_time","doClick","action","click","doDoubleClick","doubleClick","doContextMenu","rightClick","doClickAt","doDoubleClickAt","doContextMenuAt","doFocus","focus","events","fire","EventType","FOCUS","doShiftKeyDown","shiftKeyDown","shiftKeyDown_","doShiftKeyUp","doMetaKeyDown","metaKeyDown","metaKeyDown_","doMetaKeyUp","doAltKeyDown","altKeyDown","altKeyDown_","doAltKeyUp","doControlKeyDown","controlKeyDown","controlKeyDown_","doControlKeyUp","prepareToInteractWith_","doMouseOver","moveMouse","doMouseOut","triggerMouseEvent","doMouseDown","doMouseDownRight","undefined","doMouseDownAt","clientXY","doMouseDownRightAt","doMouseUp","doMouseUpRight","doMouseUpAt","doMouseUpRightAt","doMouseMove","doMouseMoveAt","doType","setValue","CHANGE","doSendKeys","replaceKeys","doSetSpeed","getSpeed","findToggleButton","doCheck","doUncheck","doSelect","optionLocator","option","fromLocatorString","findOption","selectOption","doAddSelection","addSelection","doRemoveSelection","removeSelection","doRemoveAllSelections","doSubmit","formLocator","log","form","submit","makePageLoadCondition","_isNewPageLoaded","_abortXhrRequest","doOpen","url","ignoreResponseCode","toLowerCase","openLocation","doOpenWindow","windowID","openWindow","doSelectWindow","doSelectPopUp","selectPopUp","doDeselectPopUp","doSelectFrame","selectFrame","getWhetherThisFrameMatchFrameExpression","currentFrameString","doesThisFrameMatchFrameExpression","getWhetherThisWindowMatchWindowExpression","_currentWindowString","opener","doWaitForPopUp","targetWindow","getWindowByName","names","getNonTopWindowNames","isKonqueror","href","isSafari","buttonWindow","getCurrentWindow","readyState","dontCheckAlertsAndConfirms","doGoBack","goBack","doRefresh","refresh","doClose","close","ensureNoUnhandledPopups","hasAlerts","getNextAlert","hasConfirmations","getNextConfirmation","isAlertPresent","isPromptPresent","hasPrompts","isConfirmationPresent","getAlert","Assert","fail","getConfirmation","getPrompt","getNextPrompt","getLocation","getBodyText","bodyText","getValue","getText","getEval","isChecked","getTable","tableCellAddress","pattern","pieces","tableName","row","col","table","rows","cells","getSelectedLabels","findSelectedOptionProperties","getSelectedLabel","getSelectedValues","getSelectedValue","getSelectedIndexes","getSelectedIndex","getSelectedIds","getSelectedId","isSomethingSelected","selected","property","selectedOptions","propVal","getSelectOptions","selectOptions","getAttribute","attributeLocator","isTextPresent","allText","patternMatcher","__WEBPACK_IMPORTED_MODULE_7__PatternMatcher__","strategy","strategies","glob","matcher","globContains","exact","matches","findElementOrNull","tagName","String","visibility","findEffectiveStyleProperty","_isDisplayed","propertyValue","findEffectiveStyle","currentStyle","defaultView","disabled","readOnlyNode","getAttributeNode","nodeValue","getAllButtons","getAllLinks","getAllFields","doSetMouseSpeed","pixels","intValue","getMouseSpeed","doDragAndDrop","movementsString","clientStartXY","clientStartX","clientStartY","movements","movementX","movementY","clientFinishX","clientFinishY","move","current","dest","abs","clientX","clientY","doDragAndDropToObject","locatorOfObjectToBeDragged","locatorOfDragDestinationObject","draggable","triggerDragEvent","startX","startY","destinationLeftX","destinationTopY","destinationWidth","getElementWidth","destinationHeight","getElementHeight","round","doWindowFocus","doWindowMaximize","screen","moveTo","screenX","resizeTo","availWidth","availHeight","getHtmlSource","getElementsByTagName","doSetCursorPosition","position","setSelectionRange","isOpera","createTextRange","range","collapse","moveEnd","moveStart","select","getElementIndex","previousSibling","_isCommentOrEmptyTextNode","isOrdered","locator1","locator2","element1","element2","data","offsetLeft","elementParent","offsetParent","all","clientLeft","parentBorder","border","isNaN","clientTop","offsetTop","getCursorPosition","elementRange","selection","selectRange","createRange","duplicate","setEndPoint","selectionStart","getSelection","rangeCount","getExpression","expression","getXpathCount","getCssCount","css","evaluateCssCount","doAssignId","identifier","id","doAllowNativeXpath","allow","setAllowNativeXPath","doIgnoreAttributesWithoutValue","ignore","setIgnoreAttributesWithoutValue","doWaitForCondition","doSetTimeout","doWaitForPageToLoad","doWaitForFrameToLoad","_frameAddress","isNewPageLoaded","abortXhrRequest","toString","currentKey","shift","currentKeyIndex","substr","keyName","key","Keyboard","Keys","getCookie","cookie","getCookieByName","name","v","isCookiePresent","doCreateCookie","nameValuePair","optionsString","results","exec","expireDateInMilliseconds","toGMTString","path","khtml","doDeleteCookie","domain","recurse","matched","cookieName","recursivelyDeleteCookie","deleteCookie","doDeleteAllVisibleCookies","cookieNames","getAllCookieNames","pathname","doExecuteScript","doExecuteAsyncScript","doRunScript","doRollup","rollupName","kwargs","loop","currentTest","htmlTestRunner","backupManager","backup","item","restore","requiresCallBack","commandStarted","nextCommand","commandComplete","commandError","pendingRollupCommands","rollupFailed","rollupFailedMessage","expandedCommands","RollupManager","getInstance","getRollupRule","getExpandedCommands","failed","rollupFailureMessages","join","errorMessage","doAddScript","scriptContent","scriptTagId","getElementById","msg","head","createElement","appendChild","doRemoveScript","removeChild","doUseXpathLibrary","libraryName","getXPathEngine","setXPathEngine","locatorString","locatorType","locatorValue","optionLocators","registerOptionLocators","functionName","locatorName","OptionLocatorByLabel","label","labelMatcher","assertSelected","selectedIndex","OptionLocatorByValue","valueMatcher","selectedValue","OptionLocatorByIndex","equals","OptionLocatorById","idMatcher","selectedId","doEditContent","contentEditable","__WEBPACK_IMPORTED_MODULE_4__escape__","doChooseCancelOnNextPrompt","cancelNextPrompt","doAnswerOnNextPrompt","answer","setNextPromptResult","doAssertPrompt","getPromptMessage","actualMessage","doAssertAlert","getAlertMessage","doChooseCancelOnNextConfirmation","setNextConfirmationResult","doChooseOkOnNextConfirmation","doAssertConfirmation","getConfirmationMessage","doShowElement","elementForInjectingStyle","rel","getURL","highlightElement","bodyRects","elementRects","zIndex","display","pointerEvents","__WEBPACK_IMPORTED_MODULE_1_scroll_into_view_if_needed__","centerIfNeeded","className","setTimeout","__WEBPACK_IMPORTED_MODULE_5__PatternMatcher__","browserVersion","global","BrowserVersion","BrowserBot","topLevelApplicationWindow","topWindow","topFrame","baseUrl","__WEBPACK_IMPORTED_MODULE_3__closure_polyfill__","setWindow","currentWindow","currentWindowName","allowNativeXpath","xpathEvaluator","XPathEvaluator","isSubFrameSelected","modalDialogTest","recordedAlerts","recordedConfirmations","recordedPrompts","openedWindows","nextConfirmResult","nextPromptResult","newPageLoaded","pageLoadError","xhr","abortXhr","isXhrSent","isXhrDone","xhrOpenLocation","xhrResponseCode","xhrStatusText","shouldHighlightLocatedElement","uniqueId","pollingForLoad","permDeniedCount","windowPollers","assign","PageBot","_registerAllLocatorFunctions","recordPageLoad","__WEBPACK_IMPORTED_MODULE_1__SeleniumError__","engineName","setCurrentEngine","getCurrentEngine","encodeURIComponentWithASPHack","uri","aggressiveEncoding","encodeURIComponent","isIE","IEBrowserBot","KonquerorBrowserBot","OperaBrowserBot","SafariBrowserBot","MozillaBrowserBot","doModalDialogTest","cancelNextConfirmation","relayBotToRC","s","piMode","__WEBPACK_IMPORTED_MODULE_2__commands_api__","relayToRC","t","eventType","canBubble","button","screenY","getOwnerDocument","view","getWindow","evt","createEvent","initMouseEvent","initEvent","shiftKey","metaKey","altKey","ctrlKey","dispatchEvent","getXpathOfElement","parentElement","siblingElement","children","tagCount","totalTagCount","isFound","scriptTag","_windowClosed","c","closed","ignored","uniqueKey","_modifyWindow","seleniumKey","modifyWindowToRecordPopUpDialogs","ex","console","modifySeparateTestWindowToDetectPageLoads","_selectTopWindow","_selectWindowByWindowId","_selectWindowByTitle","_selectWindowByName","windowId","_selectFirstNonTopWindow","windowName","getWindowNameByTitle","parent","_getFrameElement","contentWindow","isHTA","isDom","mySandbox","Components","utils","Sandbox","evalInSandbox","autWindow","permDenied","currentFrame","abort","onXhrStateChange","method","status","XMLHttpRequest","onreadystatechange","open","setRequestHeader","send","statusText","child","setIFrameLocation","iframe","src","getCurrentPage","windowNeedsModifying","appInfo","classes","getService","interfaces","nsIXULAppInfo","nsIVersionComparator","compare","version","alert","originalWindow","browserBot","windowToModify","firefox","unwrap","seleniumAlert","call","confirm","prompt","originalOpenReference","originalOpen","newOpen","windowFeatures","replaceFlag","myOriginalOpen","openedWindow","newOpenReference","setOriginalRef","windowObject","isPollingForLoad","marker","frameElement","htaSubFrame","_isHTASubFrame","pollForLoad","caught","parentContainsIdenticallyNamedFrame","_getFrameElementByName","locateElementByName","loadFunction","originalDocument","originalLocation","originalHref","isSamePage","_isSamePage","rs","getReadyState","currentHref","currentlySelectedWindow","currentlySelectedWindowMarker","newMarker","reschedulePoller","currentDocument","currentLocation","sameDoc","_isSameDocument","sameLoc","currentHash","originalHash","sameHref","markedLoc","pageUnloading","XXXreschedulePoller","buttonName","createTextNode","tools","onclick","runScheduledPollers","oldPollers","doNotModify","winName","ok","windowTitle","nonTopWindowNames","testWindow","_handleClosedSubFrame","window_","getUserWindow","missing","setShouldHighlightElement","shouldHighlight","locationStrategies","locatorFunction","locatorPrefix","prefix","findElementBy","inDocument","inWindow","startsWith","locateElementByXPath","locateElementByDomTraversal","locateElementByIdentifier","ck","ckPairs","ckNameValue","decodeURIComponent","ckName","getAllRawCookieNames","_cookieName","rawCookieNames","rawCookieNumber","_maybeDeleteCookie","_recursivelyDeleteCookieDomains","dotIndex","_recursivelyDeleteCookie","slashIndex","deleted","__WEBPACK_IMPORTED_MODULE_4__utils__","[object Object]","findElementsLikeWebDriver","how","using","by","findElements","toReturn","inject","cache","addElement","locateElementById","elements","n","attributes","filter","selectElements","domTraversal","locateElementByStoredReference","locateElementByWebDriver","selectSingleNode","createNSResolver","_namespaceResolver","locateElementsByXPath","selectNodes","selector","locateElementByLinkText","linkText","links","attributePos","elementLocator","attributeName","isDefAndNotNull","optionToSelect","changed","checkMultiselect","multiple","replaceText","stringValue","SELECT","maxLengthAttr","actualValue","maxLength","ownerDocument","designMode","clickElement","_fireEventOnElement","doubleClickElement","contextMenuOnElement","_modifyElementTarget","findClickableElement","newTarget","hasAttribute","_handleClickingImagesInsideLinks","itrElement","_getTargetWindow","_getFrameFromGlobal","history","back","goForward","forward","isChrome","reload","selectElementsBy","filterType","filterFunction","filterFunctions","selectedElements","filterExpr","defaultFilterType","locateElementByCss","promptResponse","postMessage","direction","command","promptMessage","confirmationResponse","confirmationMessage","alertResponse","alertMessage","super","closedError","windowClosed","oldShowModalDialog","showModalDialog","args","features","doc_location","end_of_base_ref","base_ref","runInterval","runOptions","fullURL","escape","pageUnloadDetector","addEventListener","attachEvent","canAccessThisWindow","canAccessCurrentlySelectedWindow","de","locateElementByIdentifer","currentPath","hash","actuallyReload","wasChecked","removeEventListener","detachEvent","__WEBPACK_IMPORTED_MODULE_0__SeleniumError__","PatternMatcher","selectStrategy","strategyName","possibleNewStrategyName","RegExp","$1","possibleNewPattern","$2","matchStrategy","regexp","regexpString","regex","regexpi","regexi","globString","regexpFromGlobContains","regexpFromGlob","convertGlobMetaCharsToRegexpMetaChars","re","cleanupCallback","div","insertBefore","firstChild","r","banner","header","img","browser","span","innerText","handleEvent","highlight","preventDefault","stopPropagation","elementFromPoint","or","cb","canvasExists","container","canvas","cornerSize","tlc","createHotCorner","updateRegion","endX","endY","trc","blc","brc","createRegion","backgroundColor","opacity","setStyle","mousedown","mouseup","setEvents","buttonContainer","buttons","hideButtons","removeRegion","calculateRectFromCoords","cancel","alignItems","justifyContent","styleButton","createButtons","mouseOffset","STATES","create","update","resize","state","pageX","pageY","mousemove","mouseX","mouseY","dx","dy","moveRegion","canvasRect","showButtons","p1","p2","size","color","padding","margin","borderRadius","outline","textTransform","elementForInjectingScript","handler","event","source","response","handleMessage","__WEBPACK_IMPORTED_MODULE_0_webextension_polyfill__"],"mappings":"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","file":"playback.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","/*\n * Copyright 2017 SideeX committers\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport browser from 'webextension-polyfill'\nimport './closure-polyfill'\nimport TargetSelector from './targetSelector'\nimport Selenium from './selenium-api'\nimport BrowserBot from './selenium-browserbot'\nimport LocatorBuilders from './locatorBuilders'\nimport { editRegion, removeRegion } from './region'\nimport { attach } from './prompt-injector'\n\nexport const selenium = new Selenium(BrowserBot.createForWindow(window, true))\nconst locatorBuilders = new LocatorBuilders(window)\nlet contentSideexTabId = window.contentSideexTabId\nlet targetSelector\n\nattach(selenium)\n\nfunction doCommands(request, _sender, sendResponse) {\n  if (request.commands) {\n    if (request.commands == 'waitPreparation') {\n      selenium['doWaitPreparation']('', selenium.preprocessParameter(''))\n      sendResponse({})\n    } else if (request.commands == 'prePageWait') {\n      selenium['doPrePageWait']('', selenium.preprocessParameter(''))\n      sendResponse({ new_page: window.sideex_new_page })\n    } else if (request.commands == 'pageWait') {\n      selenium['doPageWait']('', selenium.preprocessParameter(''))\n      sendResponse({ page_done: window.sideex_page_done })\n    } else if (request.commands == 'ajaxWait') {\n      selenium['doAjaxWait']('', selenium.preprocessParameter(''))\n      sendResponse({ ajax_done: window.sideex_ajax_done })\n    } else if (request.commands == 'domWait') {\n      selenium['doDomWait']('', selenium.preprocessParameter(''))\n      sendResponse({ dom_time: window.sideex_new_page })\n    } else if (request.commands === 'evaluateConditional') {\n      try {\n        let value = selenium['doEvaluateConditional'](request.target)\n        sendResponse({ result: 'success', value: value })\n      } catch (e) {\n        sendResponse({ result: e.message })\n      }\n    } else {\n      const upperCase =\n        request.commands.charAt(0).toUpperCase() + request.commands.slice(1)\n      if (selenium['do' + upperCase] != null) {\n        try {\n          document.body.setAttribute('SideeXPlayingFlag', true)\n          let returnValue = selenium['do' + upperCase](\n            selenium.preprocessParameter(request.target),\n            selenium.preprocessParameter(request.value)\n          )\n          if (returnValue instanceof Promise) {\n            // The command is a asynchronous function\n            returnValue\n              .then(function() {\n                // Asynchronous command completed successfully\n                document.body.removeAttribute('SideeXPlayingFlag')\n                sendResponse({ result: 'success' })\n              })\n              .catch(function(reason) {\n                // Asynchronous command failed\n                document.body.removeAttribute('SideeXPlayingFlag')\n                sendResponse({ result: reason })\n              })\n          } else {\n            // Synchronous command completed successfully\n            document.body.removeAttribute('SideeXPlayingFlag')\n            sendResponse({ result: 'success' })\n          }\n        } catch (e) {\n          // Synchronous command failed\n          document.body.removeAttribute('SideeXPlayingFlag')\n          sendResponse({ result: e.message })\n        }\n      } else {\n        sendResponse({ result: 'Unknown command: ' + request.commands })\n      }\n    }\n\n    //do every command need giving sideex id\n    if (contentSideexTabId === -1) {\n      contentSideexTabId = request.mySideexTabId\n    }\n    return true\n  }\n  if (request.prepareToInteract) {\n    sendResponse({\n      result: 'success',\n      rect: selenium.prepareToInteract_(request.locator),\n    })\n  }\n  if (request.buildLocators) {\n    try {\n      const element = selenium.browserbot.findElement(request.locator)\n      const locators = locatorBuilders.buildAll(element)\n      sendResponse({ result: 'success', locators })\n    } catch (e) {\n      sendResponse({ result: e.message })\n    }\n  }\n  if (request.resolveLocator) {\n    try {\n      const element = selenium.browserbot.findElement(request.locator)\n      const locator = locatorBuilders\n        .buildAll(element)\n        .find(([loc, strat]) => /^xpath/.test(strat))[0] //eslint-disable-line no-unused-vars\n      sendResponse({ result: 'success', locator })\n    } catch (e) {\n      sendResponse({ result: e.message })\n    }\n  }\n  if (request.selectMode) {\n    sendResponse(true)\n    if (request.selecting && request.element) {\n      targetSelector = new TargetSelector(\n        function(element, win) {\n          if (element && win) {\n            const target = locatorBuilders.buildAll(element)\n            locatorBuilders.detach()\n            if (target != null && target instanceof Array) {\n              if (target) {\n                //self.editor.treeView.updateCurrentCommand('targetCandidates', target);\n                browser.runtime.sendMessage({\n                  selectTarget: true,\n                  target: target,\n                  selectNext: request.selectNext,\n                })\n              }\n            }\n          }\n          targetSelector = null\n        },\n        function() {\n          browser.runtime.sendMessage({\n            cancelSelectTarget: true,\n          })\n        }\n      )\n    } else if (request.selecting && request.region) {\n      editRegion(request.rect, target => {\n        if (target) {\n          browser.runtime.sendMessage({\n            selectTarget: true,\n            target: [[target]],\n            selectNext: request.selectNext,\n          })\n        } else {\n          browser.runtime.sendMessage({\n            cancelSelectTarget: true,\n            selectNext: request.selectNext,\n          })\n        }\n      })\n    } else {\n      if (targetSelector) {\n        targetSelector.cleanup()\n        targetSelector = null\n        return\n      } else {\n        removeRegion()\n        return\n      }\n    }\n  }\n}\n\n// show element\nfunction startShowElement(message) {\n  if (message.showElement) {\n    try {\n      const result = selenium['doShowElement'](message.targetValue)\n      return Promise.resolve({ result: result })\n    } catch (e) {\n      // If we didn't find the element, it means that another frame might have found it,\n      // so we don't resolve the promise. If no frame finds it, then the promise will\n      // get rejected.\n    }\n  }\n}\n\nif (!window._listener) {\n  window._listener = doCommands\n  browser.runtime.onMessage.addListener(startShowElement)\n  browser.runtime.onMessage.addListener(doCommands)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content/commands-api.js","import compute from 'compute-scroll-into-view';\n\nfunction isOptionsObject(options) {\n  return options === Object(options) && Object.keys(options).length !== 0;\n}\n\nfunction defaultBehavior(actions, behavior) {\n  if (behavior === void 0) {\n    behavior = 'auto';\n  }\n\n  var canSmoothScroll = 'scrollBehavior' in document.body.style;\n  actions.forEach(function (_ref) {\n    var el = _ref.el,\n        top = _ref.top,\n        left = _ref.left;\n\n    if (el.scroll && canSmoothScroll) {\n      el.scroll({\n        top: top,\n        left: left,\n        behavior: behavior\n      });\n    } else {\n      el.scrollTop = top;\n      el.scrollLeft = left;\n    }\n  });\n}\n\nfunction getOptions(options) {\n  if (options === false) {\n    return {\n      block: 'end',\n      inline: 'nearest'\n    };\n  }\n\n  if (isOptionsObject(options)) {\n    return options;\n  }\n\n  return {\n    block: 'start',\n    inline: 'nearest'\n  };\n}\n\nfunction scrollIntoView(target, options) {\n  if (isOptionsObject(options) && typeof options.behavior === 'function') {\n    return options.behavior(compute(target, options));\n  }\n\n  var computeOptions = getOptions(options);\n  return defaultBehavior(compute(target, computeOptions), computeOptions.behavior);\n}\n\nexport default scrollIntoView;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/scroll-into-view-if-needed/es/index.js\n// module id = 148\n// module chunks = 0 2","function isElement(el) {\n  return el != null && typeof el === 'object' && (el.nodeType === 1 || el.nodeType === 11);\n}\n\nfunction canOverflow(overflow, skipOverflowHiddenElements) {\n  if (skipOverflowHiddenElements && overflow === 'hidden') {\n    return false;\n  }\n\n  return overflow !== 'visible' && overflow !== 'clip';\n}\n\nfunction isScrollable(el, skipOverflowHiddenElements) {\n  if (el.clientHeight < el.scrollHeight || el.clientWidth < el.scrollWidth) {\n    var style = getComputedStyle(el, null);\n    return canOverflow(style.overflowY, skipOverflowHiddenElements) || canOverflow(style.overflowX, skipOverflowHiddenElements);\n  }\n\n  return false;\n}\n\nfunction alignNearest(scrollingEdgeStart, scrollingEdgeEnd, scrollingSize, scrollingBorderStart, scrollingBorderEnd, elementEdgeStart, elementEdgeEnd, elementSize) {\n  if (elementEdgeStart < scrollingEdgeStart && elementEdgeEnd > scrollingEdgeEnd || elementEdgeStart > scrollingEdgeStart && elementEdgeEnd < scrollingEdgeEnd) {\n    return 0;\n  }\n\n  if (elementEdgeStart < scrollingEdgeStart && elementSize < scrollingSize || elementEdgeEnd > scrollingEdgeEnd && elementSize > scrollingSize) {\n    return elementEdgeStart - scrollingEdgeStart - scrollingBorderStart;\n  }\n\n  if (elementEdgeEnd > scrollingEdgeEnd && elementSize < scrollingSize || elementEdgeStart < scrollingEdgeStart && elementSize > scrollingSize) {\n    return elementEdgeEnd - scrollingEdgeEnd + scrollingBorderEnd;\n  }\n\n  return 0;\n}\n\nexport default (function (target, options) {\n  var scrollMode = options.scrollMode,\n      block = options.block,\n      inline = options.inline,\n      boundary = options.boundary,\n      skipOverflowHiddenElements = options.skipOverflowHiddenElements;\n  var checkBoundary = typeof boundary === 'function' ? boundary : function (node) {\n    return node !== boundary;\n  };\n\n  if (!isElement(target)) {\n    throw new TypeError('Invalid target');\n  }\n\n  var scrollingElement = document.scrollingElement || document.documentElement;\n  var frames = [];\n  var cursor = target;\n\n  while (isElement(cursor) && checkBoundary(cursor)) {\n    cursor = cursor.parentNode || cursor.host;\n\n    if (cursor === scrollingElement) {\n      frames.push(cursor);\n      break;\n    }\n\n    if (cursor === document.body && isScrollable(cursor) && !isScrollable(document.documentElement)) {\n      continue;\n    }\n\n    if (isScrollable(cursor, skipOverflowHiddenElements)) {\n      frames.push(cursor);\n    }\n  }\n\n  var viewportWidth = window.visualViewport ? visualViewport.width : innerWidth;\n  var viewportHeight = window.visualViewport ? visualViewport.height : innerHeight;\n  var viewportX = window.scrollX || pageXOffset;\n  var viewportY = window.scrollY || pageYOffset;\n\n  var _target$getBoundingCl = target.getBoundingClientRect(),\n      targetHeight = _target$getBoundingCl.height,\n      targetWidth = _target$getBoundingCl.width,\n      targetTop = _target$getBoundingCl.top,\n      targetRight = _target$getBoundingCl.right,\n      targetBottom = _target$getBoundingCl.bottom,\n      targetLeft = _target$getBoundingCl.left;\n\n  var targetBlock = block === 'start' || block === 'nearest' ? targetTop : block === 'end' ? targetBottom : targetTop + targetHeight / 2;\n  var targetInline = inline === 'center' ? targetLeft + targetWidth / 2 : inline === 'end' ? targetRight : targetLeft;\n  var computations = [];\n\n  for (var index = 0; index < frames.length; index++) {\n    var frame = frames[index];\n\n    var _frame$getBoundingCli = frame.getBoundingClientRect(),\n        _height = _frame$getBoundingCli.height,\n        _width = _frame$getBoundingCli.width,\n        _top = _frame$getBoundingCli.top,\n        right = _frame$getBoundingCli.right,\n        bottom = _frame$getBoundingCli.bottom,\n        _left = _frame$getBoundingCli.left;\n\n    if (scrollMode === 'if-needed' && targetTop >= 0 && targetLeft >= 0 && targetBottom <= viewportHeight && targetRight <= viewportWidth && targetTop >= _top && targetBottom <= bottom && targetLeft >= _left && targetRight <= right) {\n      return computations;\n    }\n\n    var frameStyle = getComputedStyle(frame);\n    var borderLeft = parseInt(frameStyle.borderLeftWidth, 10);\n    var borderTop = parseInt(frameStyle.borderTopWidth, 10);\n    var borderRight = parseInt(frameStyle.borderRightWidth, 10);\n    var borderBottom = parseInt(frameStyle.borderBottomWidth, 10);\n    var blockScroll = 0;\n    var inlineScroll = 0;\n    var scrollbarWidth = 'offsetWidth' in frame ? frame.offsetWidth - frame.clientWidth - borderLeft - borderRight : 0;\n    var scrollbarHeight = 'offsetHeight' in frame ? frame.offsetHeight - frame.clientHeight - borderTop - borderBottom : 0;\n\n    if (scrollingElement === frame) {\n      if (block === 'start') {\n        blockScroll = targetBlock;\n      } else if (block === 'end') {\n        blockScroll = targetBlock - viewportHeight;\n      } else if (block === 'nearest') {\n        blockScroll = alignNearest(viewportY, viewportY + viewportHeight, viewportHeight, borderTop, borderBottom, viewportY + targetBlock, viewportY + targetBlock + targetHeight, targetHeight);\n      } else {\n        blockScroll = targetBlock - viewportHeight / 2;\n      }\n\n      if (inline === 'start') {\n        inlineScroll = targetInline;\n      } else if (inline === 'center') {\n        inlineScroll = targetInline - viewportWidth / 2;\n      } else if (inline === 'end') {\n        inlineScroll = targetInline - viewportWidth;\n      } else {\n        inlineScroll = alignNearest(viewportX, viewportX + viewportWidth, viewportWidth, borderLeft, borderRight, viewportX + targetInline, viewportX + targetInline + targetWidth, targetWidth);\n      }\n\n      blockScroll = Math.max(0, blockScroll + viewportY);\n      inlineScroll = Math.max(0, inlineScroll + viewportX);\n    } else {\n      if (block === 'start') {\n        blockScroll = targetBlock - _top - borderTop;\n      } else if (block === 'end') {\n        blockScroll = targetBlock - bottom + borderBottom + scrollbarHeight;\n      } else if (block === 'nearest') {\n        blockScroll = alignNearest(_top, bottom, _height, borderTop, borderBottom + scrollbarHeight, targetBlock, targetBlock + targetHeight, targetHeight);\n      } else {\n        blockScroll = targetBlock - (_top + _height / 2) + scrollbarHeight / 2;\n      }\n\n      if (inline === 'start') {\n        inlineScroll = targetInline - _left - borderLeft;\n      } else if (inline === 'center') {\n        inlineScroll = targetInline - (_left + _width / 2) + scrollbarWidth / 2;\n      } else if (inline === 'end') {\n        inlineScroll = targetInline - right + borderRight + scrollbarWidth;\n      } else {\n        inlineScroll = alignNearest(_left, right, _width, borderLeft, borderRight + scrollbarWidth, targetInline, targetInline + targetWidth, targetWidth);\n      }\n\n      var scrollLeft = frame.scrollLeft,\n          scrollTop = frame.scrollTop;\n      blockScroll = Math.max(0, Math.min(scrollTop + blockScroll, frame.scrollHeight - _height + scrollbarHeight));\n      inlineScroll = Math.max(0, Math.min(scrollLeft + inlineScroll, frame.scrollWidth - _width + scrollbarWidth));\n      targetBlock += scrollTop - blockScroll;\n      targetInline += scrollLeft - inlineScroll;\n    }\n\n    computations.push({\n      el: frame,\n      top: blockScroll,\n      left: inlineScroll\n    });\n  }\n\n  return computations;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/compute-scroll-into-view/es/index.js\n// module id = 149\n// module chunks = 0 2","/*\n * Copyright 2017 SideeX committers\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\n// change HTML entities to sign\nexport function unescapeHtml(str) {\n  return str\n    .replace(/&amp;/gi, '&')\n    .replace(/&quot;/gi, '\"')\n    .replace(/&lt;/gi, '<')\n    .replace(/&gt;/gi, '>')\n    .replace(/&#39;/gi, \"'\")\n}\n\nfunction escapeAttr(str) {\n  let spaceS = 0\n  let spaceE = -1\n  let tempStr = str\n  let tempAttr = ''\n  let tempValue = ''\n  let processedTag = ''\n  let flag = false\n  let finishedProcessing = false\n\n  do {\n    spaceS = str.indexOf(' ')\n    spaceE = str.indexOf(' ', spaceS + 1)\n\n    if (spaceE >= 0) {\n      while (str.charAt(spaceE - 1) != \"'\" && str.charAt(spaceE - 1) != '\"') {\n        spaceE = str.indexOf(' ', spaceE + 1)\n        if (spaceE < 0) break\n      }\n    }\n\n    //if there is space, then split string\n    if (spaceS >= 0 && spaceE >= 0) {\n      tempAttr = str.substring(spaceS + 1, spaceE)\n      tempStr = str.substring(0, spaceS + 1)\n      str = str.substring(spaceE)\n    } else if (spaceS >= 0 && spaceE < 0) {\n      tempAttr = str.substring(spaceS + 1, str.length - 1)\n      tempStr = str.substring(0, spaceS + 1)\n      str = ''\n    } else {\n      //flag is check that has string been processed\n      if (flag) processedTag += '>'\n      else processedTag = str\n      finishedProcessing = true\n      break\n    }\n\n    flag = true\n    let equal = tempAttr.indexOf('=')\n\n    if (tempAttr.charAt(equal + 1) == \"'\") {\n      //divide the single quote\n      if (tempAttr.indexOf(\"'\") != -1) {\n        let quotS = tempAttr.indexOf(\"'\")\n        let quotE = tempAttr.lastIndexOf(\"'\")\n        tempValue = tempAttr.substring(quotS + 1, quotE)\n        tempAttr = tempAttr.substring(0, quotS + 1)\n        tempValue = replaceChar(tempValue)\n        tempAttr += tempValue + \"'\"\n      }\n    }\n    if (tempAttr.charAt(equal + 1) == '\"') {\n      //divide the double quote\n      if (tempAttr.indexOf('\"') != -1) {\n        let dquotS = tempAttr.indexOf('\"')\n        let dquotE = tempAttr.lastIndexOf('\"')\n        tempValue = tempAttr.substring(dquotS + 1, dquotE)\n        tempAttr = tempAttr.substring(0, dquotS + 1)\n        tempValue = replaceChar(tempValue)\n        tempAttr += tempValue + '\"'\n      }\n    }\n    //merge the splited string\n    processedTag += tempStr + tempAttr\n  } while (!finishedProcessing)\n\n  return processedTag\n}\n\n//escape the character \"<\".\">\".\"&\".\"'\".'\"'\nfunction doEscape(str) {\n  return str.replace(\n    /[&\"'<>]/g,\n    m =>\n      ({ '&': '&amp;', '\"': '&quot;', \"'\": '&#39;', '<': '&lt;', '>': '&gt;' }[\n        m\n      ])\n  )\n}\n\n//append\nfunction checkType(cutStr, replaceStr, mode) {\n  switch (mode) {\n    case 1:\n      return (cutStr += replaceStr + '&amp;')\n    case 2:\n      return (cutStr += replaceStr + '&quot;')\n    case 3:\n      return (cutStr += replaceStr + '&#39;')\n    case 4:\n      return (cutStr += replaceStr + '&lt;')\n    case 5:\n      return (cutStr += replaceStr + '&gt;')\n    default:\n      return cutStr\n  }\n}\n\n//avoid &amp; to escape &amp;amp;\nfunction replaceChar(str) {\n  //escape the character\n  let pos = -1\n  let cutStr = ''\n  let replaceStr = ''\n  let doFlag = 0\n  let charType\n  let ampersandExists = true\n\n  while (ampersandExists) {\n    pos = str.indexOf('&', pos + 1)\n    charType = 0\n    if (pos != -1) {\n      if (str.substring(pos, pos + 5) == '&amp;') {\n        charType = 1\n        replaceStr = str.substring(0, pos)\n        str = str.substring(pos + 5)\n      } else if (str.substring(pos, pos + 6) == '&quot;') {\n        charType = 2\n        replaceStr = str.substring(0, pos)\n        str = str.substring(pos + 6)\n      } else if (str.substring(pos, pos + 5) == '&#39;') {\n        charType = 3\n        replaceStr = str.substring(0, pos)\n        str = str.substring(pos + 5)\n      } else if (str.substring(pos, pos + 4) == '&lt;') {\n        charType = 4\n        replaceStr = str.substring(0, pos)\n        str = str.substring(pos + 4)\n      } else if (str.substring(pos, pos + 4) == '&gt;') {\n        charType = 5\n        replaceStr = str.substring(0, pos)\n        str = str.substring(pos + 4)\n      }\n\n      if (charType != 0) {\n        pos = -1\n        replaceStr = doEscape(replaceStr)\n        cutStr = checkType(cutStr, replaceStr, charType)\n        doFlag = 1\n      }\n    } else {\n      cutStr += str\n      ampersandExists = false\n    }\n  }\n  if (doFlag == 0) return doEscape(str)\n  else return cutStr\n}\n\n//check the HTML value\nexport function escapeHTML(str) {\n  let smallIndex = str.indexOf('<')\n  let greatIndex = str.indexOf('>')\n  let tempStr = ''\n  let tempTag = ''\n  let processed = ''\n  let tempSmallIndex = 0\n  let tagsExists = true\n\n  while (tagsExists) {\n    //find the less target\n    if (smallIndex >= 0) {\n      //find the greater target\n      if (greatIndex >= 0) {\n        do {\n          //split foreward string\n          smallIndex += tempSmallIndex\n          tempStr = str.substring(0, smallIndex)\n          //split the tags\n          tempTag = str.substring(smallIndex, greatIndex + 1)\n          tempSmallIndex = tempTag.lastIndexOf('<')\n        } while (tempSmallIndex != 0)\n\n        //escape attributes in the tag\n        tempTag = escapeAttr(tempTag)\n\n        str = str.substring(greatIndex + 1)\n        //check if the tag is script\n        // if(tempTag.toLowerCase().indexOf(\"script\")>=0)\n        // tempTag = replaceChar(tempTag);\n\n        //merge them up\n        processed += replaceChar(tempStr) + tempTag\n      } else {\n        replaceChar(str)\n        tagsExists = false\n        break\n      }\n    } else {\n      replaceChar(str)\n      tagsExists = false\n      break\n    }\n    //going to do next tag\n    smallIndex = str.indexOf('<')\n    greatIndex = 0\n    do {\n      //avoid other >\n      greatIndex = str.indexOf('>', greatIndex + 1)\n    } while (greatIndex < smallIndex && greatIndex != -1)\n  }\n\n  if (str != '') processed += replaceChar(str)\n\n  return processed\n}\n\nwindow.unescapeHtml = unescapeHtml\nwindow.escapeHTML = escapeHTML\n\n\n\n// WEBPACK FOOTER //\n// ./content/escape.js","/*\n * Copyright 2011 Software Freedom Conservancy\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport browser from 'webextension-polyfill'\nimport scrollIntoViewIfNeeded from 'scroll-into-view-if-needed'\nimport SeleniumError from './SeleniumError'\nimport { selenium } from './commands-api'\nimport { escapeHTML } from './escape'\nimport BrowserBot, { browserVersion } from './selenium-browserbot'\nimport goog, { bot, core } from './closure-polyfill'\nimport PatternMatcher from './PatternMatcher'\nimport {\n  getTagName,\n  getTimeoutTime,\n  extractExceptionMessage,\n  lowerFirstChar,\n} from './utils'\n\n// TODO: stop navigating this.browserbot.document() ... it breaks encapsulation\n\nexport default class Selenium {\n  /**\n   * Defines an object that runs Selenium commands.\n   *\n   * <h3><a name=\"locators\"></a>Element Locators</h3>\n   * <p>\n   * Element Locators tell Selenium which HTML element a command refers to.\n   * The format of a locator is:</p>\n   * <blockquote>\n   * <em>locatorType</em><strong>=</strong><em>argument</em>\n   * </blockquote>\n   *\n   * <p>\n   * We support the following strategies for locating elements:\n   * </p>\n   *\n   * <ul>\n   * <li><strong>identifier</strong>=<em>id</em>:\n   * Select the element with the specified &#064;id attribute. If no match is\n   * found, select the first element whose &#064;name attribute is <em>id</em>.\n   * (This is normally the default; see below.)</li>\n   * <li><strong>id</strong>=<em>id</em>:\n   * Select the element with the specified &#064;id attribute.</li>\n   *\n   * <li><strong>name</strong>=<em>name</em>:\n   * Select the first element with the specified &#064;name attribute.\n   * <ul class=\"first last simple\">\n   * <li>username</li>\n   * <li>name=username</li>\n   * </ul>\n   *\n   * <p>The name may optionally be followed by one or more <em>element-filters</em>, separated from the name by whitespace.  If the <em>filterType</em> is not specified, <strong>value</strong> is assumed.</p>\n   *\n   * <ul class=\"first last simple\">\n   * <li>name=flavour value=chocolate</li>\n   * </ul>\n   * </li>\n   * <li><strong>dom</strong>=<em>javascriptExpression</em>:\n   *\n   * Find an element by evaluating the specified string.  This allows you to traverse the HTML Document Object\n   * Model using JavaScript.  Note that you must not return a value in this string; simply make it the last expression in the block.\n   * <ul class=\"first last simple\">\n   * <li>dom=document.forms['myForm'].myDropdown</li>\n   * <li>dom=document.images[56]</li>\n   * <li>dom=function foo() { return document.links[1]; }; foo();</li>\n   * </ul>\n   *\n   * </li>\n   *\n   * <li><strong>xpath</strong>=<em>xpathExpression</em>:\n   * Locate an element using an XPath expression.\n   * <ul class=\"first last simple\">\n   * <li>xpath=//img[&#064;alt='The image alt text']</li>\n   * <li>xpath=//table[&#064;id='table1']//tr[4]/td[2]</li>\n   * <li>xpath=//a[contains(&#064;href,'#id1')]</li>\n   * <li>xpath=//a[contains(&#064;href,'#id1')]/&#064;class</li>\n   * <li>xpath=(//table[&#064;class='stylee'])//th[text()='theHeaderText']/../td</li>\n   * <li>xpath=//input[&#064;name='name2' and &#064;value='yes']</li>\n   * <li>xpath=//*[text()=\"right\"]</li>\n   *\n   * </ul>\n   * </li>\n   * <li><strong>link</strong>=<em>textPattern</em>:\n   * Select the link (anchor) element which contains text matching the\n   * specified <em>pattern</em>.\n   * <ul class=\"first last simple\">\n   * <li>link=The link text</li>\n   * </ul>\n   *\n   * </li>\n   *\n   * <li><strong>css</strong>=<em>cssSelectorSyntax</em>:\n   * Select the element using css selectors. Please refer to <a href=\"http://www.w3.org/TR/REC-CSS2/selector.html\">CSS2 selectors</a>, <a href=\"http://www.w3.org/TR/2001/CR-css3-selectors-20011113/\">CSS3 selectors</a> for more information. You can also check the TestCssLocators test in the selenium test suite for an example of usage, which is included in the downloaded selenium core package.\n   * <ul class=\"first last simple\">\n   * <li>css=a[href=\"#id3\"]</li>\n   * <li>css=span#firstChild + span</li>\n   * </ul>\n   * <p>Currently the css selector locator supports all css1, css2 and css3 selectors except namespace in css3, some pseudo classes(:nth-of-type, :nth-last-of-type, :first-of-type, :last-of-type, :only-of-type, :visited, :hover, :active, :focus, :indeterminate) and pseudo elements(::first-line, ::first-letter, ::selection, ::before, ::after). </p>\n   * </li>\n   *\n   * <li><strong>ui</strong>=<em>uiSpecifierString</em>:\n   * Locate an element by resolving the UI specifier string to another locator, and evaluating it. See the <a href=\"http://svn.openqa.org/fisheye/browse/~raw,r=trunk/selenium/trunk/src/main/resources/core/scripts/ui-doc.html\">Selenium UI-Element Reference</a> for more details.\n   * <ul class=\"first last simple\">\n   * <li>ui=loginPages::loginButton()</li>\n   * <li>ui=settingsPages::toggle(label=Hide Email)</li>\n   * <li>ui=forumPages::postBody(index=2)//a[2]</li>\n   * </ul>\n   * </li>\n   *\n   * </ul>\n   *\n   * <p>\n   * Without an explicit locator prefix, Selenium uses the following default\n   * strategies:\n   * </p>\n   *\n   * <ul class=\"simple\">\n   * <li><strong>dom</strong>, for locators starting with &quot;document.&quot;</li>\n   * <li><strong>xpath</strong>, for locators starting with &quot;//&quot;</li>\n   * <li><strong>identifier</strong>, otherwise</li>\n   * </ul>\n   *\n   * <h3><a name=\"element-filters\">Element Filters</a></h3>\n   * <blockquote>\n   * <p>Element filters can be used with a locator to refine a list of candidate elements.  They are currently used only in the 'name' element-locator.</p>\n   * <p>Filters look much like locators, ie.</p>\n   * <blockquote>\n   * <em>filterType</em><strong>=</strong><em>argument</em></blockquote>\n   *\n   * <p>Supported element-filters are:</p>\n   * <p><strong>value=</strong><em>valuePattern</em></p>\n   * <blockquote>\n   * Matches elements based on their values.  This is particularly useful for refining a list of similarly-named toggle-buttons.</blockquote>\n   * <p><strong>index=</strong><em>index</em></p>\n   * <blockquote>\n   * Selects a single element based on its position in the list (offset from zero).</blockquote>\n   * </blockquote>\n   *\n   * <h3><a name=\"patterns\"></a>String-match Patterns</h3>\n   *\n   * <p>\n   * Various Pattern syntaxes are available for matching string values:\n   * </p>\n   * <ul>\n   * <li><strong>glob:</strong><em>pattern</em>:\n   * Match a string against a \"glob\" (aka \"wildmat\") pattern. \"Glob\" is a\n   * kind of limited regular-expression syntax typically used in command-line\n   * shells. In a glob pattern, \"*\" represents any sequence of characters, and \"?\"\n   * represents any single character. Glob patterns match against the entire\n   * string.</li>\n   * <li><strong>regexp:</strong><em>regexp</em>:\n   * Match a string using a regular-expression. The full power of JavaScript\n   * regular-expressions is available.</li>\n   * <li><strong>regexpi:</strong><em>regexpi</em>:\n   * Match a string using a case-insensitive regular-expression.</li>\n   * <li><strong>exact:</strong><em>string</em>:\n   *\n   * Match a string exactly, verbatim, without any of that fancy wildcard\n   * stuff.</li>\n   * </ul>\n   * <p>\n   * If no pattern prefix is specified, Selenium assumes that it's a \"glob\"\n   * pattern.\n   * </p>\n   * <p>\n   * For commands that return multiple values (such as verifySelectOptions),\n   * the string being matched is a comma-separated list of the return values,\n   * where both commas and backslashes in the values are backslash-escaped.\n   * When providing a pattern, the optional matching syntax (i.e. glob,\n   * regexp, etc.) is specified once, as usual, at the beginning of the\n   * pattern.\n   * </p>\n   */\n  constructor(browserbot) {\n    this.browserbot = browserbot\n    this.optionLocatorFactory = new OptionLocatorFactory()\n    // DGF for backwards compatibility\n    this.page = function() {\n      return browserbot\n    }\n    this.defaultTimeout = Selenium.DEFAULT_TIMEOUT\n    this.mouseSpeed = Selenium.DEFAULT_MOUSE_SPEED\n  }\n}\n\nSelenium.DEFAULT_TIMEOUT = 30 * 1000\nSelenium.DEFAULT_MOUSE_SPEED = 10\nSelenium.RIGHT_MOUSE_CLICK = 2\n\nSelenium.decorateFunctionWithTimeout = function(f, timeout, callback) {\n  if (f == null) {\n    return null\n  }\n\n  let timeoutTime = getTimeoutTime(timeout)\n\n  return function() {\n    if (new Date().getTime() > timeoutTime) {\n      if (callback != null) {\n        callback()\n      }\n      throw new SeleniumError('Timed out after ' + timeout + 'ms')\n    }\n    return f()\n  }\n}\n\nSelenium.createForWindow = function(window, proxyInjectionMode) {\n  if (!window.location) {\n    throw 'error: not a window!'\n  }\n  return Selenium(BrowserBot.createForWindow(window, proxyInjectionMode))\n}\n\nSelenium.prototype.reset = function() {\n  this.defaultTimeout = Selenium.DEFAULT_TIMEOUT\n  // todo: this.browserbot.reset()\n  this.browserbot.selectWindow('null')\n  this.browserbot.resetPopups()\n}\n\nSelenium.prototype.eval = function(\n  script,\n  argv = [],\n  scoped = true,\n  isExpression = false\n) {\n  // we are still stringifying here, but we are not supporting passing HTMLElements anyway :)\n  // Single quotes are important! JSON.stringifies uses double quotes, to avoid syntax error we use single quotes!!\n  if (isExpression) {\n    return window.eval(\n      scoped\n        ? `((...arguments) => (${script}))(...JSON.parse('${JSON.stringify(\n            argv\n          )}'))`\n        : script\n    )\n  } else {\n    return window.eval(\n      scoped\n        ? `((...arguments) => {${script}})(...JSON.parse('${JSON.stringify(\n            argv\n          )}'))`\n        : script\n    )\n  }\n}\n\nSelenium.prototype.doEvaluateConditional = function(script) {\n  return !!this.eval(script.script, script.argv, true, true)\n}\n\nSelenium.prototype.doVerifyChecked = function(locator) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'checkbox' && element.type !== 'radio') {\n    throw new Error(\n      `Element with locator ${locator} is not a checkbox nor a radio button`\n    )\n  } else if (!element.checked) {\n    throw new Error(`Element with locator ${locator} is not checked`)\n  }\n}\n\nSelenium.prototype.doVerifyNotChecked = function(locator) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'checkbox' && element.type !== 'radio') {\n    throw new Error(\n      `Element with locator ${locator} is not a checkbox nor a radio button`\n    )\n  } else if (element.checked) {\n    throw new Error(`Element with locator ${locator} is checked`)\n  }\n}\n\nSelenium.prototype.doVerifyEditable = function(locator) {\n  if (!this.isEditable(locator)) {\n    throw new Error(`Element with locator ${locator} is not editable`)\n  }\n}\n\nSelenium.prototype.doVerifyNotEditable = function(locator) {\n  if (this.isEditable(locator)) {\n    throw new Error(`Element with locator ${locator} is editable`)\n  }\n}\n\nSelenium.prototype.doVerifySelectedValue = function(locator, value) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'select-one') {\n    throw new Error(`Element with locator ${locator} is not a select`)\n  } else if (element.value !== value) {\n    throw new Error(\n      \"Actual value '\" + element.value + \"' did not match '\" + value + \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doVerifyNotSelectedValue = function(locator, value) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'select-one') {\n    throw new Error(`Element with locator ${locator} is not a select`)\n  } else if (element.value === value) {\n    throw new Error(\"Actual value '\" + element.value + \"' did match\")\n  }\n}\n\nSelenium.prototype.doVerifyText = function(locator, value) {\n  this.doAssertText(locator, value)\n}\n\nSelenium.prototype.doVerifyNotText = function(locator, value) {\n  this.doAssertNotText(locator, value)\n}\n\nSelenium.prototype.doVerifyValue = function(locator, value) {\n  let element = this.browserbot.findElement(locator)\n  if (element.value !== value) {\n    throw new Error(\n      \"Actual value '\" + element.value + \"' did not match '\" + value + \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doVerifyTitle = function(value) {\n  if (goog.string.normalizeSpaces(this.getTitle()) !== value) {\n    throw new Error(\n      \"Actual value '\" +\n        goog.string.normalizeSpaces(this.getTitle()) +\n        \"' did not match '\" +\n        value +\n        \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doVerifyElementPresent = function(locator) {\n  try {\n    this.browserbot.findElement(locator)\n  } catch (error) {\n    if (error.message.match(/Element[\\s\\S]*?not found/)) {\n      throw new Error(`Element with locator ${locator} could not be found`)\n    } else {\n      throw error\n    }\n  }\n}\n\nSelenium.prototype.doVerifyElementNotPresent = function(locator) {\n  try {\n    this.browserbot.findElement(locator)\n    throw new Error(`Element with locator ${locator} was found`)\n  } catch (error) {\n    if (!error.message.match(/Element[\\s\\S]*?not found/)) {\n      throw error\n    }\n  }\n}\n\nSelenium.prototype.doVerify = function(variableName, expected) {\n  return this.doAssert(variableName, expected)\n}\n\nSelenium.prototype.doAssert = function(variableName, expected) {\n  return new Promise((res, rej) => {\n    browser.runtime\n      .sendMessage({\n        getVar: true,\n        variable: variableName,\n      })\n      .then(actual => {\n        if (`${actual}` != expected) {\n          return rej(\n            \"Actual value '\" + actual + \"' did not match '\" + expected + \"'\"\n          )\n        }\n        return res()\n      })\n  })\n}\n\nSelenium.prototype.doAssertChecked = function(locator) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'checkbox' && element.type !== 'radio') {\n    throw new Error(\n      `Element with locator ${locator} is not a checkbox nor a radio button`\n    )\n  } else if (!element.checked) {\n    throw new Error(`Element with locator ${locator} is not checked`)\n  }\n}\n\nSelenium.prototype.doAssertNotChecked = function(locator) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'checkbox' && element.type !== 'radio') {\n    throw new Error(\n      `Element with locator ${locator} is not a checkbox nor a radio button`\n    )\n  } else if (element.checked) {\n    throw new Error(`Element with locator ${locator} is checked`)\n  }\n}\n\nSelenium.prototype.doAssertEditable = function(locator) {\n  if (!this.isEditable(locator)) {\n    throw new Error(`Element with locator ${locator} is not editable`)\n  }\n}\n\nSelenium.prototype.doAssertNotEditable = function(locator) {\n  if (this.isEditable(locator)) {\n    throw new Error(`Element with locator ${locator} is editable`)\n  }\n}\n\nSelenium.prototype.doAssertSelectedValue = function(locator, value) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'select-one') {\n    throw new Error(`Element with locator ${locator} is not a select`)\n  } else if (element.value !== value) {\n    throw new Error(\n      \"Actual value '\" + element.value + \"' did not match '\" + value + \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doVerifySelectedLabel = function(selectLocator, value) {\n  let selectedLabel = this.findSelectedOptionProperty(selectLocator, 'text')\n  if (selectedLabel !== value) {\n    throw new Error(\n      \"Actual label '\" + selectedLabel + \"' did not match '\" + value + \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doAssertSelectedLabel = function(selectLocator, value) {\n  let selectedLabel = this.findSelectedOptionProperty(selectLocator, 'text')\n  if (selectedLabel !== value) {\n    throw new Error(\n      \"Actual label '\" + selectedLabel + \"' did not match '\" + value + \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doAssertNotSelectedValue = function(locator, value) {\n  let element = this.browserbot.findElement(locator)\n  if (element.type !== 'select-one') {\n    throw new Error(`Element with locator ${locator} is not a select`)\n  } else if (element.value === value) {\n    throw new Error(\"Actual value '\" + element.value + \"' did match\")\n  }\n}\n\nSelenium.prototype.findElementVisible = function(locator) {\n  const element = this.browserbot.findElement(locator)\n  if (!bot.dom.isShown(element))\n    throw new Error(`Element ${locator} not visible`)\n  return element\n}\n\nSelenium.prototype.doAssertText = function(locator, value) {\n  const element = this.findElementVisible(locator)\n  const visibleText = bot.dom.getVisibleText(element).trim()\n  if (visibleText !== value) {\n    throw new Error(`Actual value \"${visibleText}\" did not match \"${value}\"`)\n  }\n}\n\nSelenium.prototype.doAssertNotText = function(locator, value) {\n  const element = this.findElementVisible(locator)\n  const visibleText = bot.dom.getVisibleText(element).trim()\n  if (visibleText === value) {\n    throw new Error(`Actual value \"${visibleText}\" did match \"${value}\"`)\n  }\n}\n\nSelenium.prototype.doAssertValue = function(locator, value) {\n  let element = this.browserbot.findElement(locator)\n  if (element.value !== value) {\n    throw new Error(\n      \"Actual value '\" + element.value + \"' did not match '\" + value + \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doAssertTitle = function(value) {\n  if (goog.string.normalizeSpaces(this.getTitle()) !== value) {\n    throw new Error(\n      \"Actual value '\" +\n        goog.string.normalizeSpaces(this.getTitle()) +\n        \"' did not match '\" +\n        value +\n        \"'\"\n    )\n  }\n}\n\nSelenium.prototype.doAssertElementPresent = function(locator) {\n  try {\n    this.browserbot.findElement(locator)\n  } catch (error) {\n    if (error.message.match(/Element[\\s\\S]*?not found/)) {\n      throw new Error(`Element with locator ${locator} could not be found`)\n    } else {\n      throw error\n    }\n  }\n}\n\nSelenium.prototype.doAssertElementNotPresent = function(locator) {\n  try {\n    this.browserbot.findElement(locator)\n    throw new Error(`Element with locator ${locator} was found`)\n  } catch (error) {\n    if (!error.message.match(/Element[\\s\\S]*?not found/)) {\n      throw error\n    }\n  }\n}\n\nfunction throwIfNoVarNameProvided(varName) {\n  if (!varName) {\n    throw new Error('No variable name provided.')\n  }\n}\n\nSelenium.prototype.doStore = function(value, varName) {\n  throwIfNoVarNameProvided(varName)\n  return browser.runtime.sendMessage({ storeStr: value, storeVar: varName })\n}\n\nSelenium.prototype.doStoreEval = function() {\n  throw new Error('store eval is obsolete please migrate to execute script')\n}\n\nSelenium.prototype.doStoreJson = function(json, varName) {\n  throwIfNoVarNameProvided(varName)\n  const result = JSON.parse(json)\n  return browser.runtime.sendMessage({ storeStr: result, storeVar: varName })\n}\n\nSelenium.prototype.doStoreText = function(locator, varName) {\n  throwIfNoVarNameProvided(varName)\n  let text\n  try {\n    // Try to get the text if the element is visible\n    const element = this.findElementVisible(locator)\n    text = bot.dom.getVisibleText(element).trim()\n  } catch (e) {\n    // element is not visible, but it may be due to the fact that it has no text\n    const element = this.browserbot.findElement(locator)\n    if (element.innerHTML === '') {\n      // element is empty then return empty string\n      text = ''\n    } else {\n      // element has content this is indeed invisible\n      throw e\n    }\n  }\n  return browser.runtime.sendMessage({\n    storeStr: text,\n    storeVar: varName,\n  })\n}\n\nSelenium.prototype.doStoreValue = function(locator, varName) {\n  throwIfNoVarNameProvided(varName)\n  let element = this.browserbot.findElement(locator)\n  return browser.runtime.sendMessage({\n    storeStr: element.value.trim(),\n    storeVar: varName,\n  })\n}\n\nSelenium.prototype.doStoreTitle = function(value, varName) {\n  throwIfNoVarNameProvided(varName)\n  let doc = selenium.browserbot.getDocument()\n  return browser.runtime.sendMessage({\n    storeStr: value || doc.title,\n    storeVar: varName,\n  })\n}\n\nSelenium.prototype.doStoreXpathCount = function(xpath, varName) {\n  throwIfNoVarNameProvided(varName)\n  let count = this.browserbot.evaluateXPathCount(\n    xpath,\n    this.browserbot.getDocument()\n  )\n  return browser.runtime.sendMessage({\n    storeStr: `${count}` || '0',\n    storeVar: varName,\n  })\n}\n\nSelenium.prototype.doStoreAttribute = function(locator, varName) {\n  throwIfNoVarNameProvided(varName)\n  let attributeValue = this.browserbot.findAttribute(locator)\n  return browser.runtime.sendMessage({\n    storeStr: attributeValue,\n    storeVar: varName,\n  })\n}\n\nfunction waitUntil(condition, target, timeout, failureMessage) {\n  if (!timeout) {\n    throw new Error('Timeout not specified.')\n  }\n  return new Promise(function(resolve, reject) {\n    let count = 0\n    let retryInterval = 100\n    let result\n    let interval = setInterval(function() {\n      if (count > timeout) {\n        clearInterval(interval)\n        reject(failureMessage)\n      }\n      try {\n        result = condition(target)\n      } catch (error) {\n        clearInterval(interval)\n        reject(error.message)\n      }\n      if (!result) {\n        count += retryInterval\n      } else if (result) {\n        clearInterval(interval)\n        resolve()\n      }\n    }, retryInterval)\n  })\n}\n\nSelenium.prototype.doWaitForElementPresent = function(locator, timeout) {\n  return waitUntil(\n    this.isElementPresent.bind(this),\n    locator,\n    timeout,\n    'Unable to find the target element within the timeout specified.'\n  )\n}\n\nSelenium.prototype.doWaitForElementNotPresent = function(locator, timeout) {\n  return waitUntil(\n    isElementNotPresent.bind(this),\n    locator,\n    timeout,\n    'Element still present on the page within the timeout specified.'\n  )\n}\n\nSelenium.prototype.doWaitForElementVisible = function(locator, timeout) {\n  return waitUntil(\n    isDisplayed.bind(this),\n    locator,\n    timeout,\n    'Element not visible on the page within the timeout specified.'\n  )\n}\n\nSelenium.prototype.doWaitForElementNotVisible = function(locator, timeout) {\n  return waitUntil(\n    isNotDisplayed.bind(this),\n    locator,\n    timeout,\n    'Element still visible on the page within the timeout specified.'\n  )\n}\n\nSelenium.prototype.doWaitForElementEditable = function(locator, timeout) {\n  return waitUntil(\n    isEditable.bind(this),\n    locator,\n    timeout,\n    'Element not editable within the timeout specified.'\n  )\n}\n\nSelenium.prototype.doWaitForElementNotEditable = function(locator, timeout) {\n  return waitUntil(\n    isNotEditable.bind(this),\n    locator,\n    timeout,\n    'Element still editable within the timeout specified.'\n  )\n}\n\n// xian\nSelenium.prototype.doWaitPreparation = function() {\n  // function setNewPageValue(e) {\n  //     window.new_page = true;\n  // };\n  // window.addEventListener(\"beforeunload\", setNewPageValue, false);\n\n  // if (window.XMLHttpRequest) {\n  //     // only override XMLHttpRequest once\n  //     if (!window.origXMLHttpRequest || !window.ajax_obj) {\n  //         // it's new page, so set the new window's XMLHttpRequest, and all of the obj in the ajax_obj\n  //         // are last window's instance, so clear it\n  //         window.ajax_obj = [];\n\n  //         window.origXMLHttpRequest = window.XMLHttpRequest;\n\n  //         window.XMLHttpRequest = function() {\n  //             var xhr = new window.origXMLHttpRequest();\n  //             window.ajax_obj.push(xhr);\n  //             return xhr;\n  //         }\n  //     }\n  // }\n\n  // function setDOMModifiedTime() {\n  //     window.domModifiedTime = Date.now();\n  // }\n  // var _win = window.document.body;\n  // _win.addEventListener(\"DOMNodeInserted\", setDOMModifiedTime, false);\n  // _win.addEventListener(\"DOMNodeInsertedIntoDocument\", setDOMModifiedTime, false);\n  // _win.addEventListener(\"DOMNodeRemoved\", setDOMModifiedTime, false);\n  // _win.addEventListener(\"DOMNodeRemovedFromDocument\", setDOMModifiedTime, false);\n  // _win.addEventListener(\"DOMSubtreeModified\", setDOMModifiedTime, false);\n\n  this.eval(\n    'function setNewPageValue(e) {window.new_page = true;};\\\n                window.addEventListener(\"beforeunload\", setNewPageValue, false);\\\n                if (window.XMLHttpRequest) {if (!window.origXMLHttpRequest || !window.ajax_obj) {\\\n                window.ajax_obj = []; window.origXMLHttpRequest = window.XMLHttpRequest;\\\n                window.XMLHttpRequest = function() { var xhr = new window.origXMLHttpRequest();\\\n                window.ajax_obj.push(xhr); return xhr;}}} function setDOMModifiedTime() {\\\n                window.domModifiedTime = Date.now();}var _win = window.document.body;\\\n                _win.addEventListener(\"DOMNodeInserted\", setDOMModifiedTime, false);\\\n                _win.addEventListener(\"DOMNodeInsertedIntoDocument\", setDOMModifiedTime, false);\\\n                _win.addEventListener(\"DOMNodeRemoved\", setDOMModifiedTime, false);\\\n                _win.addEventListener(\"DOMNodeRemovedFromDocument\", setDOMModifiedTime, false);\\\n                _win.addEventListener(\"DOMSubtreeModified\", setDOMModifiedTime, false);',\n    [],\n    false\n  )\n}\n\nSelenium.prototype.doPrePageWait = function() {\n  window.sideex_new_page = this.eval(\n    '(function() {return window.new_page;}())',\n    [],\n    false\n  )\n}\n\nSelenium.prototype.doPageWait = function() {\n  // if (window.document.readyState == \"complete\") {\n  //     return true;\n  // } else {\n  //     return false;\n  // }\n\n  let expression =\n    'if(window.document.readyState==\"complete\"){return true;}else{return false;}'\n  window.sideex_page_done = this.eval(\n    '(function() {' + expression + '}())',\n    [],\n    false\n  )\n}\n\nSelenium.prototype.doAjaxWait = function() {\n  // // check ajax wait\n  // if (window.ajax_obj) {\n  //     if (window.ajax_obj.length == 0) {\n  //         return true;\n  //     } else {\n  //         for (var index in window.ajax_obj) {\n  //         // if readyState is 1~3, then keep waiting\n  //             if (window.ajax_obj[index].readyState !== 4 &&\n  //                 window.ajax_obj[index].readyState !== undefined &&\n  //                 window.ajax_obj[index].readyState !== 0) {\n  //                     return false;\n  //             }\n  //         }\n  //         return true;\n  //     }\n  // } else {\n  //     if (window.origXMLHttpRequest) {\n  //         window.origXMLHttpRequest = \"\";\n  //     }\n  //     return true;\n  // }\n\n  let expression =\n    'if (window.ajax_obj) { if (window.ajax_obj.length == 0) {return true;} else {\\\n                      for (var index in window.ajax_obj) {\\\n                      if (window.ajax_obj[index].readyState !== 4 &&\\\n                      window.ajax_obj[index].readyState !== undefined &&\\\n                      window.ajax_obj[index].readyState !== 0) {return false;}}return true;}}\\\n                      else {if (window.origXMLHttpRequest) {window.origXMLHttpRequest = \"\";}return true;}'\n  window.sideex_ajax_done = this.eval(\n    '(function() {' + expression + '}())',\n    [],\n    false\n  )\n}\n\nSelenium.prototype.doDomWait = function() {\n  window.sideex_dom_time = this.eval(\n    '(function() {return window.domModifiedTime;}())',\n    [],\n    false\n  )\n}\n\nSelenium.prototype.doClick = function(locator) {\n  /**\n   * Clicks on a link, button, checkbox or radio button. If the click action\n   * causes a new page to load (like a link usually does), call\n   * waitForPageToLoad.\n   *\n   * @param locator an element locator\n   *\n   */\n  let element = this.browserbot.findElement(locator)\n  bot.action.click(element)\n}\n\nSelenium.prototype.doDoubleClick = function(locator) {\n  /**\n   * Double clicks on a link, button, checkbox or radio button. If the double click action\n   * causes a new page to load (like a link usually does), call\n   * waitForPageToLoad.\n   *\n   * @param locator an element locator\n   *\n   */\n  let element = this.browserbot.findElement(locator)\n  bot.action.doubleClick(element)\n}\n\nSelenium.prototype.doContextMenu = function(locator) {\n  /**\n   * Simulates opening the context menu for the specified element (as might happen if the user \"right-clicked\" on the element).\n   *\n   * @param locator an element locator\n   *\n   */\n  let element = this.browserbot.findElement(locator)\n  bot.action.rightClick(element)\n}\n\nSelenium.prototype.doClickAt = function(locator, coordString) {\n  /**\n   * Clicks on a link, button, checkbox or radio button. If the click action\n   * causes a new page to load (like a link usually does), call\n   * waitForPageToLoad.\n   *\n   * @param locator an element locator\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   *\n   */\n  let element = this.browserbot.findElement(locator)\n  let coords = getCoords(element, coordString)\n  bot.action.click(element, coords)\n}\n\nSelenium.prototype.doDoubleClickAt = function(locator, coordString) {\n  /**\n   * Doubleclicks on a link, button, checkbox or radio button. If the action\n   * causes a new page to load (like a link usually does), call\n   * waitForPageToLoad.\n   *\n   * @param locator an element locator\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   *\n   */\n  let element = this.browserbot.findElement(locator)\n  let coords = getCoords(element, coordString)\n  bot.action.doubleClick(element, coords)\n}\n\nSelenium.prototype.doContextMenuAt = function(locator, coordString) {\n  /**\n   * Simulates opening the context menu for the specified element (as might happen if the user \"right-clicked\" on the element).\n   *\n   * @param locator an element locator\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   *\n   */\n  let element = this.browserbot.findElement(locator)\n  let coords = getCoords(element, coordString)\n  bot.action.rightClick(element, coords)\n}\n\nSelenium.prototype.doFocus = function(locator) {\n  /** Move the focus to the specified element; for example, if the element is an input field, move the cursor to that field.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  if (element.focus) {\n    element.focus()\n  } else {\n    bot.events.fire(element, bot.events.EventType.FOCUS)\n  }\n}\n\nSelenium.prototype.doShiftKeyDown = function() {\n  /**\n   * Press the shift key and hold it down until doShiftUp() is called or a new page is loaded.\n   *\n   */\n  this.browserbot.shiftKeyDown = true\n  core.events.shiftKeyDown_ = true\n}\n\nSelenium.prototype.doShiftKeyUp = function() {\n  /**\n   * Release the shift key.\n   *\n   */\n  this.browserbot.shiftKeyDown = false\n  core.events.shiftKeyDown_ = false\n}\n\nSelenium.prototype.doMetaKeyDown = function() {\n  /**\n   * Press the meta key and hold it down until doMetaUp() is called or a new page is loaded.\n   *\n   */\n  this.browserbot.metaKeyDown = true\n  core.events.metaKeyDown_ = true\n}\n\nSelenium.prototype.doMetaKeyUp = function() {\n  /**\n   * Release the meta key.\n   *\n   */\n  this.browserbot.metaKeyDown = false\n  core.events.metaKeyDown_ = false\n}\n\nSelenium.prototype.doAltKeyDown = function() {\n  /**\n   * Press the alt key and hold it down until doAltUp() is called or a new page is loaded.\n   *\n   */\n  this.browserbot.altKeyDown = true\n  core.events.altKeyDown_ = true\n}\n\nSelenium.prototype.doAltKeyUp = function() {\n  /**\n   * Release the alt key.\n   *\n   */\n  this.browserbot.altKeyDown = false\n  core.events.altKeyDown_ = false\n}\n\nSelenium.prototype.doControlKeyDown = function() {\n  /**\n   * Press the control key and hold it down until doControlUp() is called or a new page is loaded.\n   *\n   */\n  this.browserbot.controlKeyDown = true\n  core.events.controlKeyDown_ = true\n}\n\nSelenium.prototype.doControlKeyUp = function() {\n  /**\n   * Release the control key.\n   *\n   */\n  this.browserbot.controlKeyDown = false\n  core.events.controlKeyDown_ = false\n}\n\nfunction getClientXY(element, coordString) {\n  // Parse coordString\n  let coords = null\n  let x\n  let y\n  if (coordString) {\n    coords = coordString.split(/,/)\n    x = Number(coords[0])\n    y = Number(coords[1])\n  } else {\n    x = y = 0\n  }\n\n  // Get position of element,\n  // Return 2 item array with clientX and clientY\n  return [\n    Selenium.prototype.getElementPositionLeft(element) + x,\n    Selenium.prototype.getElementPositionTop(element) + y,\n  ]\n}\n\nfunction getCoords(_element, coordString) {\n  // Parse coordString\n  let coords = null\n  let x\n  let y\n  if (coordString) {\n    coords = coordString.split(/,/)\n    x = Number(coords[0])\n    y = Number(coords[1])\n  } else {\n    x = y = 0\n  }\n\n  return new goog.math.Coordinate(x, y)\n}\n\nSelenium.prototype.prepareToInteract_ = function(locator) {\n  let element = this.browserbot.findElement(locator)\n  let rect = element.getBoundingClientRect()\n  bot.action.prepareToInteractWith_(\n    element,\n    new goog.math.Coordinate(rect.width / 2, rect.height / 2)\n  )\n  return element.getBoundingClientRect()\n}\n\nSelenium.prototype.doMouseOver = function(locator) {\n  /**\n   * Simulates a user hovering a mouse over the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n\n  let element = this.browserbot.findElement(locator)\n  let rect = element.getBoundingClientRect()\n  bot.action.moveMouse(\n    element,\n    new goog.math.Coordinate(rect.width / 2, rect.height / 2)\n  )\n}\n\nSelenium.prototype.doMouseOut = function(locator) {\n  /**\n   * Simulates a user moving the mouse pointer away from the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  this.browserbot.triggerMouseEvent(element, 'mouseout', true)\n}\n\nSelenium.prototype.doMouseDown = function(locator) {\n  /**\n   * Simulates a user pressing the left mouse button (without releasing it yet) on\n   * the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  this.browserbot.triggerMouseEvent(element, 'mousedown', true)\n}\n\nSelenium.prototype.doMouseDownRight = function(locator) {\n  /**\n   * Simulates a user pressing the right mouse button (without releasing it yet) on\n   * the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousedown',\n    true,\n    undefined,\n    undefined,\n    Selenium.RIGHT_MOUSE_CLICK\n  )\n}\n\nSelenium.prototype.doMouseDownAt = function(locator, coordString) {\n  /**\n   * Simulates a user pressing the left mouse button (without releasing it yet) at\n   * the specified location.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   */\n  let element = this.browserbot.findElement(locator)\n  let clientXY = getClientXY(element, coordString)\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousedown',\n    true,\n    clientXY[0],\n    clientXY[1]\n  )\n}\n\nSelenium.prototype.doMouseDownRightAt = function(locator, coordString) {\n  /**\n   * Simulates a user pressing the right mouse button (without releasing it yet) at\n   * the specified location.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   */\n  let element = this.browserbot.findElement(locator)\n  let clientXY = getClientXY(element, coordString)\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousedown',\n    true,\n    clientXY[0],\n    clientXY[1],\n    Selenium.RIGHT_MOUSE_CLICK\n  )\n}\n\nSelenium.prototype.doMouseUp = function(locator) {\n  /**\n   * Simulates the event that occurs when the user releases the mouse button (i.e., stops\n   * holding the button down) on the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  this.browserbot.triggerMouseEvent(element, 'mouseup', true)\n}\n\nSelenium.prototype.doMouseUpRight = function(locator) {\n  /**\n   * Simulates the event that occurs when the user releases the right mouse button (i.e., stops\n   * holding the button down) on the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mouseup',\n    true,\n    undefined,\n    undefined,\n    Selenium.RIGHT_MOUSE_CLICK\n  )\n}\n\nSelenium.prototype.doMouseUpAt = function(locator, coordString) {\n  /**\n   * Simulates the event that occurs when the user releases the mouse button (i.e., stops\n   * holding the button down) at the specified location.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   */\n  let element = this.browserbot.findElement(locator)\n  let clientXY = getClientXY(element, coordString)\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mouseup',\n    true,\n    clientXY[0],\n    clientXY[1]\n  )\n}\n\nSelenium.prototype.doMouseUpRightAt = function(locator, coordString) {\n  /**\n   * Simulates the event that occurs when the user releases the right mouse button (i.e., stops\n   * holding the button down) at the specified location.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   */\n  let element = this.browserbot.findElement(locator)\n  let clientXY = getClientXY(element, coordString)\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mouseup',\n    true,\n    clientXY[0],\n    clientXY[1],\n    Selenium.RIGHT_MOUSE_CLICK\n  )\n}\n\nSelenium.prototype.doMouseMove = function(locator) {\n  /**\n   * Simulates a user pressing the mouse button (without releasing it yet) on\n   * the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  let element = this.browserbot.findElement(locator)\n  this.browserbot.triggerMouseEvent(element, 'mousemove', true)\n}\n\nSelenium.prototype.doMouseMoveAt = function(locator, coordString) {\n  /**\n   * Simulates a user pressing the mouse button (without releasing it yet) on\n   * the specified element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param coordString specifies the x,y position (i.e. - 10,20) of the mouse\n   *      event relative to the element returned by the locator.\n   */\n\n  let element = this.browserbot.findElement(locator)\n  let clientXY = getClientXY(element, coordString)\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousemove',\n    true,\n    clientXY[0],\n    clientXY[1]\n  )\n}\n\nSelenium.prototype.doType = function(locator, value) {\n  /**\n   * Sets the value of an input field, as though you typed it in.\n   *\n   * <p>Can also be used to set the value of combo boxes, check boxes, etc. In these cases,\n   * value should be the value of the option selected, not the visible text.</p>\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param value the value to type\n   */\n  if (\n    this.browserbot.controlKeyDown ||\n    this.browserbot.altKeyDown ||\n    this.browserbot.metaKeyDown\n  ) {\n    throw new SeleniumError(\n      'type not supported immediately after call to controlKeyDown() or altKeyDown() or metaKeyDown()'\n    )\n  }\n\n  let element = this.browserbot.findElement(locator)\n\n  core.events.setValue(element, '')\n  const type = element.type\n  if (type === 'number' || type === 'date') {\n    core.events.setValue(element, value)\n  } else {\n    bot.action.type(element, value)\n    if (element.value !== value) {\n      core.events.setValue(element, value)\n    }\n  }\n  bot.events.fire(element, bot.events.EventType.CHANGE)\n}\n\nSelenium.prototype.doSendKeys = function(locator, value) {\n  /**\n   * *Experimental* Simulates keystroke events on the specified element, as though you typed the value key-by-key.\n   *\n   * <p>This simulates a real user typing every character in the specified string; it is also bound by the limitations of a\n   * real user, like not being able to type into a invisible or read only elements. This is useful for dynamic UI widgets\n   * (like auto-completing combo boxes) that require explicit key events.</p>\n   * <p>Unlike the simple \"type\" command, which forces the specified value into the page directly, this command will not\n   * replace the existing content. If you want to replace the existing contents, you need to use the simple \"type\" command to set the value of the\n   * field to empty string to clear the field and then the \"sendKeys\" command to send the keystroke for what you want\n   * to type.</p>\n   * <p>This command is experimental. It may replace the typeKeys command in the future.</p>\n   * <p>For those who are interested in the details, unlike the typeKeys command, which tries to\n   * fire the keyDown, the keyUp and the keyPress events, this command is backed by the atoms from Selenium 2 and provides a\n   * much more robust implementation that will be maintained in the future.</p>\n   *\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @param value the value to type\n   */\n  if (\n    this.browserbot.controlKeyDown ||\n    this.browserbot.altKeyDown ||\n    this.browserbot.metaKeyDown\n  ) {\n    throw new SeleniumError(\n      'type not supported immediately after call to controlKeyDown() or altKeyDown() or metaKeyDown()'\n    )\n  }\n\n  let element = this.browserbot.findElement(locator)\n  let keys = this.replaceKeys(value)\n  bot.action.type(element, keys)\n  bot.events.fire(element, bot.events.EventType.CHANGE)\n}\n\nSelenium.prototype.doSetSpeed = function() {\n  /**\n   * Set execution speed (i.e., set the millisecond length of a delay which will follow each selenium operation).  By default, there is no such delay, i.e.,\n   * the delay is 0 milliseconds.\n   *\n   * @param value the number of milliseconds to pause after operation\n   */\n  throw new SeleniumError(\n    'this operation is only implemented in selenium-rc, and should never result in a request making it across the wire'\n  )\n}\n\nSelenium.prototype.getSpeed = function() {\n  /**\n   * Get execution speed (i.e., get the millisecond length of the delay following each selenium operation).  By default, there is no such delay, i.e.,\n   * the delay is 0 milliseconds.\n   *\n   * See also setSpeed.\n   *\n   * @return string the execution speed in milliseconds.\n   */\n  throw new SeleniumError(\n    'this operation is only implemented in selenium-rc, and should never result in a request making it across the wire'\n  )\n}\n\nSelenium.prototype.findToggleButton = function(locator) {\n  let element = this.browserbot.findElement(locator)\n  if (element.checked == null) {\n    throw new Error('Element ' + locator + ' is not a toggle-button.') // eslint-disable-line no-undef\n  }\n  return element\n}\n\nSelenium.prototype.doCheck = function(locator) {\n  /**\n   * Check a toggle-button (checkbox/radio)\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  this.findToggleButton(locator).checked = true\n}\n\nSelenium.prototype.doUncheck = function(locator) {\n  /**\n   * Uncheck a toggle-button (checkbox/radio)\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   */\n  this.findToggleButton(locator).checked = false\n}\n\nSelenium.prototype.doSelect = function(selectLocator, optionLocator) {\n  /**\n   * Select an option from a drop-down using an option locator.\n   *\n   * <p>\n   * Option locators provide different ways of specifying options of an HTML\n   * Select element (e.g. for selecting a specific option, or for asserting\n   * that the selected option satisfies a specification). There are several\n   * forms of Select Option Locator.\n   * </p>\n   * <ul>\n   * <li><strong>label</strong>=<em>labelPattern</em>:\n   * matches options based on their labels, i.e. the visible text. (This\n   * is the default.)\n   * <ul class=\"first last simple\">\n   * <li>label=regexp:^[Oo]ther</li>\n   * </ul>\n   * </li>\n   * <li><strong>value</strong>=<em>valuePattern</em>:\n   * matches options based on their values.\n   * <ul class=\"first last simple\">\n   * <li>value=other</li>\n   * </ul>\n   *\n   *\n   * </li>\n   * <li><strong>id</strong>=<em>id</em>:\n   *\n   * matches options based on their ids.\n   * <ul class=\"first last simple\">\n   * <li>id=option1</li>\n   * </ul>\n   * </li>\n   * <li><strong>index</strong>=<em>index</em>:\n   * matches an option based on its index (offset from zero).\n   * <ul class=\"first last simple\">\n   *\n   * <li>index=2</li>\n   * </ul>\n   * </li>\n   * </ul>\n   * <p>\n   * If no option locator prefix is provided, the default behaviour is to match on <strong>label</strong>.\n   * </p>\n   *\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @param optionLocator an option locator (a label by default)\n   */\n  let element = this.browserbot.findElement(selectLocator)\n  if (!('options' in element)) {\n    throw new SeleniumError(\n      'Specified element is not a Select (has no options)'\n    )\n  }\n  let locator = this.optionLocatorFactory.fromLocatorString(optionLocator)\n  let option = locator.findOption(element)\n  this.browserbot.selectOption(element, option)\n}\n\nSelenium.prototype.doAddSelection = function(locator, optionLocator) {\n  /**\n   * Add a selection to the set of selected options in a multi-select element using an option locator.\n   *\n   * @see #doSelect for details of option locators\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> identifying a multi-select box\n   * @param optionLocator an option locator (a label by default)\n   */\n  let element = this.browserbot.findElement(locator)\n  if (!('options' in element)) {\n    throw new SeleniumError(\n      'Specified element is not a Select (has no options)'\n    )\n  }\n  let currLocator = this.optionLocatorFactory.fromLocatorString(optionLocator)\n  let option = currLocator.findOption(element)\n  this.browserbot.addSelection(element, option)\n}\n\nSelenium.prototype.doRemoveSelection = function(locator, optionLocator) {\n  /**\n   * Remove a selection from the set of selected options in a multi-select element using an option locator.\n   *\n   * @see #doSelect for details of option locators\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> identifying a multi-select box\n   * @param optionLocator an option locator (a label by default)\n   */\n\n  let element = this.browserbot.findElement(locator)\n  if (!('options' in element)) {\n    throw new SeleniumError(\n      'Specified element is not a Select (has no options)'\n    )\n  }\n  let currLocator = this.optionLocatorFactory.fromLocatorString(optionLocator)\n  let option = currLocator.findOption(element)\n  this.browserbot.removeSelection(element, option)\n}\n\nSelenium.prototype.doRemoveAllSelections = function(locator) {\n  /**\n   * Unselects all of the selected options in a multi-select element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> identifying a multi-select box\n   */\n  let element = this.browserbot.findElement(locator)\n  if (!('options' in element)) {\n    throw new SeleniumError(\n      'Specified element is not a Select (has no options)'\n    )\n  }\n  for (let i = 0; i < element.options.length; i++) {\n    this.browserbot.removeSelection(element, element.options[i])\n  }\n}\n\nSelenium.prototype.doSubmit = function(formLocator) {\n  /**\n   * Submit the specified form. This is particularly useful for forms without\n   * submit buttons, e.g. single-input \"Search\" forms.\n   *\n   * @param formLocator an <a href=\"#locators\">element locator</a> for the form you want to submit\n   */\n  browser.runtime.sendMessage({\n    log: {\n      type: 'warn',\n      message:\n        'submit is deprecated and will be removed from later versions of Selenium IDE, please re-record the step.',\n    },\n  })\n  let form = this.browserbot.findElement(formLocator)\n  return bot.action.submit(form)\n}\n\nSelenium.prototype.makePageLoadCondition = function(timeout) {\n  if (timeout == null) {\n    timeout = this.defaultTimeout\n  }\n  // if the timeout is zero, we won't wait for the page to load before returning\n  if (timeout == 0) {\n    // abort XHR request\n    this._abortXhrRequest()\n    return\n  }\n  return Selenium.decorateFunctionWithTimeout(\n    this._isNewPageLoaded.bind(this),\n    timeout,\n    this._abortXhrRequest.bind(this)\n  )\n}\n\nSelenium.prototype.doOpen = function(url, ignoreResponseCode) {\n  /**\n   * Opens an URL in the test frame. This accepts both relative and absolute\n   * URLs.\n   *\n   * The &quot;open&quot; command waits for the page to load before proceeding,\n   * ie. the &quot;AndWait&quot; suffix is implicit.\n   *\n   * <em>Note</em>: The URL must be on the same domain as the runner HTML\n   * due to security restrictions in the browser (Same Origin Policy). If you\n   * need to open an URL on another domain, use the Selenium Server to start a\n   * new browser session on that domain.\n   *\n   * @param url the URL to open; may be relative or absolute\n   * @param ignoreResponseCode (optional) turn off ajax head request functionality\n   *\n   */\n  if (ignoreResponseCode == null || ignoreResponseCode.length == 0) {\n    this.browserbot.ignoreResponseCode = true\n  } else if (ignoreResponseCode.toLowerCase() == 'true') {\n    this.browserbot.ignoreResponseCode = true\n  } else {\n    this.browserbot.ignoreResponseCode = false\n  }\n  this.browserbot.openLocation(url)\n  if (window['proxyInjectionMode'] == null || !window['proxyInjectionMode']) {\n    return this.makePageLoadCondition()\n  } // in PI mode, just return \"OK\"; the server will waitForLoad\n}\n\nSelenium.prototype.doOpenWindow = function(url, windowID) {\n  /**\n   * Opens a popup window (if a window with that ID isn't already open).\n   * After opening the window, you'll need to select it using the selectWindow\n   * command.\n   *\n   * <p>This command can also be a useful workaround for bug SEL-339.  In some cases, Selenium will be unable to intercept a call to window.open (if the call occurs during or before the \"onLoad\" event, for example).\n   * In those cases, you can force Selenium to notice the open window's name by using the Selenium openWindow command, using\n   * an empty (blank) url, like this: openWindow(\"\", \"myFunnyWindow\").</p>\n   *\n   * @param url the URL to open, which can be blank\n   * @param windowID the JavaScript window ID of the window to select\n   */\n  this.browserbot.openWindow(url, windowID)\n}\n\nSelenium.prototype.doSelectWindow = function(windowID) {\n  /**\n   * Selects a popup window using a window locator; once a popup window has been selected, all\n   * commands go to that window. To select the main window again, use null\n   * as the target.\n   *\n   * <p>\n   *\n   * Window locators provide different ways of specifying the window object:\n   * by title, by internal JavaScript \"name,\" or by JavaScript variable.\n   * </p>\n   * <ul>\n   * <li><strong>title</strong>=<em>My Special Window</em>:\n   * Finds the window using the text that appears in the title bar.  Be careful;\n   * two windows can share the same title.  If that happens, this locator will\n   * just pick one.\n   * </li>\n   * <li><strong>name</strong>=<em>myWindow</em>:\n   * Finds the window using its internal JavaScript \"name\" property.  This is the second\n   * parameter \"windowName\" passed to the JavaScript method window.open(url, windowName, windowFeatures, replaceFlag)\n   * (which Selenium intercepts).\n   * </li>\n   * <li><strong>var</strong>=<em>variableName</em>:\n   * Some pop-up windows are unnamed (anonymous), but are associated with a JavaScript variable name in the current\n   * application window, e.g. \"window.foo = window.open(url);\".  In those cases, you can open the window using\n   * \"var=foo\".\n   * </li>\n   * </ul>\n   * <p>\n   * If no window locator prefix is provided, we'll try to guess what you mean like this:</p>\n   * <p>1.) if windowID is null, (or the string \"null\") then it is assumed the user is referring to the original window instantiated by the browser).</p>\n   * <p>2.) if the value of the \"windowID\" parameter is a JavaScript variable name in the current application window, then it is assumed\n   * that this variable contains the return value from a call to the JavaScript window.open() method.</p>\n   * <p>3.) Otherwise, selenium looks in a hash it maintains that maps string names to window \"names\".</p>\n   * <p>4.) If <em>that</em> fails, we'll try looping over all of the known windows to try to find the appropriate \"title\".\n   * Since \"title\" is not necessarily unique, this may have unexpected behavior.</p>\n   *\n   * <p>If you're having trouble figuring out the name of a window that you want to manipulate, look at the Selenium log messages\n   * which identify the names of windows created via window.open (and therefore intercepted by Selenium).  You will see messages\n   * like the following for each window as it is opened:</p>\n   *\n   * <p><code>debug: window.open call intercepted; window ID (which you can use with selectWindow()) is \"myNewWindow\"</code></p>\n   *\n   * <p>In some cases, Selenium will be unable to intercept a call to window.open (if the call occurs during or before the \"onLoad\" event, for example).\n   * (This is bug SEL-339.)  In those cases, you can force Selenium to notice the open window's name by using the Selenium openWindow command, using\n   * an empty (blank) url, like this: openWindow(\"\", \"myFunnyWindow\").</p>\n   *\n   * @param windowID the JavaScript window ID of the window to select\n   */\n  this.browserbot.selectWindow(windowID)\n}\n\nSelenium.prototype.doSelectPopUp = function(windowID) {\n  /**\n   * Simplifies the process of selecting a popup window (and does not offer\n   * functionality beyond what <code>selectWindow()</code> already provides).\n   * <ul>\n   * <li>If <code>windowID</code> is either not specified, or specified as\n   * \"null\", the first non-top window is selected. The top window is the one\n   * that would be selected by <code>selectWindow()</code> without providing a\n   * <code>windowID</code> . This should not be used when more than one popup\n   * window is in play.</li>\n   * <li>Otherwise, the window will be looked up considering\n   * <code>windowID</code> as the following in order: 1) the \"name\" of the\n   * window, as specified to <code>window.open()</code>; 2) a javascript\n   * variable which is a reference to a window; and 3) the title of the\n   * window. This is the same ordered lookup performed by\n   * <code>selectWindow</code> .</li>\n   * </ul>\n   *\n   * @param windowID  an identifier for the popup window, which can take on a\n   *                  number of different meanings\n   */\n  this.browserbot.selectPopUp(windowID)\n}\n\nSelenium.prototype.doDeselectPopUp = function() {\n  /**\n   * Selects the main window. Functionally equivalent to using\n   * <code>selectWindow()</code> and specifying no value for\n   * <code>windowID</code>.\n   */\n  this.browserbot.selectWindow()\n}\n\nSelenium.prototype.doSelectFrame = function(locator) {\n  /**\n   * Selects a frame within the current window.  (You may invoke this command\n   * multiple times to select nested frames.)  To select the parent frame, use\n   * \"relative=parent\" as a locator; to select the top frame, use \"relative=top\".\n   * You can also select a frame by its 0-based index number; select the first frame with\n   * \"index=0\", or the third frame with \"index=2\".\n   *\n   * <p>You may also use a DOM expression to identify the frame you want directly,\n   * like this: <code>dom=frames[\"main\"].frames[\"subframe\"]</code></p>\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> identifying a frame or iframe\n   */\n  this.browserbot.selectFrame(locator)\n}\n\nSelenium.prototype.getWhetherThisFrameMatchFrameExpression = function(\n  currentFrameString,\n  target\n) {\n  /**\n   * Determine whether current/locator identify the frame containing this running code.\n   *\n   * <p>This is useful in proxy injection mode, where this code runs in every\n   * browser frame and window, and sometimes the selenium server needs to identify\n   * the \"current\" frame.  In this case, when the test calls selectFrame, this\n   * routine is called for each frame to figure out which one has been selected.\n   * The selected frame will return true, while all others will return false.</p>\n   *\n   * @param currentFrameString starting frame\n   * @param target new frame (which might be relative to the current one)\n   * @return boolean true if the new frame is this code's window\n   */\n  return this.browserbot.doesThisFrameMatchFrameExpression(\n    currentFrameString,\n    target\n  )\n}\n\nSelenium.prototype.getWhetherThisWindowMatchWindowExpression = function(\n  _currentWindowString,\n  target\n) {\n  /**\n   * Determine whether currentWindowString plus target identify the window containing this running code.\n   *\n   * <p>This is useful in proxy injection mode, where this code runs in every\n   * browser frame and window, and sometimes the selenium server needs to identify\n   * the \"current\" window.  In this case, when the test calls selectWindow, this\n   * routine is called for each window to figure out which one has been selected.\n   * The selected window will return true, while all others will return false.</p>\n   *\n   * @param currentWindowString starting window\n   * @param target new window (which might be relative to the current one, e.g., \"_parent\")\n   * @return boolean true if the new window is this code's window\n   */\n  if (\n    window.opener != null &&\n    window.opener[target] != null &&\n    window.opener[target] == window\n  ) {\n    return true\n  }\n  return false\n}\n\nSelenium.prototype.doWaitForPopUp = function(windowID, timeout) {\n  /**\n   * Waits for a popup window to appear and load up.\n   *\n   * @param windowID the JavaScript window \"name\" of the window that will appear (not the text of the title bar)\n   *                 If unspecified, or specified as \"null\", this command will\n   *                 wait for the first non-top window to appear (don't rely\n   *                 on this if you are working with multiple popups\n   *                 simultaneously).\n   * @param timeout a timeout in milliseconds, after which the action will return with an error.\n   *                If this value is not specified, the default Selenium\n   *                timeout will be used. See the setTimeout() command.\n   */\n  if (!timeout) {\n    timeout = this.defaultTimeout\n  }\n  let timeoutTime = getTimeoutTime(timeout)\n\n  let popupLoadedPredicate = function() {\n    let targetWindow\n    try {\n      if (windowID && windowID != 'null') {\n        targetWindow = selenium.browserbot.getWindowByName(windowID, true)\n      } else {\n        let names = selenium.browserbot.getNonTopWindowNames()\n        targetWindow = selenium.browserbot.getWindowByName(names[0], true)\n      }\n    } catch (e) {\n      if (new Date().getTime() > timeoutTime) {\n        throw e\n      }\n    }\n\n    if (!targetWindow) return false\n    try {\n      if (!targetWindow.location) return false\n      if ('about:blank' == targetWindow.location) return false\n    } catch (e) {\n      //LOG.debug(\"Location exception (\" + e.message + \")!\");\n      return false\n    }\n    if (browserVersion.isKonqueror) {\n      if ('/' == targetWindow.location.href) {\n        // apparently Konqueror uses this as the temporary location, instead of about:blank\n        return false\n      }\n    }\n    if (browserVersion.isSafari) {\n      if (\n        targetWindow.location.href ==\n        selenium.browserbot.buttonWindow.location.href\n      ) {\n        // Apparently Safari uses this as the temporary location, instead of about:blank\n        // what a world!\n        //LOG.debug(\"DGF what a world!\");\n        return false\n      }\n    }\n    if (!targetWindow.document) return false\n    if (!selenium.browserbot.getCurrentWindow().document.readyState) {\n      // This is Firefox, with no readyState extension\n      return true\n    }\n    if ('complete' != targetWindow.document.readyState) return false\n    return true\n  }\n\n  return Selenium.decorateFunctionWithTimeout(popupLoadedPredicate, timeout)\n}\n\nSelenium.prototype.doWaitForPopUp.dontCheckAlertsAndConfirms = true\n\n//Selenium.prototype.doChooseCancelOnNextConfirmation = function() {\n/**\n * <p>\n * By default, Selenium's overridden window.confirm() function will\n * return true, as if the user had manually clicked OK; after running\n * this command, the next call to confirm() will return false, as if\n * the user had clicked Cancel.  Selenium will then resume using the\n * default behavior for future confirmations, automatically returning\n * true (OK) unless/until you explicitly call this command for each\n * confirmation.\n * </p>\n * <p>\n * Take note - every time a confirmation comes up, you must\n * consume it with a corresponding getConfirmation, or else\n * the next selenium operation will fail.\n * </p>\n */\n//this.browserbot.cancelNextConfirmation(false);\n//};\n\n//Selenium.prototype.doChooseOkOnNextConfirmation = function() {\n/**\n * <p>\n * Undo the effect of calling chooseCancelOnNextConfirmation.  Note\n * that Selenium's overridden window.confirm() function will normally automatically\n * return true, as if the user had manually clicked OK, so you shouldn't\n * need to use this command unless for some reason you need to change\n * your mind prior to the next confirmation.  After any confirmation, Selenium will resume using the\n * default behavior for future confirmations, automatically returning\n * true (OK) unless/until you explicitly call chooseCancelOnNextConfirmation for each\n * confirmation.\n * </p>\n * <p>\n * Take note - every time a confirmation comes up, you must\n * consume it with a corresponding getConfirmation, or else\n * the next selenium operation will fail.\n * </p>\n *\n */\n//this.browserbot.cancelNextConfirmation(true);\n//};\n\n//Selenium.prototype.doAnswerOnNextPrompt = function(answer) {\n/**\n * Instructs Selenium to return the specified answer string in response to\n * the next JavaScript prompt [window.prompt()].\n *\n *\n * @param answer the answer to give in response to the prompt pop-up\n */\n//this.browserbot.setNextPromptResult(answer);\n//};\n\nSelenium.prototype.doGoBack = function() {\n  /**\n   * Simulates the user clicking the \"back\" button on their browser.\n   *\n   */\n  this.browserbot.goBack()\n}\n\nSelenium.prototype.doRefresh = function() {\n  /**\n   * Simulates the user clicking the \"Refresh\" button on their browser.\n   *\n   */\n  this.browserbot.refresh()\n}\n\nSelenium.prototype.doClose = function() {\n  /**\n   * Simulates the user clicking the \"close\" button in the titlebar of a popup\n   * window or tab.\n   */\n  this.browserbot.close()\n}\n\nSelenium.prototype.ensureNoUnhandledPopups = function() {\n  if (this.browserbot.hasAlerts()) {\n    throw new SeleniumError(\n      'There was an unexpected Alert! [' + this.browserbot.getNextAlert() + ']'\n    )\n  }\n  if (this.browserbot.hasConfirmations()) {\n    throw new SeleniumError(\n      'There was an unexpected Confirmation! [' +\n        this.browserbot.getNextConfirmation() +\n        ']'\n    )\n  }\n}\n\nSelenium.prototype.isAlertPresent = function() {\n  /**\n   * Has an alert occurred?\n   *\n   * <p>\n   * This function never throws an exception\n   * </p>\n   * @return boolean true if there is an alert\n   */\n  return this.browserbot.hasAlerts()\n}\n\nSelenium.prototype.isPromptPresent = function() {\n  /**\n   * Has a prompt occurred?\n   *\n   * <p>\n   * This function never throws an exception\n   * </p>\n   * @return boolean true if there is a pending prompt\n   */\n  return this.browserbot.hasPrompts()\n}\n\nSelenium.prototype.isConfirmationPresent = function() {\n  /**\n   * Has confirm() been called?\n   *\n   * <p>\n   * This function never throws an exception\n   * </p>\n   * @return boolean true if there is a pending confirmation\n   */\n  return this.browserbot.hasConfirmations()\n}\nSelenium.prototype.getAlert = function() {\n  /**\n     * Retrieves the message of a JavaScript alert generated during the previous action, or fail if there were no alerts.\n     *\n     * <p>Getting an alert has the same effect as manually clicking OK. If an\n     * alert is generated but you do not consume it with getAlert, the next Selenium action\n     * will fail.</p>\n     *\n     * <p>Under Selenium, JavaScript alerts will NOT pop up a visible alert\n     * dialog.</p>\n     *\n     * <p>Selenium does NOT support JavaScript alerts that are generated in a\n     * page's onload() event handler. In this case a visible dialog WILL be\n     * generated and Selenium will hang until someone manually clicks OK.</p>\n     * @return string The message of the most recent JavaScript alert\n\n     */\n  if (!this.browserbot.hasAlerts()) {\n    Assert.fail('There were no alerts') // eslint-disable-line no-undef\n  }\n  return this.browserbot.getNextAlert()\n}\nSelenium.prototype.getAlert.dontCheckAlertsAndConfirms = true\n\nSelenium.prototype.getConfirmation = function() {\n  /**\n   * Retrieves the message of a JavaScript confirmation dialog generated during\n   * the previous action.\n   *\n   * <p>\n   * By default, the confirm function will return true, having the same effect\n   * as manually clicking OK. This can be changed by prior execution of the\n   * chooseCancelOnNextConfirmation command.\n   * </p>\n   * <p>\n   * If an confirmation is generated but you do not consume it with getConfirmation,\n   * the next Selenium action will fail.\n   * </p>\n   *\n   * <p>\n   * NOTE: under Selenium, JavaScript confirmations will NOT pop up a visible\n   * dialog.\n   * </p>\n   *\n   * <p>\n   * NOTE: Selenium does NOT support JavaScript confirmations that are\n   * generated in a page's onload() event handler. In this case a visible\n   * dialog WILL be generated and Selenium will hang until you manually click\n   * OK.\n   * </p>\n   *\n   * @return string the message of the most recent JavaScript confirmation dialog\n   */\n  if (!this.browserbot.hasConfirmations()) {\n    Assert.fail('There were no confirmations') // eslint-disable-line no-undef\n  }\n  return this.browserbot.getNextConfirmation()\n}\nSelenium.prototype.getConfirmation.dontCheckAlertsAndConfirms = true\n\nSelenium.prototype.getPrompt = function() {\n  /**\n   * Retrieves the message of a JavaScript question prompt dialog generated during\n   * the previous action.\n   *\n   * <p>Successful handling of the prompt requires prior execution of the\n   * answerOnNextPrompt command. If a prompt is generated but you\n   * do not get/verify it, the next Selenium action will fail.</p>\n   *\n   * <p>NOTE: under Selenium, JavaScript prompts will NOT pop up a visible\n   * dialog.</p>\n   *\n   * <p>NOTE: Selenium does NOT support JavaScript prompts that are generated in a\n   * page's onload() event handler. In this case a visible dialog WILL be\n   * generated and Selenium will hang until someone manually clicks OK.</p>\n   * @return string the message of the most recent JavaScript question prompt\n   */\n  if (!this.browserbot.hasPrompts()) {\n    Assert.fail('There were no prompts') // eslint-disable-line no-undef\n  }\n  return this.browserbot.getNextPrompt()\n}\n\nSelenium.prototype.getLocation = function() {\n  /** Gets the absolute URL of the current page.\n   *\n   * @return string the absolute URL of the current page\n   */\n  return this.browserbot.getCurrentWindow().location.href\n}\n\nSelenium.prototype.getTitle = function() {\n  /** Gets the title of the current page.\n   *\n   * @return string the title of the current page\n   */\n  return this.browserbot.getTitle()\n}\n\nSelenium.prototype.getBodyText = function() {\n  /**\n   * Gets the entire text of the page.\n   * @return string the entire text of the page\n   */\n  return this.browserbot.bodyText()\n}\n\nSelenium.prototype.getValue = function(locator) {\n  /**\n   * Gets the (whitespace-trimmed) value of an input field (or anything else with a value parameter).\n   * For checkbox/radio elements, the value will be \"on\" or \"off\" depending on\n   * whether the element is checked or not.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @return string the element value, or \"on/off\" for checkbox/radio elements\n   */\n  let element = this.browserbot.findElement(locator)\n  return element.value.trim()\n}\n\nSelenium.prototype.getText = function(locator) {\n  /**\n   * Gets the text of an element. This works for any element that contains\n   * text. This command uses either the textContent (Mozilla-like browsers) or\n   * the innerText (IE-like browsers) of the element, which is the rendered\n   * text shown to the user.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @return string the text of the element\n   */\n  let element = this.browserbot.findElement(locator)\n  return bot.dom.getVisibleText(element).trim()\n}\n\nSelenium.prototype.getEval = function(script) {\n  /** Gets the result of evaluating the specified JavaScript snippet.  The snippet may\n   * have multiple lines, but only the result of the last line will be returned.\n   *\n   * <p>Note that, by default, the snippet will run in the context of the \"selenium\"\n   * object itself, so <code>this</code> will refer to the Selenium object.  Use <code>window</code> to\n   * refer to the window of your application, e.g. <code>window.document.getElementById('foo')</code></p>\n   *\n   * <p>If you need to use\n   * a locator to refer to a single element in your application page, you can\n   * use <code>this.browserbot.findElement(\"id=foo\")</code> where \"id=foo\" is your locator.</p>\n   *\n   * @param script the JavaScript snippet to run\n   * @return string the results of evaluating the snippet\n   */\n  try {\n    //LOG.info('script is: ' + script);\n    let result = this.eval(script)\n    // Selenium RC doesn't allow returning null\n    if (null == result) return 'null'\n    return result\n  } catch (e) {\n    throw new SeleniumError('Threw an exception: ' + extractExceptionMessage(e))\n  }\n}\n\nSelenium.prototype.isChecked = function(locator) {\n  /**\n   * Gets whether a toggle-button (checkbox/radio) is checked.  Fails if the specified element doesn't exist or isn't a toggle-button.\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to a checkbox or radio button\n   * @return boolean true if the checkbox is checked, false otherwise\n   */\n  let element = this.browserbot.findElement(locator)\n  if (element.checked == null) {\n    throw new SeleniumError('Element ' + locator + ' is not a toggle-button.')\n  }\n  return element.checked\n}\n\nSelenium.prototype.getTable = function(tableCellAddress) {\n  /**\n   * Gets the text from a cell of a table. The cellAddress syntax\n   * tableLocator.row.column, where row and column start at 0.\n   *\n   * @param tableCellAddress a cell address, e.g. \"foo.1.4\"\n   * @return string the text from the specified cell\n   */\n  // This regular expression matches \"tableName.row.column\"\n  // For example, \"mytable.3.4\"\n  let pattern = /(.*)\\.(\\d+)\\.(\\d+)/\n\n  if (!pattern.test(tableCellAddress)) {\n    throw new SeleniumError(\n      'Invalid target format. Correct format is tableName.rowNum.columnNum'\n    )\n  }\n\n  let pieces = tableCellAddress.match(pattern)\n\n  let tableName = pieces[1]\n  let row = pieces[2]\n  let col = pieces[3]\n\n  let table = this.browserbot.findElement(tableName)\n  if (row > table.rows.length) {\n    // eslint-disable-next-line no-undef\n    Assert.fail(\n      'Cannot access row ' + row + ' - table has ' + table.rows.length + ' rows'\n    )\n  } else if (col > table.rows[row].cells.length) {\n    // eslint-disable-next-line no-undef\n    Assert.fail(\n      'Cannot access column ' +\n        col +\n        ' - table row has ' +\n        table.rows[row].cells.length +\n        ' columns'\n    )\n  } else {\n    let actualContent = bot.dom.getVisibleText(table.rows[row].cells[col])\n    return actualContent.trim()\n  }\n  return null\n}\n\nSelenium.prototype.getSelectedLabels = function(selectLocator) {\n  /** Gets all option labels (visible text) for selected options in the specified select or multi-select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string[] an array of all selected option labels in the specified select drop-down\n   */\n  return this.findSelectedOptionProperties(selectLocator, 'text')\n}\n\nSelenium.prototype.getSelectedLabel = function(selectLocator) {\n  /** Gets option label (visible text) for selected option in the specified select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string the selected option label in the specified select drop-down\n   */\n  return this.findSelectedOptionProperty(selectLocator, 'text')\n}\n\nSelenium.prototype.getSelectedValues = function(selectLocator) {\n  /** Gets all option values (value attributes) for selected options in the specified select or multi-select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string[] an array of all selected option values in the specified select drop-down\n   */\n  return this.findSelectedOptionProperties(selectLocator, 'value')\n}\n\nSelenium.prototype.getSelectedValue = function(selectLocator) {\n  /** Gets option value (value attribute) for selected option in the specified select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string the selected option value in the specified select drop-down\n   */\n  return this.findSelectedOptionProperty(selectLocator, 'value')\n}\n\nSelenium.prototype.getSelectedIndexes = function(selectLocator) {\n  /** Gets all option indexes (option number, starting at 0) for selected options in the specified select or multi-select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string[] an array of all selected option indexes in the specified select drop-down\n   */\n  return this.findSelectedOptionProperties(selectLocator, 'index')\n}\n\nSelenium.prototype.getSelectedIndex = function(selectLocator) {\n  /** Gets option index (option number, starting at 0) for selected option in the specified select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string the selected option index in the specified select drop-down\n   */\n  return this.findSelectedOptionProperty(selectLocator, 'index')\n}\n\nSelenium.prototype.getSelectedIds = function(selectLocator) {\n  /** Gets all option element IDs for selected options in the specified select or multi-select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string[] an array of all selected option IDs in the specified select drop-down\n   */\n  return this.findSelectedOptionProperties(selectLocator, 'id')\n}\n\nSelenium.prototype.getSelectedId = function(selectLocator) {\n  /** Gets option element ID for selected option in the specified select element.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string the selected option ID in the specified select drop-down\n   */\n  return this.findSelectedOptionProperty(selectLocator, 'id')\n}\n\nSelenium.prototype.isSomethingSelected = function(selectLocator) {\n  /** Determines whether some option in a drop-down menu is selected.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return boolean true if some option has been selected, false otherwise\n   */\n  let element = this.browserbot.findElement(selectLocator)\n  if (!('options' in element)) {\n    throw new SeleniumError(\n      'Specified element is not a Select (has no options)'\n    )\n  }\n\n  for (let i = 0; i < element.options.length; i++) {\n    if (element.options[i].selected) {\n      return true\n    }\n  }\n  return false\n}\n\nSelenium.prototype.findSelectedOptionProperties = function(locator, property) {\n  let element = this.browserbot.findElement(locator)\n  if (!('options' in element)) {\n    throw new SeleniumError(\n      'Specified element is not a Select (has no options)'\n    )\n  }\n\n  let selectedOptions = []\n\n  for (let i = 0; i < element.options.length; i++) {\n    if (element.options[i].selected) {\n      let propVal = element.options[i][property]\n      selectedOptions.push(propVal)\n    }\n  }\n  if (selectedOptions.length == 0) Assert.fail('No option selected') // eslint-disable-line no-undef\n  return selectedOptions\n}\n\nSelenium.prototype.findSelectedOptionProperty = function(locator, property) {\n  let selectedOptions = this.findSelectedOptionProperties(locator, property)\n  if (selectedOptions.length > 1) {\n    Assert.fail('More than one selected option!') // eslint-disable-line no-undef\n  }\n  return selectedOptions[0]\n}\n\nSelenium.prototype.getSelectOptions = function(selectLocator) {\n  /** Gets all option labels in the specified select drop-down.\n   *\n   * @param selectLocator an <a href=\"#locators\">element locator</a> identifying a drop-down menu\n   * @return string[] an array of all option labels in the specified select drop-down\n   */\n  let element = this.browserbot.findElement(selectLocator)\n\n  let selectOptions = []\n\n  for (let i = 0; i < element.options.length; i++) {\n    let option = element.options[i].text\n    selectOptions.push(option)\n  }\n\n  return selectOptions\n}\n\nSelenium.prototype.getAttribute = function(attributeLocator) {\n  /**\n   * Gets the value of an element attribute. The value of the attribute may\n   * differ across browsers (this is the case for the \"style\" attribute, for\n   * example).\n   *\n   * @param attributeLocator an element locator followed by an &#064; sign and then the name of the attribute, e.g. \"foo&#064;bar\"\n   * @return string the value of the specified attribute\n   */\n  let result = this.browserbot.findAttribute(attributeLocator)\n  if (result == null) {\n    throw new SeleniumError(\n      'Could not find element attribute: ' + attributeLocator\n    )\n  }\n  return result\n}\n\nSelenium.prototype.isTextPresent = function(pattern) {\n  /**\n   * Verifies that the specified text pattern appears somewhere on the rendered page shown to the user.\n   * @param pattern a <a href=\"#patterns\">pattern</a> to match with the text of the page\n   * @return boolean true if the pattern matches the text, false otherwise\n   */\n  let allText = this.browserbot.bodyText()\n\n  let patternMatcher = new PatternMatcher(pattern)\n  if (patternMatcher.strategy == PatternMatcher.strategies.glob) {\n    if (pattern.indexOf('glob:') == 0) {\n      pattern = pattern.substring('glob:'.length) // strip off \"glob:\"\n    }\n    patternMatcher.matcher = new PatternMatcher.strategies.globContains(pattern)\n  } else if (patternMatcher.strategy == PatternMatcher.strategies.exact) {\n    pattern = pattern.substring('exact:'.length) // strip off \"exact:\"\n    return allText.indexOf(pattern) != -1\n  }\n  return patternMatcher.matches(allText)\n}\n\nfunction isElementNotPresent(locator) {\n  return !this.isElementPresent(locator)\n}\n\nSelenium.prototype.isElementPresent = function(locator) {\n  /**\n   * Verifies that the specified element is somewhere on the page.\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @return boolean true if the element is present, false otherwise\n   */\n  let element = this.browserbot.findElementOrNull(locator)\n  if (element == null) {\n    return false\n  }\n  return true\n}\n\nfunction unableToLocateTargetElementError() {\n  throw new Error('Unable to locate target element.')\n}\n\nfunction isNotDisplayed(locator) {\n  try {\n    return !this.isVisible(locator)\n  } catch (error) {\n    unableToLocateTargetElementError()\n  }\n}\n\nfunction isDisplayed(locator) {\n  try {\n    return this.isVisible(locator)\n  } catch (error) {\n    return false\n  }\n}\n\nSelenium.prototype.isVisible = function(locator) {\n  /**\n   * Determines if the specified element is visible. An\n   * element can be rendered invisible by setting the CSS \"visibility\"\n   * property to \"hidden\", or the \"display\" property to \"none\", either for the\n   * element itself or one if its ancestors.  This method will fail if\n   * the element is not present.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @return boolean true if the specified element is visible, false otherwise\n   */\n  let element\n  element = this.browserbot.findElement(locator)\n  // DGF if it's an input tag of type \"hidden\" then it's not visible\n  if (element.tagName) {\n    let tagName = new String(element.tagName).toLowerCase()\n    if (tagName == 'input') {\n      if (element.type) {\n        let elementType = new String(element.type).toLowerCase()\n        if (elementType == 'hidden') {\n          return false\n        }\n      }\n    }\n  }\n  let visibility = this.findEffectiveStyleProperty(element, 'visibility')\n  let _isDisplayed = this._isDisplayed(element)\n  return visibility != 'hidden' && _isDisplayed\n}\n\nSelenium.prototype.findEffectiveStyleProperty = function(element, property) {\n  let effectiveStyle = this.findEffectiveStyle(element)\n  let propertyValue = effectiveStyle[property]\n  if (propertyValue == 'inherit' && element.parentNode.style) {\n    return this.findEffectiveStyleProperty(element.parentNode, property)\n  }\n  return propertyValue\n}\n\nSelenium.prototype._isDisplayed = function(element) {\n  let display = this.findEffectiveStyleProperty(element, 'display')\n  if (display == 'none') return false\n  if (element.parentNode.style) {\n    return this._isDisplayed(element.parentNode)\n  }\n  return true\n}\n\nSelenium.prototype.findEffectiveStyle = function(element) {\n  if (element.style == undefined) {\n    return undefined // not a styled element\n  }\n  let window = this.browserbot.getCurrentWindow()\n  if (window.getComputedStyle) {\n    // DOM-Level-2-CSS\n    return window.getComputedStyle(element, null)\n  }\n  if (element.currentStyle) {\n    // non-standard IE alternative\n    return element.currentStyle\n    // TODO: this won't really work in a general sense, as\n    //   currentStyle is not identical to getComputedStyle()\n    //   ... but it's good enough for \"visibility\"\n  }\n\n  if (\n    window.document.defaultView &&\n    window.document.defaultView.getComputedStyle\n  ) {\n    return window.document.defaultView.getComputedStyle(element, null)\n  }\n\n  throw new SeleniumError(\n    'cannot determine effective stylesheet in this browser'\n  )\n}\n\nfunction isEditable(locator) {\n  try {\n    return this.isEditable(locator)\n  } catch (error) {\n    unableToLocateTargetElementError()\n  }\n}\n\nfunction isNotEditable(locator) {\n  try {\n    return !this.isEditable(locator)\n  } catch (error) {\n    unableToLocateTargetElementError()\n  }\n}\n\nSelenium.prototype.isEditable = function(locator) {\n  /**\n   * Determines whether the specified input element is editable, ie hasn't been disabled.\n   * This method will fail if the specified element isn't an input element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a>\n   * @return boolean true if the input element is editable, false otherwise\n   */\n  let element = this.browserbot.findElement(locator)\n  if (element.value == undefined) {\n    Assert.fail('Element ' + locator + ' is not an input.') // eslint-disable-line no-undef\n  }\n  if (element.disabled) {\n    return false\n  }\n  // DGF \"readonly\" is a bit goofy... it doesn't necessarily have a value\n  // You can write <input readonly value=\"black\">\n  let readOnlyNode = element.getAttributeNode('readonly')\n  if (readOnlyNode) {\n    // DGF on IE, every input element has a readOnly node, but it may be false\n    if (typeof readOnlyNode.nodeValue == 'boolean') {\n      let readOnly = readOnlyNode.nodeValue\n      if (readOnly) {\n        return false\n      }\n    } else {\n      return false\n    }\n  }\n  return true\n}\n\nSelenium.prototype.getAllButtons = function() {\n  /** Returns the IDs of all buttons on the page.\n   *\n   * <p>If a given button has no ID, it will appear as \"\" in this array.</p>\n   *\n   * @return string[] the IDs of all buttons on the page\n   */\n  return this.browserbot.getAllButtons()\n}\n\nSelenium.prototype.getAllLinks = function() {\n  /** Returns the IDs of all links on the page.\n   *\n   * <p>If a given link has no ID, it will appear as \"\" in this array.</p>\n   *\n   * @return string[] the IDs of all links on the page\n   */\n  return this.browserbot.getAllLinks()\n}\n\nSelenium.prototype.getAllFields = function() {\n  /** Returns the IDs of all input fields on the page.\n   *\n   * <p>If a given field has no ID, it will appear as \"\" in this array.</p>\n   *\n   * @return string[] the IDs of all field on the page\n   */\n  return this.browserbot.getAllFields()\n}\n\nSelenium.prototype.doSetMouseSpeed = function(pixels) {\n  /** Configure the number of pixels between \"mousemove\" events during dragAndDrop commands (default=10).\n   * <p>Setting this value to 0 means that we'll send a \"mousemove\" event to every single pixel\n   * in between the start location and the end location; that can be very slow, and may\n   * cause some browsers to force the JavaScript to timeout.</p>\n   *\n   * <p>If the mouse speed is greater than the distance between the two dragged objects, we'll\n   * just send one \"mousemove\" at the start location and then one final one at the end location.</p>\n   * @param pixels the number of pixels between \"mousemove\" events\n   */\n  let intValue = new Number(pixels)\n  if (intValue.constructor != Number || intValue < 0) {\n    this.mouseSpeed = Selenium.DEFAULT_MOUSE_SPEED\n  } else {\n    this.mouseSpeed = pixels\n  }\n}\n\nSelenium.prototype.getMouseSpeed = function() {\n  /** Returns the number of pixels between \"mousemove\" events during dragAndDrop commands (default=10).\n   *\n   * @return number the number of pixels between \"mousemove\" events during dragAndDrop commands (default=10)\n   */\n  return this.mouseSpeed\n}\n\nSelenium.prototype.doDragAndDrop = function(locator, movementsString) {\n  /** Drags an element a certain distance and then drops it\n   * @param locator an element locator\n   * @param movementsString offset in pixels from the current location to which the element should be moved, e.g., \"+70,-300\"\n   */\n  let element = this.browserbot.findElement(locator)\n  let clientStartXY = getClientXY(element)\n  let clientStartX = clientStartXY[0]\n  let clientStartY = clientStartXY[1]\n\n  let movements = movementsString.split(/,/)\n  let movementX = Number(movements[0])\n  let movementY = Number(movements[1])\n\n  let clientFinishX =\n    clientStartX + movementX < 0 ? 0 : clientStartX + movementX\n  let clientFinishY =\n    clientStartY + movementY < 0 ? 0 : clientStartY + movementY\n\n  let mouseSpeed = this.mouseSpeed\n  let move = function(current, dest) {\n    if (current == dest) return current\n    if (Math.abs(current - dest) < mouseSpeed) return dest\n    return current < dest ? current + mouseSpeed : current - mouseSpeed\n  }\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousedown',\n    true,\n    clientStartX,\n    clientStartY\n  )\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousemove',\n    true,\n    clientStartX,\n    clientStartY\n  )\n  let clientX = clientStartX\n  let clientY = clientStartY\n\n  while (clientX != clientFinishX || clientY != clientFinishY) {\n    clientX = move(clientX, clientFinishX)\n    clientY = move(clientY, clientFinishY)\n    this.browserbot.triggerMouseEvent(\n      element,\n      'mousemove',\n      true,\n      clientX,\n      clientY\n    )\n  }\n\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mousemove',\n    true,\n    clientFinishX,\n    clientFinishY\n  )\n  this.browserbot.triggerMouseEvent(\n    element,\n    'mouseup',\n    true,\n    clientFinishX,\n    clientFinishY\n  )\n}\n\nSelenium.prototype.doDragAndDropToObject = function(\n  locatorOfObjectToBeDragged,\n  locatorOfDragDestinationObject\n) {\n  /** Drags an element and drops it on another element\n   *\n   * @param locatorOfObjectToBeDragged an element to be dragged\n   * @param locatorOfDragDestinationObject an element whose location (i.e., whose center-most pixel) will be the point where locatorOfObjectToBeDragged  is dropped\n   */\n  if (!this.browserbot.findElement(locatorOfObjectToBeDragged).draggable) {\n    //origin code\n    let startX = this.getElementPositionLeft(locatorOfObjectToBeDragged)\n    let startY = this.getElementPositionTop(locatorOfObjectToBeDragged)\n\n    let destinationLeftX = this.getElementPositionLeft(\n      locatorOfDragDestinationObject\n    )\n    let destinationTopY = this.getElementPositionTop(\n      locatorOfDragDestinationObject\n    )\n    let destinationWidth = this.getElementWidth(locatorOfDragDestinationObject)\n    let destinationHeight = this.getElementHeight(\n      locatorOfDragDestinationObject\n    )\n\n    let endX = Math.round(destinationLeftX + destinationWidth / 2)\n    let endY = Math.round(destinationTopY + destinationHeight / 2)\n\n    let deltaX = endX - startX\n    let deltaY = endY - startY\n\n    let movementsString = '' + deltaX + ',' + deltaY\n    this.doDragAndDrop(locatorOfObjectToBeDragged, movementsString)\n  } else {\n    //DragAndDropExt, Shuo-Heng Shih, SELAB, CSIE, NCKU, 2016/09/29\n    let element = this.browserbot.findElement(locatorOfObjectToBeDragged)\n    let target = this.browserbot.findElement(locatorOfDragDestinationObject)\n    this.browserbot.triggerDragEvent(element, target)\n  }\n}\n\nSelenium.prototype.doWindowFocus = function() {\n  /** Gives focus to the currently selected window\n   *\n   */\n  this.browserbot.getCurrentWindow().focus()\n}\n\nSelenium.prototype.doWindowMaximize = function() {\n  /** Resize currently selected window to take up the entire screen\n   *\n   */\n  let window = this.browserbot.getCurrentWindow()\n  if (window != null && window.screen) {\n    window.moveTo(0, 0)\n\n    // It appears Firefox on Mac won't move a window to (0,0).  But, you can move it to (0,1), which\n    // seems to do basically the same thing.  In my (KJM - 6/20/10) tests, anything less than (0, 22)\n    // pushed the browser to (0,0), so it seems it's improperly accounting for something in the browser chrome.\n    if (window.screenX != 0) {\n      window.moveTo(0, 1)\n    }\n\n    window.resizeTo(screen.availWidth, screen.availHeight)\n  }\n}\n\nSelenium.prototype.getHtmlSource = function() {\n  /** Returns the entire HTML source between the opening and\n   * closing \"html\" tags.\n   *\n   * @return string the entire HTML source\n   */\n  return this.browserbot.getDocument().getElementsByTagName('html')[0].innerHTML\n}\n\nSelenium.prototype.doSetCursorPosition = function(locator, position) {\n  /**\n   * Moves the text cursor to the specified position in the given input element or textarea.\n   * This method will fail if the specified element isn't an input element or textarea.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an input element or textarea\n   * @param position the numerical position of the cursor in the field; position should be 0 to move the position to the beginning of the field.  You can also set the cursor to -1 to move it to the end of the field.\n   */\n  let element = this.browserbot.findElement(locator)\n  if (element.value == undefined) {\n    Assert.fail('Element ' + locator + ' is not an input.') // eslint-disable-line no-undef\n  }\n  if (position == -1) {\n    position = element.value.length\n  }\n\n  if (element.setSelectionRange && !browserVersion.isOpera) {\n    element.focus()\n    element.setSelectionRange(/*start*/ position, /*end*/ position)\n  } else if (element.createTextRange) {\n    bot.events.fire(element, bot.events.EventType.FOCUS)\n    let range = element.createTextRange()\n    range.collapse(true)\n    range.moveEnd('character', position)\n    range.moveStart('character', position)\n    range.select()\n  }\n}\n\nSelenium.prototype.getElementIndex = function(locator) {\n  /**\n   * Get the relative index of an element to its parent (starting from 0). The comment node and empty text node\n   * will be ignored.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an element\n   * @return number of relative index of the element to its parent (starting from 0)\n   */\n  let element = this.browserbot.findElement(locator)\n  let previousSibling\n  let index = 0\n  while ((previousSibling = element.previousSibling) != null) {\n    if (!this._isCommentOrEmptyTextNode(previousSibling)) {\n      index++\n    }\n    element = previousSibling\n  }\n  return index\n}\n\nSelenium.prototype.isOrdered = function(locator1, locator2) {\n  /**\n   * Check if these two elements have same parent and are ordered siblings in the DOM. Two same elements will\n   * not be considered ordered.\n   *\n   * @param locator1 an <a href=\"#locators\">element locator</a> pointing to the first element\n   * @param locator2 an <a href=\"#locators\">element locator</a> pointing to the second element\n   * @return boolean true if element1 is the previous sibling of element2, false otherwise\n   */\n  let element1 = this.browserbot.findElement(locator1)\n  let element2 = this.browserbot.findElement(locator2)\n  if (element1 === element2) return false\n\n  let previousSibling\n  while ((previousSibling = element2.previousSibling) != null) {\n    if (previousSibling === element1) {\n      return true\n    }\n    element2 = previousSibling\n  }\n  return false\n}\n\nSelenium.prototype._isCommentOrEmptyTextNode = function(node) {\n  return (\n    node.nodeType == 8 || (node.nodeType == 3 && !/[^\\t\\n\\r ]/.test(node.data))\n  )\n}\n\nSelenium.prototype.getElementPositionLeft = function(locator) {\n  /**\n   * Retrieves the horizontal position of an element\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an element OR an element itself\n   * @return number of pixels from the edge of the frame.\n   */\n  let element\n  if ('string' == typeof locator) {\n    element = this.browserbot.findElement(locator)\n  } else {\n    element = locator\n  }\n  let x = element.offsetLeft\n  let elementParent = element.offsetParent\n\n  while (elementParent != null) {\n    if (document.all) {\n      if (elementParent.tagName != 'TABLE' && elementParent.tagName != 'BODY') {\n        x += elementParent.clientLeft\n      }\n    } // Netscape/DOM\n    else {\n      if (elementParent.tagName == 'TABLE') {\n        let parentBorder = parseInt(elementParent.border)\n        if (isNaN(parentBorder)) {\n          let parentFrame = elementParent.getAttribute('frame')\n          if (parentFrame != null) {\n            x += 1\n          }\n        } else if (parentBorder > 0) {\n          x += parentBorder\n        }\n      }\n    }\n    x += elementParent.offsetLeft\n    elementParent = elementParent.offsetParent\n  }\n  return x\n}\n\nSelenium.prototype.getElementPositionTop = function(locator) {\n  /**\n   * Retrieves the vertical position of an element\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an element OR an element itself\n   * @return number of pixels from the edge of the frame.\n   */\n  let element\n  if ('string' == typeof locator) {\n    element = this.browserbot.findElement(locator)\n  } else {\n    element = locator\n  }\n\n  let y = 0\n\n  while (element != null) {\n    if (document.all) {\n      if (element.tagName != 'TABLE' && element.tagName != 'BODY') {\n        y += element.clientTop\n      }\n    } // Netscape/DOM\n    else {\n      if (element.tagName == 'TABLE') {\n        let parentBorder = parseInt(element.border)\n        if (isNaN(parentBorder)) {\n          let parentFrame = element.getAttribute('frame')\n          if (parentFrame != null) {\n            y += 1\n          }\n        } else if (parentBorder > 0) {\n          y += parentBorder\n        }\n      }\n    }\n    y += element.offsetTop\n\n    // Netscape can get confused in some cases, such that the height of the parent is smaller\n    // than that of the element (which it shouldn't really be). If this is the case, we need to\n    // exclude this element, since it will result in too large a 'top' return value.\n    if (\n      element.offsetParent &&\n      element.offsetParent.offsetHeight &&\n      element.offsetParent.offsetHeight < element.offsetHeight\n    ) {\n      // skip the parent that's too small\n      element = element.offsetParent.offsetParent\n    } else {\n      // Next up...\n      element = element.offsetParent\n    }\n  }\n  return y\n}\n\nSelenium.prototype.getElementWidth = function(locator) {\n  /**\n   * Retrieves the width of an element\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an element\n   * @return number width of an element in pixels\n   */\n  let element = this.browserbot.findElement(locator)\n  return element.offsetWidth\n}\n\nSelenium.prototype.getElementHeight = function(locator) {\n  /**\n   * Retrieves the height of an element\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an element\n   * @return number height of an element in pixels\n   */\n  let element = this.browserbot.findElement(locator)\n  return element.offsetHeight\n}\n\nSelenium.prototype.getCursorPosition = function(locator) {\n  /**\n   * Retrieves the text cursor position in the given input element or textarea; beware, this may not work perfectly on all browsers.\n   *\n   * <p>Specifically, if the cursor/selection has been cleared by JavaScript, this command will tend to\n   * return the position of the last location of the cursor, even though the cursor is now gone from the page.  This is filed as <a href=\"http://jira.openqa.org/browse/SEL-243\">SEL-243</a>.</p>\n   * This method will fail if the specified element isn't an input element or textarea, or there is no cursor in the element.\n   *\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an input element or textarea\n   * @return number the numerical position of the cursor in the field\n   */\n  let element = this.browserbot.findElement(locator)\n  let doc = this.browserbot.getDocument()\n  let win = this.browserbot.getCurrentWindow()\n  let elementRange\n  if (doc.selection && !browserVersion.isOpera) {\n    try {\n      let selectRange = doc.selection.createRange().duplicate()\n      elementRange = element.createTextRange()\n      selectRange.move('character', 0)\n      elementRange.move('character', 0)\n      elementRange.setEndPoint('EndToEnd', selectRange)\n    } catch (e) {\n      Assert.fail('There is no cursor on this page!') // eslint-disable-line no-undef\n    }\n    let answer = String(elementRange.text).replace(/\\r/g, '').length\n    return answer\n  } else {\n    if (typeof element.selectionStart != 'undefined') {\n      if (\n        win.getSelection &&\n        typeof win.getSelection().rangeCount != undefined &&\n        win.getSelection().rangeCount == 0\n      ) {\n        Assert.fail('There is no cursor on this page!') // eslint-disable-line no-undef\n      }\n      return element.selectionStart\n    }\n  }\n  throw new Error(\"Couldn't detect cursor position on this browser!\")\n}\n\nSelenium.prototype.getExpression = function(expression) {\n  /**\n   * Returns the specified expression.\n   *\n   * <p>This is useful because of JavaScript preprocessing.\n   * It is used to generate commands like assertExpression and waitForExpression.</p>\n   *\n   * @param expression the value to return\n   * @return string the value passed in\n   */\n  return expression\n}\n\nSelenium.prototype.getXpathCount = function(xpath) {\n  /**\n   * Returns the number of nodes that match the specified xpath, eg. \"//table\" would give\n   * the number of tables.\n   *\n   * @param xpath the xpath expression to evaluate. do NOT wrap this expression in a 'count()' function; we will do that for you.\n   * @return number the number of nodes that match the specified xpath\n   */\n  let result = this.browserbot.evaluateXPathCount(\n    xpath,\n    this.browserbot.getDocument()\n  )\n  return result\n}\n\nSelenium.prototype.getCssCount = function(css) {\n  /**\n   * Returns the number of nodes that match the specified css selector, eg. \"css=table\" would give\n   * the number of tables.\n   *\n   * @param css the css selector to evaluate. do NOT wrap this expression in a 'count()' function; we will do that for you.\n   * @return the number of nodes that match the specified selector\n   */\n  let result = this.browserbot.evaluateCssCount(\n    css,\n    this.browserbot.getDocument()\n  )\n  return result\n}\n\nSelenium.prototype.doAssignId = function(locator, identifier) {\n  /**\n   * Temporarily sets the \"id\" attribute of the specified element, so you can locate it in the future\n   * using its ID rather than a slow/complicated XPath.  This ID will disappear once the page is\n   * reloaded.\n   * @param locator an <a href=\"#locators\">element locator</a> pointing to an element\n   * @param identifier a string to be used as the ID of the specified element\n   */\n  let element = this.browserbot.findElement(locator)\n  element.id = identifier\n}\n\nSelenium.prototype.doAllowNativeXpath = function(allow) {\n  /**\n   * Specifies whether Selenium should use the native in-browser implementation\n   * of XPath (if any native version is available); if you pass \"false\" to\n   * this function, we will always use our pure-JavaScript xpath library.\n   * Using the pure-JS xpath library can improve the consistency of xpath\n   * element locators between different browser vendors, but the pure-JS\n   * version is much slower than the native implementations.\n   * @param allow boolean, true means we'll prefer to use native XPath; false means we'll only use JS XPath\n   */\n  if ('false' == allow || '0' == allow) {\n    // The strings \"false\" and \"0\" are true values in JS\n    allow = false\n  }\n  this.browserbot.setAllowNativeXPath(allow)\n}\n\nSelenium.prototype.doIgnoreAttributesWithoutValue = function(ignore) {\n  /**\n   * Specifies whether Selenium will ignore xpath attributes that have no\n   * value, i.e. are the empty string, when using the non-native xpath\n   * evaluation engine. You'd want to do this for performance reasons in IE.\n   * However, this could break certain xpaths, for example an xpath that looks\n   * for an attribute whose value is NOT the empty string.\n   *\n   * The hope is that such xpaths are relatively rare, but the user should\n   * have the option of using them. Note that this only influences xpath\n   * evaluation when using the ajaxslt engine (i.e. not \"javascript-xpath\").\n   *\n   * @param ignore boolean, true means we'll ignore attributes without value\n   *                        at the expense of xpath \"correctness\"; false means\n   *                        we'll sacrifice speed for correctness.\n   */\n  if ('false' == ignore || '0' == ignore) {\n    ignore = false\n  }\n  this.browserbot.setIgnoreAttributesWithoutValue(ignore)\n}\n\nSelenium.prototype.doWaitForCondition = function(script, timeout) {\n  /**\n   * Runs the specified JavaScript snippet repeatedly until it evaluates to \"true\".\n   * The snippet may have multiple lines, but only the result of the last line\n   * will be considered.\n   *\n   * <p>Note that, by default, the snippet will be run in the runner's test window, not in the window\n   * of your application.  To get the window of your application, you can use\n   * the JavaScript snippet <code>selenium.browserbot.getCurrentWindow()</code>, and then\n   * run your JavaScript in there</p>\n   * @param script the JavaScript snippet to run\n   * @param timeout a timeout in milliseconds, after which this command will return with an error\n   */\n\n  return Selenium.decorateFunctionWithTimeout(function() {\n    return this.eval(script)\n  }, timeout)\n}\n\nSelenium.prototype.doWaitForCondition.dontCheckAlertsAndConfirms = true\n\nSelenium.prototype.doSetTimeout = function(timeout) {\n  /**\n   * Specifies the amount of time that Selenium will wait for actions to complete.\n   *\n   * <p>Actions that require waiting include \"open\" and the \"waitFor*\" actions.</p>\n   * The default timeout is 30 seconds.\n   * @param timeout a timeout in milliseconds, after which the action will return with an error\n   */\n  if (!timeout) {\n    timeout = Selenium.DEFAULT_TIMEOUT\n  }\n  this.defaultTimeout = timeout\n}\n\nSelenium.prototype.doWaitForPageToLoad = function(timeout) {\n  /**\n   * Waits for a new page to load.\n   *\n   * <p>You can use this command instead of the \"AndWait\" suffixes, \"clickAndWait\", \"selectAndWait\", \"typeAndWait\" etc.\n   * (which are only available in the JS API).</p>\n   *\n   * <p>Selenium constantly keeps track of new pages loading, and sets a \"newPageLoaded\"\n   * flag when it first notices a page load.  Running any other Selenium command after\n   * turns the flag to false.  Hence, if you want to wait for a page to load, you must\n   * wait immediately after a Selenium command that caused a page-load.</p>\n   * @param timeout a timeout in milliseconds, after which this command will return with an error\n   */\n  // in pi-mode, the test and the harness share the window; thus if we are executing this code, then we have loaded\n  if (window['proxyInjectionMode'] == null || !window['proxyInjectionMode']) {\n    return this.makePageLoadCondition(timeout)\n  }\n}\n\nSelenium.prototype.doWaitForFrameToLoad = function(_frameAddress, timeout) {\n  /**\n   * Waits for a new frame to load.\n   *\n   * <p>Selenium constantly keeps track of new pages and frames loading,\n   * and sets a \"newPageLoaded\" flag when it first notices a page load.</p>\n   *\n   * See waitForPageToLoad for more information.\n   *\n   * @param frameAddress FrameAddress from the server side\n   * @param timeout a timeout in milliseconds, after which this command will return with an error\n   */\n  // in pi-mode, the test and the harness share the window; thus if we are executing this code, then we have loaded\n  if (window['proxyInjectionMode'] == null || !window['proxyInjectionMode']) {\n    return this.makePageLoadCondition(timeout)\n  }\n}\n\nSelenium.prototype._isNewPageLoaded = function() {\n  return this.browserbot.isNewPageLoaded()\n}\n\nSelenium.prototype._abortXhrRequest = function() {\n  return this.browserbot.abortXhrRequest()\n}\n\nSelenium.prototype.doWaitForPageToLoad.dontCheckAlertsAndConfirms = true\n\n/**\n * Evaluate a parameter, performing JavaScript evaluation and variable substitution.\n * If the string matches the pattern \"javascript{ ... }\", evaluate the string between the braces.\n */\nSelenium.prototype.preprocessParameter = function(value) {\n  if (!value.script) {\n    // only for non-scripts\n    let match = value.match(/^javascript\\{((.|\\r?\\n)+)\\}$/)\n    if (match && match[1]) {\n      browser.runtime.sendMessage({\n        log: {\n          type: 'warn',\n          message:\n            'parameter preprocessing using javascript{} tag is deprecated, please use execute script',\n        },\n      })\n      let result = this.eval(match[1])\n      return result == null ? null : result.toString()\n    }\n  }\n  return value\n}\n\nSelenium.prototype.replaceKeys = function(str) {\n  let keys = []\n  let match = str.match(/\\$\\{\\w+\\}/g)\n  if (!match) {\n    keys.push(str)\n  } else {\n    let i = 0\n    while (i < str.length) {\n      let currentKey = match.shift(),\n        currentKeyIndex = str.indexOf(currentKey, i)\n      if (currentKeyIndex > i) {\n        // push the string before the current key\n        keys.push(str.substr(i, currentKeyIndex - i))\n        i = currentKeyIndex\n      }\n      if (currentKey) {\n        if (/^\\$\\{KEY_\\w+\\}/.test(currentKey)) {\n          // is a key\n          let keyName = currentKey.match(/\\$\\{KEY_(\\w+)\\}/)[1]\n          let key = bot.Keyboard.Keys[keyName]\n          if (key) {\n            keys.push(key)\n          } else {\n            throw new Error(`Unrecognised key ${keyName}`)\n          }\n        } else {\n          // not a key, and not a stored variable, push it as-is\n          keys.push(currentKey)\n        }\n        i += currentKey.length\n      } else if (i < str.length) {\n        // push the rest of the string\n        keys.push(str.substr(i, str.length))\n        i = str.length\n      }\n    }\n  }\n  return keys\n}\n\nSelenium.prototype.getCookie = function() {\n  /**\n   * Return all cookies of the current page under test.\n   *\n   * @return string all cookies of the current page under test\n   */\n  let doc = this.browserbot.getDocument()\n  return doc.cookie\n}\n\nSelenium.prototype.getCookieByName = function(name) {\n  /**\n   * Returns the value of the cookie with the specified name, or throws an error if the cookie is not present.\n   * @param name the name of the cookie\n   * @return string the value of the cookie\n   */\n  let v = this.browserbot.getCookieByName(name)\n  if (v === null) {\n    throw new SeleniumError(\"Cookie '\" + name + \"' was not found\")\n  }\n  return v\n}\n\nSelenium.prototype.isCookiePresent = function(name) {\n  /**\n   * Returns true if a cookie with the specified name is present, or false otherwise.\n   * @param name the name of the cookie\n   * @return boolean true if a cookie with the specified name is present, or false otherwise.\n   */\n  let v = this.browserbot.getCookieByName(name)\n  let absent = v === null\n  return !absent\n}\n\nSelenium.prototype.doCreateCookie = function(nameValuePair, optionsString) {\n  /**\n   * Create a new cookie whose path and domain are same with those of current page\n   * under test, unless you specified a path for this cookie explicitly.\n   *\n   * @param nameValuePair name and value of the cookie in a format \"name=value\"\n   * @param optionsString options for the cookie. Currently supported options include 'path', 'max_age' and 'domain'.\n   *      the optionsString's format is \"path=/path/, max_age=60, domain=.foo.com\". The order of options are irrelevant, the unit\n   *      of the value of 'max_age' is second.  Note that specifying a domain that isn't a subset of the current domain will\n   *      usually fail.\n   */\n  // eslint-disable-next-line no-useless-escape\n  let results = /[^\\s=\\[\\]\\(\\),\"\\/\\?@:;]+=[^\\s=\\[\\]\\(\\),\"\\/\\?@:;]*/.test(\n    nameValuePair\n  )\n  if (!results) {\n    throw new SeleniumError('Invalid parameter.')\n  }\n  let cookie = nameValuePair.trim()\n  results = /max_age=(\\d+)/.exec(optionsString)\n  if (results) {\n    let expireDateInMilliseconds = new Date().getTime() + results[1] * 1000\n    cookie += '; expires=' + new Date(expireDateInMilliseconds).toGMTString()\n  }\n  results = /path=([^\\s,]+)[,]?/.exec(optionsString)\n  if (results) {\n    let path = results[1]\n    if (browserVersion.khtml) {\n      // Safari and conquerer don't like paths with / at the end\n      if ('/' != path) {\n        path = path.replace(/\\/$/, '')\n      }\n    }\n    cookie += '; path=' + path\n  }\n  results = /domain=([^\\s,]+)[,]?/.exec(optionsString)\n  if (results) {\n    let domain = results[1]\n    cookie += '; domain=' + domain\n  }\n  //LOG.debug(\"Setting cookie to: \" + cookie);\n  this.browserbot.getDocument().cookie = cookie\n}\n\nSelenium.prototype.doDeleteCookie = function(name, optionsString) {\n  /**\n   * Delete a named cookie with specified path and domain.  Be careful; to delete a cookie, you\n   * need to delete it using the exact same path and domain that were used to create the cookie.\n   * If the path is wrong, or the domain is wrong, the cookie simply won't be deleted.  Also\n   * note that specifying a domain that isn't a subset of the current domain will usually fail.\n   *\n   * Since there's no way to discover at runtime the original path and domain of a given cookie,\n   * we've added an option called 'recurse' to try all sub-domains of the current domain with\n   * all paths that are a subset of the current path.  Beware; this option can be slow.  In\n   * big-O notation, it operates in O(n*m) time, where n is the number of dots in the domain\n   * name and m is the number of slashes in the path.\n   *\n   * @param name the name of the cookie to be deleted\n   * @param optionsString options for the cookie. Currently supported options include 'path', 'domain'\n   *      and 'recurse.' The optionsString's format is \"path=/path/, domain=.foo.com, recurse=true\".\n   *      The order of options are irrelevant. Note that specifying a domain that isn't a subset of\n   *      the current domain will usually fail.\n   */\n  // set the expire time of the cookie to be deleted to one minute before now.\n  let path = ''\n  let domain = ''\n  let recurse = false\n  let matched = false\n  let results = /path=([^\\s,]+)[,]?/.exec(optionsString)\n  if (results) {\n    matched = true\n    path = results[1]\n  }\n  results = /domain=([^\\s,]+)[,]?/.exec(optionsString)\n  if (results) {\n    matched = true\n    domain = results[1]\n  }\n  results = /recurse=([^\\s,]+)[,]?/.exec(optionsString)\n  if (results) {\n    matched = true\n    recurse = results[1]\n    if ('false' == recurse) {\n      recurse = false\n    }\n  }\n  // Treat the entire optionsString as a path (for backwards compatibility)\n  if (optionsString && !matched) {\n    //LOG.warn(\"Using entire optionsString as a path; please change the argument to deleteCookie to use path=\" + optionsString);\n    path = optionsString\n  }\n  if (browserVersion.khtml) {\n    // Safari and conquerer don't like paths with / at the end\n    if ('/' != path) {\n      path = path.replace(/\\/$/, '')\n    }\n  }\n  path = path.trim()\n  domain = domain.trim()\n  let cookieName = name.trim()\n  if (recurse) {\n    this.browserbot.recursivelyDeleteCookie(cookieName, domain, path)\n  } else {\n    this.browserbot.deleteCookie(cookieName, domain, path)\n  }\n}\n\nSelenium.prototype.doDeleteAllVisibleCookies = function() {\n  /** Calls deleteCookie with recurse=true on all cookies visible to the current page.\n   * As noted on the documentation for deleteCookie, recurse=true can be much slower\n   * than simply deleting the cookies using a known domain/path.\n   */\n  let win = this.browserbot.getCurrentWindow()\n  let doc = win.document\n  let cookieNames = this.browserbot.getAllCookieNames(doc)\n  let domain = doc.domain\n  let path = win.location.pathname\n  for (let i = 0; i < cookieNames.length; i++) {\n    this.browserbot.recursivelyDeleteCookie(cookieNames[i], domain, path, win)\n  }\n}\n\n//Selenium.prototype.doSetBrowserLogLevel = function(logLevel) {\n/**\n * Sets the threshold for browser-side logging messages; log messages beneath this threshold will be discarded.\n * Valid logLevel strings are: \"debug\", \"info\", \"warn\", \"error\" or \"off\".\n * To see the browser logs, you need to\n * either show the log window in GUI mode, or enable browser-side logging in Selenium RC.\n *\n * @param logLevel one of the following: \"debug\", \"info\", \"warn\", \"error\" or \"off\"\n */\n/*    if (logLevel == null || logLevel == \"\") {\n        throw new SeleniumError(\"You must specify a log level\");\n    }\n    logLevel = logLevel.toLowerCase();\n    if (//LOG.logLevels[logLevel] == null) {\n        throw new SeleniumError(\"Invalid log level: \" + logLevel);\n    }\n    //LOG.setLogLevelThreshold(logLevel);\n}*/\n\nSelenium.prototype.doExecuteScript = function(script, varName) {\n  const value = this.eval(script.script, script.argv)\n  if (value && value.constructor.name === 'Promise') {\n    throw new Error('Expected sync operation, instead received Promise')\n  }\n  if (varName) {\n    return browser.runtime.sendMessage({ storeStr: value, storeVar: varName })\n  }\n}\n\nSelenium.prototype.doExecuteAsyncScript = function(script, varName) {\n  const value = this.eval(script.script, script.argv)\n  if (value && value.constructor.name !== 'Promise') {\n    throw new Error(\n      `Expected async operation, instead received ${\n        value ? value.constructor.name : value\n      }`\n    )\n  }\n  return Promise.resolve(value).then(v => {\n    if (varName) {\n      return browser.runtime.sendMessage({ storeStr: v, storeVar: varName })\n    }\n  })\n}\n\nSelenium.prototype.doRunScript = function(script) {\n  /**\n   * Creates a new \"script\" tag in the body of the current test window, and\n   * adds the specified text into the body of the command.  Scripts run in\n   * this way can often be debugged more easily than scripts executed using\n   * Selenium's \"getEval\" command.  Beware that JS exceptions thrown in these script\n   * tags aren't managed by Selenium, so you should probably wrap your script\n   * in try/catch blocks if there is any chance that the script will throw\n   * an exception.\n   * @param script the JavaScript snippet to run\n   */\n  this.eval(script.script, script.argv)\n}\n\nSelenium.prototype.doRollup = function(rollupName, kwargs) {\n  /**\n   * Executes a command rollup, which is a series of commands with a unique\n   * name, and optionally arguments that control the generation of the set of\n   * commands. If any one of the rolled-up commands fails, the rollup is\n   * considered to have failed. Rollups may also contain nested rollups.\n   *\n   * @param rollupName  the name of the rollup command\n   * @param kwargs      keyword arguments string that influences how the\n   *                    rollup expands into commands\n   */\n  // we have to temporarily hijack the commandStarted, nextCommand(),\n  // commandComplete(), and commandError() methods of the TestLoop object.\n  // When the expanded rollup commands are done executing (or an error has\n  // occurred), we'll restore them to their original values.\n  let loop = currentTest || htmlTestRunner.currentTest // eslint-disable-line no-undef\n  let backupManager = {\n    backup: function() {\n      for (let item in this.data) {\n        this.data[item] = loop[item]\n      }\n    },\n    restore: function() {\n      for (let item in this.data) {\n        loop[item] = this.data[item]\n      }\n    },\n    data: {\n      requiresCallBack: null,\n      commandStarted: null,\n      nextCommand: null,\n      commandComplete: null,\n      commandError: null,\n      pendingRollupCommands: null,\n      rollupFailed: null,\n      rollupFailedMessage: null,\n    },\n  }\n\n  // eslint-disable-next-line no-undef\n  let rule = RollupManager.getInstance().getRollupRule(rollupName)\n  let expandedCommands = rule.getExpandedCommands(kwargs)\n\n  // hold your breath ...\n  try {\n    backupManager.backup()\n    loop.requiresCallBack = false\n    loop.commandStarted = function() {}\n    loop.nextCommand = function() {\n      if (this.pendingRollupCommands.length == 0) {\n        return null\n      }\n      let command = this.pendingRollupCommands.shift()\n      return command\n    }\n    loop.commandComplete = function(result) {\n      if (result.failed) {\n        this.rollupFailed = true\n        this.rollupFailureMessages.push(result.failureMessage)\n      }\n\n      if (this.pendingRollupCommands.length == 0) {\n        result = {\n          failed: this.rollupFailed,\n          failureMessage: this.rollupFailureMessages.join('; '),\n        }\n        //LOG.info('Rollup execution complete: ' + (result.failed ? 'failed! (see error messages below)' : 'ok'));\n        backupManager.restore()\n        this.commandComplete(result)\n      }\n    }\n    loop.commandError = function(errorMessage) {\n      //LOG.info('Rollup execution complete: bombed!');\n      backupManager.restore()\n      this.commandError(errorMessage)\n    }\n\n    loop.pendingRollupCommands = expandedCommands\n    loop.rollupFailed = false\n    loop.rollupFailureMessages = []\n  } catch (e) {\n    //LOG.error('Rollup error: ' + e);\n    backupManager.restore()\n  }\n}\n\nSelenium.prototype.doAddScript = function(scriptContent, scriptTagId) {\n  /**\n   * Loads script content into a new script tag in the Selenium document. This\n   * differs from the runScript command in that runScript adds the script tag\n   * to the document of the AUT, not the Selenium document. The following\n   * entities in the script content are replaced by the characters they\n   * represent:\n   *\n   *     &lt;\n   *     &gt;\n   *     &amp;\n   *\n   * The corresponding remove command is removeScript.\n   *\n   * @param scriptContent  the Javascript content of the script to add\n   * @param scriptTagId    (optional) the id of the new script tag. If\n   *                       specified, and an element with this id already\n   *                       exists, this operation will fail.\n   */\n  if (scriptTagId && document.getElementById(scriptTagId)) {\n    let msg = \"Element with id '\" + scriptTagId + \"' already exists!\"\n    throw new SeleniumError(msg)\n  }\n\n  let head = document.getElementsByTagName('head')[0]\n  let script = document.createElement('script')\n\n  script.type = 'text/javascript'\n\n  if (scriptTagId) {\n    script.id = scriptTagId\n  }\n\n  // replace some entities\n  scriptContent = scriptContent\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>')\n    .replace(/&amp;/g, '&')\n\n  script.text = scriptContent\n  head.appendChild(script)\n}\n\nSelenium.prototype.doRemoveScript = function(scriptTagId) {\n  /**\n   * Removes a script tag from the Selenium document identified by the given\n   * id. Does nothing if the referenced tag doesn't exist.\n   *\n   * @param scriptTagId  the id of the script element to remove.\n   */\n  let script = document.getElementById(scriptTagId)\n\n  if (script && getTagName(script) == 'script') {\n    script.parentNode.removeChild(script)\n  }\n}\n\nSelenium.prototype.doUseXpathLibrary = function(libraryName) {\n  /**\n   * Allows choice of one of the available libraries.\n   * @param libraryName name of the desired library\n   * Only the following can be chosen:\n   * <ul>\n   *   <li>\"ajaxslt\" - Google's library</li>\n   *   <li>\"javascript-xpath\" - Cybozu Labs' faster library</li>\n   *   <li>\"rpc-optimizing-ajaxslt\" - the RPC optimizing strategy, delegating to ajaxslt</li>\n   *   <li>\"rpc-optimizing-jsxpath\" - the RPC optimizing strategy, delegating to javascript-xpath</li>\n   *   <li>\"default\" - The default library.  Currently the default library is \"ajaxslt\" .</li>\n   * </ul>\n   * If libraryName isn't one of these, it may be the name of another engine\n   * registered to the browserbot's XPathEvaluator, for example by overriding\n   * XPathEvaluator.prototype.init() . If it is not a registered engine\n   * either, then no change will be made.\n   */\n\n  if (!this.browserbot.getXPathEngine(libraryName)) {\n    return\n  }\n\n  this.browserbot.setXPathEngine(libraryName)\n}\n\n/**\n *  Factory for creating \"Option Locators\".\n *  An OptionLocator is an object for dealing with Select options (e.g. for\n *  finding a specified option, or asserting that the selected option of\n *  Select element matches some condition.\n *  The type of locator returned by the factory depends on the locator string:\n *     label=<exp>  (OptionLocatorByLabel)\n *     value=<exp>  (OptionLocatorByValue)\n *     index=<exp>  (OptionLocatorByIndex)\n *     id=<exp>     (OptionLocatorById)\n *     <exp> (default is OptionLocatorByLabel).\n */\nfunction OptionLocatorFactory() {}\n\nOptionLocatorFactory.prototype.fromLocatorString = function(locatorString) {\n  let locatorType = 'label'\n  let locatorValue = locatorString\n  // If there is a locator prefix, use the specified strategy\n  let result = locatorString.match(/^([a-zA-Z]+)=(.*)/)\n  if (result) {\n    locatorType = result[1]\n    locatorValue = result[2]\n  }\n  if (this.optionLocators == undefined) {\n    this.registerOptionLocators()\n  }\n  if (this.optionLocators[locatorType]) {\n    return new this.optionLocators[locatorType](locatorValue)\n  }\n  throw new SeleniumError('Unknown option locator type: ' + locatorType)\n}\n\n/**\n * To allow for easy extension, all of the option locators are found by\n * searching for all methods of OptionLocatorFactory.prototype that start\n * with \"OptionLocatorBy\".\n * TODO: Consider using the term \"Option Specifier\" instead of \"Option Locator\".\n */\nOptionLocatorFactory.prototype.registerOptionLocators = function() {\n  this.optionLocators = {}\n  for (let functionName in this) {\n    let result = /OptionLocatorBy([A-Z].+)$/.exec(functionName)\n    if (result != null) {\n      let locatorName = lowerFirstChar(result[1])\n      this.optionLocators[locatorName] = this[functionName]\n    }\n  }\n}\n\n/**\n *  OptionLocator for options identified by their labels.\n */\nOptionLocatorFactory.prototype.OptionLocatorByLabel = function(label) {\n  this.label = label\n  this.labelMatcher = new PatternMatcher(this.label)\n  this.findOption = function(element) {\n    for (let i = 0; i < element.options.length; i++) {\n      if (this.labelMatcher.matches(element.options[i].text)) {\n        return element.options[i]\n      }\n    }\n    throw new SeleniumError(\"Option with label '\" + this.label + \"' not found\")\n  }\n\n  this.assertSelected = function(element) {\n    let selectedLabel = element.options[element.selectedIndex].text\n    Assert.matches(this.label, selectedLabel) // eslint-disable-line no-undef\n  }\n}\n\n/**\n *  OptionLocator for options identified by their values.\n */\nOptionLocatorFactory.prototype.OptionLocatorByValue = function(value) {\n  this.value = value\n  this.valueMatcher = new PatternMatcher(this.value)\n  this.findOption = function(element) {\n    for (let i = 0; i < element.options.length; i++) {\n      if (this.valueMatcher.matches(element.options[i].value)) {\n        return element.options[i]\n      }\n    }\n    throw new SeleniumError(\"Option with value '\" + this.value + \"' not found\")\n  }\n\n  this.assertSelected = function(element) {\n    let selectedValue = element.options[element.selectedIndex].value\n    Assert.matches(this.value, selectedValue) // eslint-disable-line no-undef\n  }\n}\n\n/**\n *  OptionLocator for options identified by their index.\n */\nOptionLocatorFactory.prototype.OptionLocatorByIndex = function(index) {\n  this.index = Number(index)\n  if (isNaN(this.index) || this.index < 0) {\n    throw new SeleniumError('Illegal Index: ' + index)\n  }\n\n  this.findOption = function(element) {\n    if (element.options.length <= this.index) {\n      throw new SeleniumError(\n        'Index out of range.  Only ' +\n          element.options.length +\n          ' options available'\n      )\n    }\n    return element.options[this.index]\n  }\n\n  this.assertSelected = function(element) {\n    Assert.equals(this.index, element.selectedIndex) // eslint-disable-line no-undef\n  }\n}\n\n/**\n *  OptionLocator for options identified by their id.\n */\nOptionLocatorFactory.prototype.OptionLocatorById = function(id) {\n  this.id = id\n  this.idMatcher = new PatternMatcher(this.id)\n  this.findOption = function(element) {\n    for (let i = 0; i < element.options.length; i++) {\n      if (this.idMatcher.matches(element.options[i].id)) {\n        return element.options[i]\n      }\n    }\n    throw new SeleniumError(\"Option with id '\" + this.id + \"' not found\")\n  }\n\n  this.assertSelected = function(element) {\n    let selectedId = element.options[element.selectedIndex].id\n    Assert.matches(this.id, selectedId) // eslint-disable-line no-undef\n  }\n}\n\n//EditContentExt, Lin Yun Wen, SELAB, CSIE, NCKU, 2016/11/17\nSelenium.prototype.doEditContent = function(locator, value) {\n  /**\n   *to set text in the element which's conentEditable attribute is true\n   *@param locator an element locator\n   *@param value the context of the element in html\n   */\n  let element = this.browserbot.findElement(locator)\n  let editable = element.contentEditable\n\n  if (editable == 'true') {\n    element.innerHTML = escapeHTML(value)\n  } else {\n    throw new SeleniumError(\n      'The value of contentEditable attribute of this element is not true.'\n    )\n  }\n}\n\n// Modified prompt by SideeX comitters (Copyright 2017)\nSelenium.prototype.doChooseCancelOnNextPrompt = function() {\n  return this.browserbot.cancelNextPrompt()\n}\n\nSelenium.prototype.doAnswerOnNextPrompt = function(answer) {\n  return this.browserbot.setNextPromptResult(answer)\n}\n\nSelenium.prototype.doAssertPrompt = function(message) {\n  return this.browserbot.getPromptMessage().then(function(actualMessage) {\n    if (message != actualMessage)\n      return Promise.reject(\"Prompt message doesn't match actual message\")\n    else return Promise.resolve(true)\n  })\n}\n\n// Modified alert by SideeX comitters (Copyright 2017)\nSelenium.prototype.doAssertAlert = function(message) {\n  return this.browserbot.getAlertMessage().then(function(actualMessage) {\n    if (message != actualMessage)\n      return Promise.reject(\"Alert message doesn't match actual message\")\n    else return Promise.resolve(true)\n  })\n}\n\n// Modified confirm by SideeX comitters (Copyright 2017)\nSelenium.prototype.doChooseCancelOnNextConfirmation = function() {\n  return this.browserbot.setNextConfirmationResult(false)\n}\n\nSelenium.prototype.doChooseOkOnNextConfirmation = function() {\n  return this.browserbot.setNextConfirmationResult(true)\n}\n\nSelenium.prototype.doAssertConfirmation = function(value) {\n  return this.browserbot.getConfirmationMessage().then(function(actualMessage) {\n    if (value != actualMessage)\n      return Promise.reject(\"Confirmation message doesn't match actual message\")\n    else return Promise.resolve(true)\n  })\n}\n\nSelenium.prototype.doShowElement = function(locator) {\n  const elementForInjectingStyle = document.createElement('link')\n  elementForInjectingStyle.rel = 'stylesheet'\n  elementForInjectingStyle.href = browser.runtime.getURL(\n    '/assets/highlight.css'\n  )\n  ;(document.head || document.documentElement).appendChild(\n    elementForInjectingStyle\n  )\n  const highlightElement = document.createElement('div')\n  highlightElement.id = 'selenium-highlight'\n  document.body.appendChild(highlightElement)\n  if (locator.x) {\n    highlightElement.style.left = parseInt(locator.x) + 'px'\n    highlightElement.style.top = parseInt(locator.y) + 'px'\n    highlightElement.style.width = parseInt(locator.width) + 'px'\n    highlightElement.style.height = parseInt(locator.height) + 'px'\n  } else {\n    const bodyRects = document.documentElement.getBoundingClientRect()\n    const element = this.browserbot.findElement(locator)\n    const elementRects = element.getBoundingClientRect()\n    highlightElement.style.left =\n      parseInt(elementRects.left - bodyRects.left) + 'px'\n    highlightElement.style.top =\n      parseInt(elementRects.top - bodyRects.top) + 'px'\n    highlightElement.style.width = parseInt(elementRects.width) + 'px'\n    highlightElement.style.height = parseInt(elementRects.height) + 'px'\n  }\n  highlightElement.style.position = 'absolute'\n  highlightElement.style.zIndex = '100'\n  highlightElement.style.display = 'block'\n  highlightElement.style.pointerEvents = 'none'\n  scrollIntoViewIfNeeded(highlightElement, { centerIfNeeded: true })\n  highlightElement.className = 'active-selenium-highlight'\n  setTimeout(() => {\n    document.body.removeChild(highlightElement)\n    elementForInjectingStyle.parentNode.removeChild(elementForInjectingStyle)\n  }, 500)\n  return 'element found'\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content/selenium-api.js","/*\n * Copyright 2011 Software Freedom Conservancy\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\n/*\n * This script provides the Javascript API to drive the test application contained within\n * a Browser Window.\n * TODO:\n *    Add support for more events (keyboard and mouse)\n *    Allow to switch \"user-entry\" mode from mouse-based to keyboard-based, firing different\n *          events in different modes.\n */\n\nimport _Selenium from './selenium-api'\nimport SeleniumError from './SeleniumError'\nimport { selenium } from './commands-api'\nimport goog, { bot, core } from './closure-polyfill'\nimport { getTagName, parse_locator } from './utils'\nimport PatternMatcher from './PatternMatcher'\n\nexport const browserVersion = new window.global.BrowserVersion()\nwindow.global.browserVersion = browserVersion\n\n// The window to which the commands will be sent.  For example, to click on a\n// popup window, first select that window, and then do a normal click command.\nexport default class BrowserBot {\n  constructor(topLevelApplicationWindow) {\n    this.topWindow = topLevelApplicationWindow\n    this.topFrame = this.topWindow\n    this.baseUrl = window.location.href\n    bot.setWindow(window)\n\n    //UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/05/26\n    this.count = 1\n\n    // the buttonWindow is the Selenium window\n    // it contains the Run/Pause buttons... this should *not* be the AUT window\n    this.buttonWindow = window\n    this.currentWindow = this.topWindow\n    this.currentWindowName = null\n    this.allowNativeXpath = true\n    this.xpathEvaluator = new XPathEvaluator('ajaxslt') // change to \"javascript-xpath\" for the newer, faster engine\n\n    // We need to know this in advance, in case the frame closes unexpectedly\n    this.isSubFrameSelected = false\n\n    this.altKeyDown = false\n    this.controlKeyDown = false\n    this.shiftKeyDown = false\n    this.metaKeyDown = false\n\n    this.modalDialogTest = null\n    this.recordedAlerts = new Array()\n    this.recordedConfirmations = new Array()\n    this.recordedPrompts = new Array()\n    this.openedWindows = {}\n    //UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/05/26\n    this.openedWindows['win_ser_local'] = this.topWindow\n\n    this.nextConfirmResult = true\n    this.nextPromptResult = ''\n    this.newPageLoaded = false\n    this.pageLoadError = null\n\n    this.ignoreResponseCode = false\n    this.xhr = null\n    this.abortXhr = false\n    this.isXhrSent = false\n    this.isXhrDone = false\n    this.xhrOpenLocation = null\n    this.xhrResponseCode = null\n    this.xhrStatusText = null\n\n    this.shouldHighlightLocatedElement = false\n\n    this.uniqueId = 'seleniumMarker' + new Date().getTime()\n    this.pollingForLoad = new Object()\n    this.permDeniedCount = new Object()\n    this.windowPollers = new Array()\n    // DGF for backwards compatibility\n    this.browserbot = this\n\n    let self = this\n\n    Object.assign(this, PageBot.prototype)\n    this._registerAllLocatorFunctions()\n\n    this.recordPageLoad = function() {\n      self.newPageLoaded = true\n    }\n\n    this.isNewPageLoaded = function() {\n      let e\n\n      if (this.pageLoadError) {\n        e = this.pageLoadError\n        this.pageLoadError = null\n        throw e\n      }\n\n      if (self.ignoreResponseCode) {\n        return self.newPageLoaded\n      } else {\n        if (self.isXhrSent && self.isXhrDone) {\n          if (\n            !(\n              (self.xhrResponseCode >= 200 && self.xhrResponseCode <= 399) ||\n              self.xhrResponseCode == 0\n            )\n          ) {\n            // TODO: for IE status like: 12002, 12007, ... provide corresponding statusText messages also.\n            e =\n              'XHR ERROR: URL = ' +\n              self.xhrOpenLocation +\n              ' Response_Code = ' +\n              self.xhrResponseCode +\n              ' Error_Message = ' +\n              self.xhrStatusText\n            self.abortXhr = false\n            self.isXhrSent = false\n            self.isXhrDone = false\n            self.xhrResponseCode = null\n            self.xhrStatusText = null\n            throw new SeleniumError(e)\n          }\n        }\n        return (\n          self.newPageLoaded &&\n          (self.isXhrSent ? self.abortXhr || self.isXhrDone : true)\n        )\n      }\n    }\n\n    this.setAllowNativeXPath = function(allow) {\n      this.xpathEvaluator.setAllowNativeXPath(allow)\n    }\n\n    this.setIgnoreAttributesWithoutValue = function(ignore) {\n      this.xpathEvaluator.setIgnoreAttributesWithoutValue(ignore)\n    }\n\n    this.setXPathEngine = function(engineName) {\n      this.xpathEvaluator.setCurrentEngine(engineName)\n    }\n\n    this.getXPathEngine = function() {\n      return this.xpathEvaluator.getCurrentEngine()\n    }\n  }\n}\n\n// DGF PageBot exists for backwards compatibility with old user-extensions\nconst PageBot = function() {}\n\nBrowserBot.createForWindow = function(window, proxyInjectionMode) {\n  let browserbot\n  if (browserVersion.isIE) {\n    browserbot = new IEBrowserBot(window)\n  } else if (browserVersion.isKonqueror) {\n    browserbot = new KonquerorBrowserBot(window)\n  } else if (browserVersion.isOpera) {\n    browserbot = new OperaBrowserBot(window)\n  } else if (browserVersion.isSafari) {\n    browserbot = new SafariBrowserBot(window)\n  } else {\n    // Use mozilla by default\n    browserbot = new MozillaBrowserBot(window)\n  }\n  // getCurrentWindow has the side effect of modifying it to handle page loads etc\n  browserbot.proxyInjectionMode = proxyInjectionMode\n  browserbot.getCurrentWindow() // for modifyWindow side effect.  This is not a transparent style\n  return browserbot\n}\n\n// todo: rename?  This doesn't actually \"do\" anything.\nBrowserBot.prototype.doModalDialogTest = function(test) {\n  this.modalDialogTest = test\n}\n\nBrowserBot.prototype.cancelNextConfirmation = function(result) {\n  this.nextConfirmResult = result\n}\n\n//BrowserBot.prototype.setNextPromptResult = function(result) {\n//this.nextResult = result;\n//};\n\nBrowserBot.prototype.hasAlerts = function() {\n  return this.recordedAlerts.length > 0\n}\n\nBrowserBot.prototype.relayBotToRC = function(s) {\n  // DGF need to do this funny trick to see if we're in PI mode, because\n  // \"this\" might be the window, rather than the browserbot (e.g. during window.alert)\n  let piMode = this.proxyInjectionMode\n  if (!piMode) {\n    if (typeof selenium != 'undefined') {\n      piMode = selenium.browserbot && selenium.browserbot.proxyInjectionMode\n    }\n  }\n  if (piMode) {\n    this.relayToRC('selenium.' + s)\n  }\n}\n\nBrowserBot.prototype.relayToRC = function() {\n  return null\n}\n\nBrowserBot.prototype.resetPopups = function() {\n  this.recordedAlerts = []\n  this.recordedConfirmations = []\n  this.recordedPrompts = []\n}\n\nBrowserBot.prototype.getNextAlert = function() {\n  let t = this.recordedAlerts.shift()\n  if (t) {\n    t = t.replace(/\\n/g, ' ') // because Selenese loses \\n's when retrieving text from HTML table\n  }\n  this.relayBotToRC('browserbot.recordedAlerts')\n  return t\n}\n\nBrowserBot.prototype.hasConfirmations = function() {\n  return this.recordedConfirmations.length > 0\n}\n\nBrowserBot.prototype.getNextConfirmation = function() {\n  let t = this.recordedConfirmations.shift()\n  this.relayBotToRC('browserbot.recordedConfirmations')\n  return t\n}\n\nBrowserBot.prototype.hasPrompts = function() {\n  return this.recordedPrompts.length > 0\n}\n\nBrowserBot.prototype.getNextPrompt = function() {\n  let t = this.recordedPrompts.shift()\n  this.relayBotToRC('browserbot.recordedPrompts')\n  return t\n}\n\n/* Fire a mouse event in a browser-compatible manner */\n\nBrowserBot.prototype.triggerMouseEvent = function(\n  element,\n  eventType,\n  canBubble,\n  clientX,\n  clientY,\n  button\n) {\n  clientX = clientX ? clientX : 0\n  clientY = clientY ? clientY : 0\n\n  //LOG.debug(\"triggerMouseEvent assumes setting screenX and screenY to 0 is ok\");\n  let screenX = 0\n  let screenY = 0\n\n  canBubble = typeof canBubble == undefined ? true : canBubble\n  let doc = goog.dom.getOwnerDocument(element)\n  let view = goog.dom.getWindow(doc)\n\n  let evt = doc.createEvent('MouseEvents')\n  if (evt.initMouseEvent) {\n    // see http://developer.mozilla.org/en/docs/DOM:event.button and\n    // http://developer.mozilla.org/en/docs/DOM:event.initMouseEvent for button ternary logic logic\n    //Safari\n    evt.initMouseEvent(\n      eventType,\n      canBubble,\n      true,\n      view,\n      1,\n      screenX,\n      screenY,\n      clientX,\n      clientY,\n      this.controlKeyDown,\n      this.altKeyDown,\n      this.shiftKeyDown,\n      this.metaKeyDown,\n      button ? button : 0,\n      null\n    )\n  } else {\n    //LOG.warn(\"element doesn't have initMouseEvent; firing an event which should -- but doesn't -- have other mouse-event related attributes here, as well as controlKeyDown, altKeyDown, shiftKeyDown, metaKeyDown\");\n    evt.initEvent(eventType, canBubble, true)\n\n    evt.shiftKey = this.shiftKeyDown\n    evt.metaKey = this.metaKeyDown\n    evt.altKey = this.altKeyDown\n    evt.ctrlKey = this.controlKeyDown\n    if (button) {\n      evt.button = button\n    }\n  }\n  element.dispatchEvent(evt)\n}\n\n//DragAndDropExt, Shuo-Heng Shih, SELAB, CSIE, NCKU, 2016/10/17\nBrowserBot.prototype.triggerDragEvent = function(element, target) {\n  const getXpathOfElement = function(element) {\n    if (element == null) {\n      return 'null'\n    }\n    if (element.parentElement == null) {\n      return '/' + element.tagName\n    }\n\n    let siblingElement = element.parentElement.children\n    let tagCount = 0\n    let totalTagCount = 0\n    let isFound = false\n\n    for (let i = 0; i < siblingElement.length; i++) {\n      if (siblingElement[i].tagName == element.tagName && !isFound) {\n        tagCount++\n        totalTagCount++\n      } else if (siblingElement[i].tagName == element.tagName) {\n        totalTagCount++\n      }\n      if (siblingElement[i] == element) {\n        isFound = true\n      }\n    }\n\n    if (totalTagCount > 1) {\n      return (\n        getXpathOfElement(element.parentElement) +\n        '/' +\n        element.tagName +\n        '[' +\n        tagCount +\n        ']'\n      )\n    }\n\n    return getXpathOfElement(element.parentElement) + '/' + element.tagName\n  }\n  let script =\n    \"                                              \\\n        function simulateDragDrop(sourceNode, destinationNode){\\\n        function createCustomEvent(type) {                     \\\n            var event = new CustomEvent('CustomEvent');        \\\n            event.initCustomEvent(type, true, true, null);     \\\n            event.dataTransfer = {                             \\\n                data: {                                        \\\n                },                                             \\\n                setData: function(type, val) {                 \\\n                    this.data[type] = val;                     \\\n                },                                             \\\n                getData: function(type) {                      \\\n                    return this.data[type];                    \\\n                }                                              \\\n            };                                                 \\\n            return event;                                      \\\n        }                                                      \\\n        function dispatchEvent(node, type, event) {            \\\n            if (node.dispatchEvent) {                          \\\n                return node.dispatchEvent(event);              \\\n            }                                                  \\\n            if (node.fireEvent) {                              \\\n                return node.fireEvent('on' + type, event);     \\\n            }                                                  \\\n        }                                                      \\\n        var event = createCustomEvent('dragstart');            \\\n        dispatchEvent(sourceNode, 'dragstart', event);         \\\n                                                               \\\n        var dropEvent = createCustomEvent('drop');             \\\n        dropEvent.dataTransfer = event.dataTransfer;           \\\n        dispatchEvent(destinationNode, 'drop', dropEvent);     \\\n                                                               \\\n        var dragEndEvent = createCustomEvent('dragend');       \\\n        dragEndEvent.dataTransfer = event.dataTransfer;        \\\n        dispatchEvent(sourceNode, 'dragend', dragEndEvent);    \\\n    }                                                          \\\n    simulateDragDrop(document.evaluate('\" +\n    getXpathOfElement(element) +\n    \"', document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue, document.evaluate('\" +\n    getXpathOfElement(target) +\n    \"', document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue);\\\n    \"\n  let win = this.browserbot.getCurrentWindow()\n  let doc = win.document\n  let scriptTag = doc.createElement('script')\n  scriptTag.type = 'text/javascript'\n  scriptTag.text = script\n  doc.body.appendChild(scriptTag)\n}\n\nBrowserBot.prototype._windowClosed = function(win) {\n  try {\n    let c = win.closed\n    if (c == null) return true\n    return c\n  } catch (ignored) {\n    // Firefox 15+ may already have marked the win dead. Accessing it\n    // causes an exception to be thrown. That exception tells us the window\n    // is closed.\n    return true\n  }\n}\n\nBrowserBot.uniqueKey = 1\n\nBrowserBot.prototype._modifyWindow = function(win) {\n  // In proxyInjectionMode, have to suppress //LOG calls in _modifyWindow to avoid an infinite loop\n  if (this._windowClosed(win)) {\n    if (!this.proxyInjectionMode) {\n      //LOG.error(\"modifyWindow: Window was closed!\");\n    }\n    return null\n  }\n  if (!this.proxyInjectionMode) {\n    //LOG.debug('modifyWindow ' + this.uniqueId + \":\" + win[this.uniqueId]);\n  }\n\n  // Assign a unique label for this window. We set this on a known attribute so we can reliably\n  // find it later. This is slightly different from uniqueId.\n  win.seleniumKey = BrowserBot.uniqueKey++\n\n  try {\n    this.modifyWindowToRecordPopUpDialogs(win, this)\n  } catch (ex) {\n    console.error(ex) // eslint-disable-line no-console\n  }\n\n  //Commenting out for issue 1854\n  //win[this.uniqueId] = 1;\n\n  // In proxyInjection mode, we have our own mechanism for detecting page loads\n  if (!this.proxyInjectionMode) {\n    this.modifySeparateTestWindowToDetectPageLoads(win)\n  }\n  if (win.frames && win.frames.length && win.frames.length > 0) {\n    for (let i = 0; i < win.frames.length; i++) {\n      try {\n        this._modifyWindow(win.frames[i])\n      } catch (e) {} // eslint-disable-line no-empty\n      // we're just trying to be opportunistic; don't worry if this doesn't work out\n    }\n  }\n  return win\n}\n\nBrowserBot.prototype.selectWindow = function(target) {\n  if (!target || target == 'null') {\n    this._selectTopWindow()\n    return\n  }\n  let result = target.match(/^([a-zA-Z]+)=(.*)/)\n  if (!result) {\n    this._selectWindowByWindowId(target)\n    return\n  }\n  let locatorType = result[1]\n  let locatorValue = result[2]\n  if (locatorType == 'title') {\n    this._selectWindowByTitle(locatorValue)\n  }\n  // TODO separate name and var into separate functions\n  else if (locatorType == 'name') {\n    this._selectWindowByName(locatorValue)\n  } else if (locatorType == 'var') {\n    let win = this.getCurrentWindow().eval(locatorValue)\n    if (win) {\n      this._selectWindowByName(win.name)\n    } else {\n      throw new SeleniumError('Window not found by var: ' + locatorValue)\n    }\n  } else {\n    throw new SeleniumError('Window locator not recognized: ' + locatorType)\n  }\n}\n\nBrowserBot.prototype.selectPopUp = function(windowId) {\n  if (!windowId || windowId == 'null') {\n    this._selectFirstNonTopWindow()\n  } else {\n    this._selectWindowByWindowId(windowId)\n  }\n}\n\nBrowserBot.prototype._selectTopWindow = function() {\n  this.currentWindowName = null\n  this.currentWindow = this.topWindow\n  this.topFrame = this.topWindow\n  this.isSubFrameSelected = false\n}\n\nBrowserBot.prototype._selectWindowByWindowId = function(windowId) {\n  try {\n    this._selectWindowByName(windowId)\n  } catch (e) {\n    this._selectWindowByTitle(windowId)\n  }\n}\n\nBrowserBot.prototype._selectWindowByName = function(target) {\n  this.currentWindow = this.getWindowByName(target, false)\n  this.topFrame = this.currentWindow\n  this.currentWindowName = target\n  this.isSubFrameSelected = false\n}\n\nBrowserBot.prototype._selectWindowByTitle = function(target) {\n  let windowName = this.getWindowNameByTitle(target)\n  if (!windowName) {\n    this._selectTopWindow()\n  } else {\n    this._selectWindowByName(windowName)\n  }\n}\n\nBrowserBot.prototype._selectFirstNonTopWindow = function() {\n  let names = this.getNonTopWindowNames()\n  if (names.length) {\n    this._selectWindowByName(names[0])\n  }\n}\n\nBrowserBot.prototype.selectFrame = function(target) {\n  let frame\n\n  if (target.indexOf('index=') == 0) {\n    target = target.substr(6)\n    frame = this.getCurrentWindow().frames[target]\n    if (frame == null) {\n      throw new SeleniumError('Not found: frames[' + target + ']')\n    }\n    if (!frame.document) {\n      throw new SeleniumError('frames[' + target + '] is not a frame')\n    }\n    this.currentWindow = frame\n    this.isSubFrameSelected = true\n  } else if (target == 'relative=up' || target == 'relative=parent') {\n    this.currentWindow = this.getCurrentWindow().parent\n    this.isSubFrameSelected = this._getFrameElement(this.currentWindow) != null\n  } else if (target == 'relative=top') {\n    this.currentWindow = this.topFrame\n    this.isSubFrameSelected = false\n  } else {\n    frame = this.findElement(target)\n    if (frame == null) {\n      throw new SeleniumError('Not found: ' + target)\n    }\n    // now, did they give us a frame or a frame ELEMENT?\n    let match = false\n    if (frame.contentWindow) {\n      // this must be a frame element\n      if (browserVersion.isHTA) {\n        // stupid HTA bug; can't get in the front door\n        target = frame.contentWindow.name\n      } else {\n        this.currentWindow = frame.contentWindow\n        this.isSubFrameSelected = true\n        match = true\n      }\n    } else if (frame.document && frame.location) {\n      // must be an actual window frame\n      this.currentWindow = frame\n      this.isSubFrameSelected = true\n      match = true\n    }\n\n    if (!match) {\n      // neither, let's loop through the frame names\n      let win = this.getCurrentWindow()\n\n      if (win && win.frames && win.frames.length) {\n        for (let i = 0; i < win.frames.length; i++) {\n          if (win.frames[i].name == target) {\n            this.currentWindow = win.frames[i]\n            this.isSubFrameSelected = true\n            match = true\n            break\n          }\n        }\n      }\n      if (!match) {\n        throw new SeleniumError('Not a frame: ' + target)\n      }\n    }\n  }\n  // modifies the window\n  this.getCurrentWindow()\n}\n\nBrowserBot.prototype.doesThisFrameMatchFrameExpression = function(\n  currentFrameString,\n  target\n) {\n  let isDom = false\n  if (target.indexOf('dom=') == 0) {\n    target = target.substr(4)\n    isDom = true\n  } else if (target.indexOf('index=') == 0) {\n    target = 'frames[' + target.substr(6) + ']'\n    isDom = true\n  }\n  let t\n  //Evalinsandbox\n  // eslint-disable-next-line no-undef\n  let mySandbox = new Components.utils.Sandbox(this.currentWindow.location.href)\n  mySandbox.currentFrameString = currentFrameString\n  mySandbox.target = target\n  try {\n    // eslint-disable-next-line no-undef\n    t = Components.utils.evalInSandbox(\n      currentFrameString + '.' + target,\n      mySandbox\n    )\n    //eval(\"t=\" + currentFrameString + \".\" + target);\n  } catch (e) {} // eslint-disable-line no-empty\n  let autWindow = this.browserbot.getCurrentWindow()\n  if (t != null) {\n    try {\n      if (t.window == autWindow) {\n        return true\n      }\n      if (t.window.uniqueId == autWindow.uniqueId) {\n        return true\n      }\n      return false\n    } catch (permDenied) {\n      // DGF if the windows are incomparable, they're probably not the same...\n    }\n  }\n  if (isDom) {\n    return false\n  }\n  // eslint-disable-next-line no-undef\n  let currentFrame = Components.utils.evalInSandbox(\n    currentFrameString,\n    mySandbox\n  )\n  //var currentFrame;\n  //eval(\"currentFrame=\" + currentFrameString);\n  if (target == 'relative=up') {\n    if (currentFrame.window.parent == autWindow) {\n      return true\n    }\n    return false\n  }\n  if (target == 'relative=top') {\n    if (currentFrame.window.top == autWindow) {\n      return true\n    }\n    return false\n  }\n  if (currentFrame.window == autWindow.parent) {\n    if (autWindow.name == target) {\n      return true\n    }\n    try {\n      let element = this.findElement(target, currentFrame.window)\n      if (element.contentWindow == autWindow) {\n        return true\n      }\n    } catch (e) {} // eslint-disable-line no-empty\n  }\n  return false\n}\n\nBrowserBot.prototype.abortXhrRequest = function() {\n  if (this.ignoreResponseCode) {\n    //LOG.debug(\"XHR response code being ignored. Nothing to abort.\");\n  } else {\n    if (this.abortXhr == false && this.isXhrSent && !this.isXhrDone) {\n      //LOG.info(\"abortXhrRequest(): aborting request\");\n      this.abortXhr = true\n      this.xhr.abort()\n    }\n  }\n}\n\nBrowserBot.prototype.onXhrStateChange = function(method) {\n  //LOG.info(\"onXhrStateChange(): xhr.readyState = \" + this.xhr.readyState + \" method = \" + method + \" time = \" + new Date().getTime());\n  if (this.xhr.readyState == 4) {\n    // check if the request got aborted.\n    if (this.abortXhr == true) {\n      this.xhrResponseCode = 0\n      this.xhrStatusText = 'Request Aborted'\n      this.isXhrDone = true\n      return\n    }\n\n    try {\n      if (\n        method == 'HEAD' &&\n        (this.xhr.status == 501 || this.xhr.status == 405)\n      ) {\n        //LOG.info(\"onXhrStateChange(): HEAD ajax returned 501 or 405, retrying with GET\");\n        // handle 501 response code from servers that do not support 'HEAD' method.\n        // send GET ajax request with range 0-1.\n        this.xhr = new XMLHttpRequest()\n        this.xhr.onreadystatechange = this.onXhrStateChange.bind(this, 'GET')\n        this.xhr.open('GET', this.xhrOpenLocation, true)\n        this.xhr.setRequestHeader('Range', 'bytes:0-1')\n        this.xhr.send('')\n        this.isXhrSent = true\n        return\n      }\n      this.xhrResponseCode = this.xhr.status\n      this.xhrStatusText = this.xhr.statusText\n    } catch (ex) {\n      //LOG.info(\"encountered exception while reading xhrResponseCode.\" + ex.message);\n      this.xhrResponseCode = -1\n      this.xhrStatusText = 'Request Error'\n    }\n\n    this.isXhrDone = true\n  }\n}\n\nBrowserBot.prototype.openWindow = function(url, windowID) {\n  if (url != '') {\n    url = 'https://www.google.com'\n  }\n  if (browserVersion.isHTA) {\n    // in HTA mode, calling .open on the window interprets the url relative to that window\n    // we need to absolute-ize the URL to make it consistent\n    let child = this.getCurrentWindow().open(url, windowID, 'resizable=yes')\n    selenium.browserbot.openedWindows[windowID] = child\n  } else {\n    this.getCurrentWindow().open(url, windowID, 'resizable=yes')\n  }\n}\n\nBrowserBot.prototype.setIFrameLocation = function(iframe, location) {\n  iframe.src = location\n}\n\nBrowserBot.prototype.getCurrentPage = function() {\n  return this\n}\n\nBrowserBot.prototype.windowNeedsModifying = function(win, uniqueId) {\n  // On anything but Firefox, checking the unique id is enough.\n  // Firefox 4 introduces a race condition which selenium regularly loses.\n\n  try {\n    // eslint-disable-next-line no-undef\n    let appInfo = Components.classes['@mozilla.org/xre/app-info;1'].getService(\n      // eslint-disable-next-line no-undef\n      Components.interfaces.nsIXULAppInfo\n    )\n    // eslint-disable-next-line no-undef\n    let versionChecker = Components.classes[\n      '@mozilla.org/xpcom/version-comparator;1'\n      // eslint-disable-next-line no-undef\n    ].getService(Components.interfaces.nsIVersionComparator)\n\n    if (versionChecker.compare(appInfo.version, '4.0b1') >= 0) {\n      return win.alert.toString().indexOf('native code') != -1\n    }\n  } catch (ignored) {} // eslint-disable-line no-empty\n  return !win[uniqueId]\n}\n\nBrowserBot.prototype.modifyWindowToRecordPopUpDialogs = function(\n  originalWindow,\n  browserBot\n) {\n  let self = this\n\n  // Apparently, Firefox 4 makes it possible to unwrap an object to find that\n  // there's nothing in it.\n  let windowToModify = core.firefox.unwrap(originalWindow)\n  if (!windowToModify) {\n    windowToModify = originalWindow\n  }\n\n  windowToModify.seleniumAlert = windowToModify.alert\n\n  if (!self.windowNeedsModifying(windowToModify, browserBot.uniqueId)) {\n    return\n  }\n\n  windowToModify.alert = function(alert) {\n    browserBot.recordedAlerts.push(alert)\n    self.relayBotToRC.call(self, 'browserbot.recordedAlerts')\n  }\n\n  windowToModify.confirm = function(message) {\n    browserBot.recordedConfirmations.push(message)\n    let result = browserBot.nextConfirmResult\n    browserBot.nextConfirmResult = true\n    self.relayBotToRC.call(self, 'browserbot.recordedConfirmations')\n    return result\n  }\n\n  windowToModify.prompt = function(message) {\n    browserBot.recordedPrompts.push(message)\n    let result = !browserBot.nextConfirmResult\n      ? null\n      : browserBot.nextPromptResult\n    browserBot.nextConfirmResult = true\n    browserBot.nextPromptResult = ''\n    self.relayBotToRC.call(self, 'browserbot.recordedPrompts')\n    return result\n  }\n\n  // Keep a reference to all popup windows by name\n  // note that in IE the \"windowName\" argument must be a valid javascript identifier, it seems.\n  let originalOpen = windowToModify.open\n  let originalOpenReference\n  if (browserVersion.isHTA) {\n    originalOpenReference = 'selenium_originalOpen' + new Date().getTime()\n    windowToModify[originalOpenReference] = windowToModify.open\n  }\n\n  let isHTA = browserVersion.isHTA\n\n  let newOpen = function(url, windowName, windowFeatures, replaceFlag) {\n    let myOriginalOpen = originalOpen\n    if (isHTA) {\n      myOriginalOpen = this[originalOpenReference]\n    }\n\n    //UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/05/26\n    if (\n      windowName == '' ||\n      windowName == '_blank' ||\n      typeof windowName === 'undefined'\n    ) {\n      windowName = 'win_ser_' + self.count\n      self.count += 1\n    }\n\n    let openedWindow = myOriginalOpen(\n      url,\n      windowName,\n      windowFeatures,\n      replaceFlag\n    )\n    //LOG.debug(\"window.open call intercepted; window ID (which you can use with selectWindow()) is \\\"\" +  windowName + \"\\\"\");\n    if (windowName != null) {\n      openedWindow['seleniumWindowName'] = windowName\n    }\n    selenium.browserbot.openedWindows[windowName] = openedWindow\n    return openedWindow\n  }\n\n  if (browserVersion.isHTA) {\n    originalOpenReference = 'selenium_originalOpen' + new Date().getTime()\n    const newOpenReference = 'selenium_newOpen' + new Date().getTime()\n    let setOriginalRef = \"this['\" + originalOpenReference + \"'] = this.open;\"\n\n    if (windowToModify.eval) {\n      windowToModify.eval(setOriginalRef)\n      windowToModify.open = newOpen\n    } else {\n      // DGF why can't I eval here?  Seems like I'm querying the window at a bad time, maybe?\n      setOriginalRef += \"this.open = this['\" + newOpenReference + \"'];\"\n      windowToModify[newOpenReference] = newOpen\n      windowToModify.setTimeout(setOriginalRef, 0)\n    }\n  } else {\n    windowToModify.open = newOpen\n  }\n}\n\n/**\n * Call the supplied function when a the current page unloads and a new one loads.\n * This is done by polling continuously until the document changes and is fully loaded.\n */\nBrowserBot.prototype.modifySeparateTestWindowToDetectPageLoads = function(\n  windowObject\n) {\n  // Since the unload event doesn't fire in Safari 1.3, we start polling immediately\n  if (!windowObject) {\n    //LOG.warn(\"modifySeparateTestWindowToDetectPageLoads: no windowObject!\");\n    return\n  }\n  if (this._windowClosed(windowObject)) {\n    //LOG.info(\"modifySeparateTestWindowToDetectPageLoads: windowObject was closed\");\n    return\n  }\n  let oldMarker = this.isPollingForLoad(windowObject)\n  if (oldMarker) {\n    //LOG.debug(\"modifySeparateTestWindowToDetectPageLoads: already polling this window: \" + oldMarker);\n    return\n  }\n\n  let marker = 'selenium' + new Date().getTime()\n  //LOG.debug(\"Starting pollForLoad (\" + marker + \"): \" + windowObject.location);\n  this.pollingForLoad[marker] = true\n  // if this is a frame, add a load listener, otherwise, attach a poller\n  let frameElement = this._getFrameElement(windowObject)\n  // DGF HTA mode can't attach load listeners to subframes (yuk!)\n  let htaSubFrame = this._isHTASubFrame(windowObject)\n  if (frameElement && !htaSubFrame) {\n    //LOG.debug(\"modifySeparateTestWindowToDetectPageLoads: this window is a frame; attaching a load listener\");\n    //addLoadListener(frameElement, this.recordPageLoad); TODO: check if this is necessary\n    frameElement[marker] = true\n    frameElement['frame' + this.uniqueId] = marker\n    //LOG.debug(\"dgf this.uniqueId=\"+this.uniqueId);\n    //LOG.debug(\"dgf marker=\"+marker);\n    //LOG.debug(\"dgf frameElement['frame'+this.uniqueId]=\"+frameElement['frame'+this.uniqueId]);\n    frameElement[this.uniqueId] = marker\n    //LOG.debug(\"dgf frameElement[this.uniqueId]=\"+frameElement[this.uniqueId]);\n  } else {\n    windowObject.location[marker] = true\n    windowObject[this.uniqueId] = marker\n    this.pollForLoad(\n      this.recordPageLoad,\n      windowObject,\n      windowObject.document,\n      windowObject.location,\n      windowObject.location.href,\n      marker\n    )\n  }\n}\n\nBrowserBot.prototype._isHTASubFrame = function() {\n  if (!browserVersion.isHTA) return false\n  // DGF this is wrong! what if \"win\" isn't the selected window?\n  return this.isSubFrameSelected\n}\n\nBrowserBot.prototype._getFrameElement = function(win) {\n  let frameElement = null\n  let caught\n  try {\n    frameElement = win.frameElement\n  } catch (e) {\n    caught = true\n  }\n  if (caught) {\n    // on IE, checking frameElement in a pop-up results in a \"No such interface supported\" exception\n    // but it might have a frame element anyway!\n    let parentContainsIdenticallyNamedFrame = false\n    try {\n      parentContainsIdenticallyNamedFrame = win.parent.frames[win.name]\n    } catch (e) {} // eslint-disable-line no-empty\n    // this may fail if access is denied to the parent; in that case, assume it's not a pop-up\n\n    if (parentContainsIdenticallyNamedFrame) {\n      // it can't be a coincidence that the parent has a frame with the same name as myself!\n      let result\n      try {\n        result = parentContainsIdenticallyNamedFrame.frameElement\n        if (result) {\n          return result\n        }\n      } catch (e) {} // eslint-disable-line no-empty\n      // it was worth a try! _getFrameElementsByName is often slow\n      result = this._getFrameElementByName(win.name, win.parent.document, win)\n      return result\n    }\n  }\n  //LOG.debug(\"_getFrameElement: frameElement=\"+frameElement);\n  if (frameElement) {\n    //LOG.debug(\"frameElement.name=\"+frameElement.name);\n  }\n  return frameElement\n}\n\nBrowserBot.prototype._getFrameElementByName = function(name, doc, win) {\n  let frames\n  let frame\n  let i\n  frames = doc.getElementsByTagName('iframe')\n  for (i = 0; i < frames.length; i++) {\n    frame = frames[i]\n    if (frame.name === name) {\n      return frame\n    }\n  }\n  frames = doc.getElementsByTagName('frame')\n  for (i = 0; i < frames.length; i++) {\n    frame = frames[i]\n    if (frame.name === name) {\n      return frame\n    }\n  }\n  // DGF weird; we only call this function when we know the doc contains the frame\n  //LOG.warn(\"_getFrameElementByName couldn't find a frame or iframe; checking every element for the name \" + name);\n  return BrowserBot.prototype.locateElementByName(win.name, win.parent.document)\n}\n\n/**\n * Set up a polling timer that will keep checking the readyState of the document until it's complete.\n * Since we might call this before the original page is unloaded, we first check to see that the current location\n * or href is different from the original one.\n */\nBrowserBot.prototype.pollForLoad = function(\n  loadFunction,\n  windowObject,\n  originalDocument,\n  originalLocation,\n  originalHref,\n  marker\n) {\n  //LOG.debug(\"pollForLoad original (\" + marker + \"): \" + originalHref);\n  try {\n    //Samit: Fix: open command sometimes fails if current url is chrome and new is not\n    windowObject = core.firefox.unwrap(windowObject)\n    if (this._windowClosed(windowObject)) {\n      //LOG.debug(\"pollForLoad WINDOW CLOSED (\" + marker + \")\");\n      delete this.pollingForLoad[marker]\n      return\n    }\n\n    let isSamePage = this._isSamePage(\n      windowObject,\n      originalDocument,\n      originalLocation,\n      originalHref,\n      marker\n    )\n    let rs = this.getReadyState(windowObject, windowObject.document)\n\n    if (!isSamePage && rs == 'complete') {\n      let currentHref = windowObject.location.href\n      //LOG.debug(\"pollForLoad FINISHED (\" + marker + \"): \" + rs + \" (\" + currentHref + \")\");\n      delete this.pollingForLoad[marker]\n      this._modifyWindow(windowObject)\n      let newMarker = this.isPollingForLoad(windowObject)\n      if (!newMarker) {\n        //LOG.debug(\"modifyWindow didn't start new poller: \" + newMarker);\n        this.modifySeparateTestWindowToDetectPageLoads(windowObject)\n      }\n      newMarker = this.isPollingForLoad(windowObject)\n      let currentlySelectedWindow\n      let currentlySelectedWindowMarker\n      currentlySelectedWindow = this.getCurrentWindow(true)\n      currentlySelectedWindowMarker = currentlySelectedWindow[this.uniqueId]\n\n      //LOG.debug(\"pollForLoad (\" + marker + \") restarting \" + newMarker);\n      if (/(TestRunner-splash|Blank)\\.html\\?start=true$/.test(currentHref)) {\n        //LOG.debug(\"pollForLoad Oh, it's just the starting page.  Never mind!\");\n      } else if (currentlySelectedWindowMarker == newMarker) {\n        loadFunction(currentlySelectedWindow)\n      } else {\n        //LOG.debug(\"pollForLoad page load detected in non-current window; ignoring (currentlySelected=\"+currentlySelectedWindowMarker+\", detection in \"+newMarker+\")\");\n      }\n      return\n    }\n    //LOG.debug(\"pollForLoad continue (\" + marker + \"): \" + currentHref);\n    this.reschedulePoller(\n      loadFunction,\n      windowObject,\n      originalDocument,\n      originalLocation,\n      originalHref,\n      marker\n    )\n  } catch (e) {\n    //LOG.debug(\"Exception during pollForLoad; this should get noticed soon (\" + e.message + \")!\");\n    //DGF this is supposed to get logged later; log it at debug just in case\n    ////LOG.exception(e);\n    this.pageLoadError = e\n  }\n}\n\nBrowserBot.prototype._isSamePage = function(\n  windowObject,\n  originalDocument,\n  originalLocation,\n  originalHref,\n  marker\n) {\n  let currentDocument = windowObject.document\n  let currentLocation = windowObject.location\n  let currentHref = currentLocation.href\n\n  let sameDoc = this._isSameDocument(originalDocument, currentDocument)\n\n  let sameLoc = originalLocation === currentLocation\n\n  // hash marks don't meant the page has loaded, so we need to strip them off if they exist...\n  let currentHash = currentHref.indexOf('#')\n  if (currentHash > 0) {\n    currentHref = currentHref.substring(0, currentHash)\n  }\n  let originalHash = originalHref.indexOf('#')\n  if (originalHash > 0) {\n    originalHref = originalHref.substring(0, originalHash)\n  }\n  //LOG.debug(\"_isSamePage: currentHref: \" + currentHref);\n  //LOG.debug(\"_isSamePage: originalHref: \" + originalHref);\n\n  let sameHref = originalHref === currentHref\n  let markedLoc = currentLocation[marker]\n\n  if (browserVersion.isKonqueror || browserVersion.isSafari) {\n    // the mark disappears too early on these browsers\n    markedLoc = true\n  }\n\n  // since this is some _very_ important logic, especially for PI and multiWindow mode, we should log all these out\n  //LOG.debug(\"_isSamePage: sameDoc: \" + sameDoc);\n  //LOG.debug(\"_isSamePage: sameLoc: \" + sameLoc);\n  //LOG.debug(\"_isSamePage: sameHref: \" + sameHref);\n  //LOG.debug(\"_isSamePage: markedLoc: \" + markedLoc);\n\n  return sameDoc && sameLoc && sameHref && markedLoc\n}\n\nBrowserBot.prototype._isSameDocument = function(\n  originalDocument,\n  currentDocument\n) {\n  return originalDocument === currentDocument\n}\n\nBrowserBot.prototype.getReadyState = function(windowObject, currentDocument) {\n  let rs = currentDocument.readyState\n  if (rs == null) {\n    if (\n      (this.buttonWindow != null &&\n        this.buttonWindow.document.readyState == null) || // not proxy injection mode (and therefore buttonWindow isn't null)\n      top.document.readyState == null\n    ) {\n      // proxy injection mode (and therefore everything's in the top window, but buttonWindow doesn't exist)\n      // uh oh!  we're probably on Firefox with no readyState extension installed!\n      // We'll have to just take a guess as to when the document is loaded; this guess\n      // will never be perfect. :-(\n      if (\n        typeof currentDocument.getElementsByTagName != 'undefined' &&\n        typeof currentDocument.getElementById != 'undefined' &&\n        (currentDocument.getElementsByTagName('body')[0] != null ||\n          currentDocument.body != null)\n      ) {\n        if (\n          windowObject.frameElement &&\n          windowObject.location.href == 'about:blank' &&\n          windowObject.frameElement.src != 'about:blank'\n        ) {\n          //LOG.info(\"getReadyState not loaded, frame location was about:blank, but frame src = \" + windowObject.frameElement.src);\n          return null\n        }\n        //LOG.debug(\"getReadyState = windowObject.frames.length = \" + windowObject.frames.length);\n        for (let i = 0; i < windowObject.frames.length; i++) {\n          //LOG.debug(\"i = \" + i);\n          if (\n            this.getReadyState(\n              windowObject.frames[i],\n              windowObject.frames[i].document\n            ) != 'complete'\n          ) {\n            //LOG.debug(\"getReadyState aha! the nested frame \" + windowObject.frames[i].name + \" wasn't ready!\");\n            return null\n          }\n        }\n\n        rs = 'complete'\n      } else {\n        //LOG.debug(\"pollForLoad readyState was null and DOM appeared to not be ready yet\");\n      }\n    }\n  } else if (rs == 'loading' && browserVersion.isIE) {\n    //LOG.debug(\"pageUnloading = true!!!!\");\n    this.pageUnloading = true\n  }\n  //LOG.debug(\"getReadyState returning \" + rs);\n  return rs\n}\n\n/** This function isn't used normally, but was the way we used to schedule pollers:\n asynchronously executed autonomous units.  This is deprecated, but remains here\n for future reference.\n */\nBrowserBot.prototype.XXXreschedulePoller = function(\n  loadFunction,\n  windowObject,\n  originalDocument,\n  originalLocation,\n  originalHref,\n  marker\n) {\n  let self = this\n  window.setTimeout(function() {\n    self.pollForLoad(\n      loadFunction,\n      windowObject,\n      originalDocument,\n      originalLocation,\n      originalHref,\n      marker\n    )\n  }, 500)\n}\n\n/** This function isn't used normally, but is useful for debugging asynchronous pollers\n * To enable it, rename it to \"reschedulePoller\", so it will override the\n * existing reschedulePoller function\n */\nBrowserBot.prototype.XXXreschedulePoller = function(\n  loadFunction,\n  windowObject,\n  originalDocument,\n  originalLocation,\n  originalHref,\n  marker\n) {\n  let doc = this.buttonWindow.document\n  let button = doc.createElement('button')\n  let buttonName = doc.createTextNode(marker + ' - ' + windowObject.name)\n  button.appendChild(buttonName)\n  let tools = doc.getElementById('tools')\n  let self = this\n  button.onclick = function() {\n    tools.removeChild(button)\n    self.pollForLoad(\n      loadFunction,\n      windowObject,\n      originalDocument,\n      originalLocation,\n      originalHref,\n      marker\n    )\n  }\n  tools.appendChild(button)\n  window.setTimeout(button.onclick, 500)\n}\n\nBrowserBot.prototype.reschedulePoller = function(\n  loadFunction,\n  windowObject,\n  originalDocument,\n  originalLocation,\n  originalHref,\n  marker\n) {\n  let self = this\n  let pollerFunction = function() {\n    self.pollForLoad(\n      loadFunction,\n      windowObject,\n      originalDocument,\n      originalLocation,\n      originalHref,\n      marker\n    )\n  }\n  this.windowPollers.push(pollerFunction)\n}\n\nBrowserBot.prototype.runScheduledPollers = function() {\n  //LOG.debug(\"runScheduledPollers\");\n  let oldPollers = this.windowPollers\n  this.windowPollers = new Array()\n  for (let i = 0; i < oldPollers.length; i++) {\n    oldPollers[i].call()\n  }\n  //LOG.debug(\"runScheduledPollers DONE\");\n}\n\nBrowserBot.prototype.isPollingForLoad = function(win) {\n  let marker\n  let frameElement = this._getFrameElement(win)\n  let htaSubFrame = this._isHTASubFrame(win)\n  if (frameElement && !htaSubFrame) {\n    marker = frameElement['frame' + this.uniqueId]\n  } else {\n    marker = win[this.uniqueId]\n  }\n  if (!marker) {\n    //LOG.debug(\"isPollingForLoad false, missing uniqueId \" + this.uniqueId + \": \" + marker);\n    return false\n  }\n  if (!this.pollingForLoad[marker]) {\n    //LOG.debug(\"isPollingForLoad false, this.pollingForLoad[\" + marker + \"]: \" + this.pollingForLoad[marker]);\n    return false\n  }\n  return marker\n}\n\nBrowserBot.prototype.getWindowByName = function(windowName, doNotModify) {\n  //LOG.debug(\"getWindowByName(\" + windowName + \")\");\n  // First look in the map of opened windows\n  let targetWindow = this.openedWindows[windowName]\n  if (!targetWindow) {\n    targetWindow = this.topWindow[windowName]\n  }\n  if (!targetWindow && windowName == '_blank') {\n    for (let winName in this.openedWindows) {\n      // _blank can match selenium_blank*, if it looks like it's OK (valid href, not closed)\n      if (/^selenium_blank/.test(winName)) {\n        targetWindow = this.openedWindows[winName]\n        let ok\n        try {\n          if (!this._windowClosed(targetWindow)) {\n            ok = targetWindow.location.href\n          }\n        } catch (e) {} // eslint-disable-line no-empty\n        if (ok) break\n      }\n    }\n  }\n  if (!targetWindow) {\n    throw new SeleniumError(\n      'Window does not exist. If this looks like a Selenium bug, make sure to read http://seleniumhq.org/docs/02_selenium_ide.html#alerts-popups-and-multiple-windows for potential workarounds.'\n    )\n  }\n  if (browserVersion.isHTA) {\n    try {\n      targetWindow.location.href\n    } catch (e) {\n      targetWindow = window.open('', targetWindow.name)\n      this.openedWindows[targetWindow.name] = targetWindow\n    }\n  }\n  if (!doNotModify) {\n    this._modifyWindow(targetWindow)\n  }\n  return targetWindow\n}\n\n/**\n * Find a window name from the window title.\n */\nBrowserBot.prototype.getWindowNameByTitle = function(windowTitle) {\n  //LOG.debug(\"getWindowNameByTitle(\" + windowTitle + \")\");\n\n  // First look in the map of opened windows and iterate them\n  for (let windowName in this.openedWindows) {\n    let targetWindow = this.openedWindows[windowName]\n\n    // If the target window's title is our title\n    try {\n      // TODO implement Pattern Matching here\n      if (\n        !this._windowClosed(targetWindow) &&\n        targetWindow.document.title == windowTitle\n      ) {\n        return windowName\n      }\n    } catch (e) {\n      // You'll often get Permission Denied errors here in IE\n      // eh, if we can't read this window's title,\n      // it's probably not available to us right now anyway\n    }\n  }\n\n  try {\n    if (this.topWindow.document.title == windowTitle) {\n      return ''\n    }\n  } catch (e) {} // eslint-disable-line no-empty\n  // IE Perm denied\n\n  throw new SeleniumError('Could not find window with title ' + windowTitle)\n}\n\nBrowserBot.prototype.getNonTopWindowNames = function() {\n  let nonTopWindowNames = []\n\n  for (let windowName in this.openedWindows) {\n    let win = this.openedWindows[windowName]\n    if (!this._windowClosed(win) && win != this.topWindow) {\n      nonTopWindowNames.push(windowName)\n    }\n  }\n\n  return nonTopWindowNames\n}\n\nBrowserBot.prototype.getCurrentWindow = function(doNotModify) {\n  if (this.proxyInjectionMode) {\n    return window\n  }\n  let testWindow = core.firefox.unwrap(this.currentWindow)\n  if (!doNotModify) {\n    this._modifyWindow(testWindow)\n    //LOG.debug(\"getCurrentWindow newPageLoaded = false\");\n    this.newPageLoaded = false\n  }\n  testWindow = this._handleClosedSubFrame(testWindow, doNotModify)\n  bot.window_ = testWindow\n  return core.firefox.unwrap(testWindow)\n}\n\n/**\n * Offer a method the end-user can reliably use to retrieve the current window.\n * This should work even for windows with an XPCNativeWrapper. Returns the\n * current window object.\n */\nBrowserBot.prototype.getUserWindow = function() {\n  let userWindow = this.getCurrentWindow(true)\n  return userWindow\n}\n\nBrowserBot.prototype._handleClosedSubFrame = function(testWindow, doNotModify) {\n  if (this.proxyInjectionMode) {\n    return testWindow\n  }\n\n  if (this.isSubFrameSelected) {\n    let missing = true\n    if (\n      testWindow.parent &&\n      testWindow.parent.frames &&\n      testWindow.parent.frames.length\n    ) {\n      for (let i = 0; i < testWindow.parent.frames.length; i++) {\n        let frame = testWindow.parent.frames[i]\n        if (\n          frame == testWindow ||\n          frame.seleniumKey == testWindow.seleniumKey\n        ) {\n          missing = false\n          break\n        }\n      }\n    }\n    if (missing) {\n      //LOG.warn(\"Current subframe appears to have closed; selecting top frame\");\n      this.selectFrame('relative=top')\n      return this.getCurrentWindow(doNotModify)\n    }\n  } else if (this._windowClosed(testWindow)) {\n    //UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/11/25\n    /*var closedError = new SeleniumError(\"Current window or frame is closed!\");\n        closedError.windowClosed = true;\n        throw closedError;*/\n    testWindow = this.topWindow //select live object\n  }\n  return testWindow\n}\n\nBrowserBot.prototype.setShouldHighlightElement = function(shouldHighlight) {\n  this.shouldHighlightLocatedElement = shouldHighlight\n}\n\n/*****************************************************************/\n/* BROWSER-SPECIFIC FUNCTIONS ONLY AFTER THIS LINE */\n\nBrowserBot.prototype._registerAllLocatorFunctions = function() {\n  // TODO - don't do this in the constructor - only needed once ever\n  this.locationStrategies = {}\n  for (let functionName in this) {\n    let result = /^locateElementBy([A-Z].+)$/.exec(functionName)\n    if (result != null) {\n      let locatorFunction = this[functionName]\n      if (typeof locatorFunction != 'function') {\n        continue\n      }\n      // Use a specified prefix in preference to one generated from\n      // the function name\n      let locatorPrefix = locatorFunction.prefix || result[1].toLowerCase()\n      this.locationStrategies[locatorPrefix] = locatorFunction\n    }\n  }\n\n  /**\n   * Find a locator based on a prefix.\n   */\n  this.findElementBy = function(locatorType, locator, inDocument, inWindow) {\n    let locatorFunction = this.locationStrategies[locatorType]\n    if (!locatorFunction) {\n      throw new SeleniumError(\n        \"Unrecognised locator type: '\" + locatorType + \"'\"\n      )\n    }\n    return locatorFunction.call(this, locator, inDocument, inWindow)\n  }\n\n  /**\n   * The implicit locator, that is used when no prefix is supplied.\n   */\n  this.locationStrategies['implicit'] = function(\n    locator,\n    inDocument,\n    inWindow\n  ) {\n    if (locator.startsWith('//')) {\n      return this.locateElementByXPath(locator, inDocument, inWindow)\n    }\n    if (locator.startsWith('document.')) {\n      return this.locateElementByDomTraversal(locator, inDocument, inWindow)\n    }\n    return this.locateElementByIdentifier(locator, inDocument, inWindow)\n  }\n}\n\nBrowserBot.prototype.getDocument = function() {\n  return core.firefox.unwrap(this.getCurrentWindow().document)\n}\n\nBrowserBot.prototype.getTitle = function() {\n  let t = this.getDocument().title\n  if (typeof t == 'string') {\n    t = t.trim()\n  }\n  return t\n}\n\nBrowserBot.prototype.getCookieByName = function(cookieName, doc) {\n  if (!doc) doc = this.getDocument()\n  let ck = doc.cookie\n  if (!ck) return null\n  let ckPairs = ck.split(/;/)\n  for (let i = 0; i < ckPairs.length; i++) {\n    let ckPair = ckPairs[i].trim()\n    let ckNameValue = ckPair.split(/=/)\n    let ckName = decodeURIComponent(ckNameValue[0])\n    if (ckName === cookieName) {\n      return decodeURIComponent(ckNameValue.slice(1).join('='))\n    }\n  }\n  return null\n}\n\nBrowserBot.prototype.getAllCookieNames = function(doc) {\n  if (!doc) doc = this.getDocument()\n  let ck = doc.cookie\n  if (!ck) return []\n  let cookieNames = []\n  let ckPairs = ck.split(/;/)\n  for (let i = 0; i < ckPairs.length; i++) {\n    let ckPair = ckPairs[i].trim()\n    let ckNameValue = ckPair.split(/=/)\n    let ckName = decodeURIComponent(ckNameValue[0])\n    cookieNames.push(ckName)\n  }\n  return cookieNames\n}\n\nBrowserBot.prototype.getAllRawCookieNames = function(doc) {\n  if (!doc) doc = this.getDocument()\n  let ck = doc.cookie\n  if (!ck) return []\n  let cookieNames = []\n  let ckPairs = ck.split(/;/)\n  for (let i = 0; i < ckPairs.length; i++) {\n    let ckPair = ckPairs[i].trim()\n    let ckNameValue = ckPair.split(/=/)\n    let ckName = ckNameValue[0]\n    cookieNames.push(ckName)\n  }\n  return cookieNames\n}\n\nfunction encodeURIComponentWithASPHack(uri) {\n  let regularEncoding = encodeURIComponent(uri)\n  let aggressiveEncoding = regularEncoding.replace('.', '%2E')\n  aggressiveEncoding = aggressiveEncoding.replace('_', '%5F')\n  return aggressiveEncoding\n}\n\nBrowserBot.prototype.deleteCookie = function(cookieName, domain, path, doc) {\n  if (!doc) doc = this.getDocument()\n  let expireDateInMilliseconds = new Date().getTime() + -1 * 1000\n\n  // we can't really be sure if we're dealing with encoded or unencoded cookie names\n  let _cookieName\n  let rawCookieNames = this.getAllRawCookieNames(doc)\n  for (let rawCookieNumber in rawCookieNames) {\n    if (rawCookieNames[rawCookieNumber] == cookieName) {\n      _cookieName = cookieName\n      break\n    } else if (\n      rawCookieNames[rawCookieNumber] == encodeURIComponent(cookieName)\n    ) {\n      _cookieName = encodeURIComponent(cookieName)\n      break\n    } else if (\n      rawCookieNames[rawCookieNumber] ==\n      encodeURIComponentWithASPHack(cookieName)\n    ) {\n      _cookieName = encodeURIComponentWithASPHack(cookieName)\n      break\n    }\n  }\n\n  let cookie = _cookieName + '=deleted; '\n  if (path) {\n    cookie += 'path=' + path + '; '\n  }\n  if (domain) {\n    cookie += 'domain=' + domain + '; '\n  }\n  cookie += 'expires=' + new Date(expireDateInMilliseconds).toGMTString()\n  //LOG.debug(\"Setting cookie to: \" + cookie);\n  doc.cookie = cookie\n}\n\n/** Try to delete cookie, return false if it didn't work */\nBrowserBot.prototype._maybeDeleteCookie = function(\n  cookieName,\n  domain,\n  path,\n  doc\n) {\n  this.deleteCookie(cookieName, domain, path, doc)\n  return !this.getCookieByName(cookieName, doc)\n}\n\nBrowserBot.prototype._recursivelyDeleteCookieDomains = function(\n  cookieName,\n  domain,\n  path,\n  doc\n) {\n  let deleted = this._maybeDeleteCookie(cookieName, domain, path, doc)\n  if (deleted) return true\n  let dotIndex = domain.indexOf('.')\n  if (dotIndex == 0) {\n    return this._recursivelyDeleteCookieDomains(\n      cookieName,\n      domain.substring(1),\n      path,\n      doc\n    )\n  } else if (dotIndex != -1) {\n    return this._recursivelyDeleteCookieDomains(\n      cookieName,\n      domain.substring(dotIndex),\n      path,\n      doc\n    )\n  } else {\n    // No more dots; try just not passing in a domain at all\n    return this._maybeDeleteCookie(cookieName, null, path, doc)\n  }\n}\n\nBrowserBot.prototype._recursivelyDeleteCookie = function(\n  cookieName,\n  domain,\n  path,\n  doc\n) {\n  let slashIndex = path.lastIndexOf('/')\n  let finalIndex = path.length - 1\n  if (slashIndex == finalIndex) {\n    slashIndex--\n  }\n  if (slashIndex != -1) {\n    const deleted = this._recursivelyDeleteCookie(\n      cookieName,\n      domain,\n      path.substring(0, slashIndex + 1),\n      doc\n    )\n    if (deleted) return true\n  }\n  return this._recursivelyDeleteCookieDomains(cookieName, domain, path, doc)\n}\n\nBrowserBot.prototype.recursivelyDeleteCookie = function(\n  cookieName,\n  domain,\n  path,\n  win\n) {\n  if (!win) win = this.getCurrentWindow()\n  let doc = win.document\n  if (!domain) {\n    domain = doc.domain\n  }\n  if (!path) {\n    path = win.location.pathname\n  }\n  let deleted = this._recursivelyDeleteCookie(\n    cookieName,\n    '.' + domain,\n    path,\n    doc\n  )\n  if (deleted) return\n  // Finally try a null path (Try it last because it's uncommon)\n  deleted = this._recursivelyDeleteCookieDomains(\n    cookieName,\n    '.' + domain,\n    null,\n    doc\n  )\n  if (deleted) return\n  throw new SeleniumError(\"Couldn't delete cookie \" + cookieName)\n}\n\n/*\n * Finds an element on the current page, using various lookup protocols\n */\nBrowserBot.prototype.findElementOrNull = function(locator, win) {\n  locator = parse_locator(locator)\n\n  if (win == null) {\n    win = this.getCurrentWindow()\n  }\n  let element = bot.locators.findElement(\n    { [locator.type]: locator.string },\n    win.document\n  )\n  element = core.firefox.unwrap(element)\n\n  // Element was not found by any locator function.\n  return element\n}\n\nBrowserBot.prototype.findElement = function(locator, win) {\n  let element = this.findElementOrNull(locator, win)\n  if (element == null)\n    throw new SeleniumError('Element ' + locator + ' not found')\n  return core.firefox.unwrap(element)\n}\n\n/**\n * Finds a list of elements using the same mechanism as webdriver.\n *\n * @param {string} how The finding mechanism to use.\n * @param {string} using The selector to use.\n * @param {Document|Element} root The root of the search path.\n */\nBrowserBot.prototype.findElementsLikeWebDriver = function(how, using, root) {\n  let by = {}\n  by[how] = using\n\n  let all = bot.locators.findElements(by, root)\n  let toReturn = ''\n\n  for (let i = 0; i < all.length - 1; i++) {\n    toReturn += bot.inject.cache.addElement(core.firefox.unwrap(all[i])) + ','\n  }\n  if (all[all.length - 1]) {\n    toReturn += bot.inject.cache.addElement(\n      core.firefox.unwrap(all[all.length - 1])\n    )\n  }\n\n  return toReturn\n}\n\n/**\n * In non-IE browsers, getElementById() does not search by name.  Instead, we\n * we search separately by id and name.\n */\nBrowserBot.prototype.locateElementByIdentifier = function(\n  identifier,\n  inDocument,\n  inWindow\n) {\n  // HBC - use \"this\" instead of \"BrowserBot.prototype\"; otherwise we lose\n  // the non-prototype fields of the object!\n  return (\n    this.locateElementById(identifier, inDocument, inWindow) ||\n    BrowserBot.prototype.locateElementByName(\n      identifier,\n      inDocument,\n      inWindow\n    ) ||\n    null\n  )\n}\n\n/**\n * Find the element with id - can't rely on getElementById, coz it returns by name as well in IE..\n */\nBrowserBot.prototype.locateElementById = function(identifier, inDocument) {\n  let element = inDocument.getElementById(identifier)\n  if (element && element.getAttribute('id') === identifier) {\n    return element\n  } else if (browserVersion.isIE || browserVersion.isOpera) {\n    // SEL-484\n    let elements = inDocument.getElementsByTagName('*')\n\n    for (let i = 0, n = elements.length; i < n; ++i) {\n      element = elements[i]\n\n      if (element.tagName.toLowerCase() == 'form') {\n        if (element.attributes['id'].nodeValue == identifier) {\n          return element\n        }\n      } else if (element.getAttribute('id') == identifier) {\n        return element\n      }\n    }\n\n    return null\n  } else {\n    return null\n  }\n}\n\n/**\n * Find an element by name, refined by (optional) element-filter\n * expressions.\n */\nBrowserBot.prototype.locateElementByName = function(locator, document) {\n  let elements = document.getElementsByTagName('*')\n  //UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/11/23\n  /*\n        var filters = locator.split(' ');\n        filters[0] = 'name=' + filters[0];\n\n        while (filters.length) {\n            var filter = filters.shift();\n            elements = this.selectElements(filter, elements, 'value');\n        }\n        */\n  let filter = 'name=' + locator\n  elements = this.selectElements(filter, elements, 'value')\n\n  if (elements.length > 0) {\n    return elements[0]\n  }\n  return null\n}\n\n/**\n * Finds an element using by evaluating the specfied string.\n */\nBrowserBot.prototype.locateElementByDomTraversal = function(domTraversal) {\n  let element = null\n\n  //Evalinsandbox\n  // eslint-disable-next-line no-undef\n  let mySandbox = new Components.utils.Sandbox(this.currentWindow.location.href)\n  mySandbox.domTraversal = domTraversal\n  try {\n    // eslint-disable-next-line no-undef\n    element = Components.utils.evalInSandbox(domTraversal, mySandbox)\n    //element = eval(domTraversal);\n  } catch (e) {\n    return null\n  }\n\n  if (!element) {\n    return null\n  }\n\n  return element\n}\n\nBrowserBot.prototype.locateElementByDomTraversal.prefix = 'dom'\n\nBrowserBot.prototype.locateElementByStoredReference = function(locator) {\n  try {\n    return core.locators.findElement('stored=' + locator)\n  } catch (e) {\n    return null\n  }\n}\nBrowserBot.prototype.locateElementByStoredReference.prefix = 'stored'\n\nBrowserBot.prototype.locateElementByWebDriver = function(locator) {\n  try {\n    return core.locators.findElement('webdriver=' + locator)\n  } catch (e) {\n    return null\n  }\n}\nBrowserBot.prototype.locateElementByWebDriver.prefix = 'webdriver'\n\n/**\n * Finds an element identified by the xpath expression. Expressions _must_\n * begin with \"//\".\n */\nBrowserBot.prototype.locateElementByXPath = function(xpath, inDocument) {\n  return this.xpathEvaluator.selectSingleNode(\n    inDocument,\n    xpath,\n    null,\n    inDocument.createNSResolver\n      ? inDocument.createNSResolver(inDocument.documentElement)\n      : this._namespaceResolver\n  )\n}\n\n/**\n * Find many elements using xpath.\n *\n * @param {string} xpath XPath expression to search for.\n * @param {=Document} inDocument The document to search in.\n * @param {=Window} inWindow The window the document is in.\n */\nBrowserBot.prototype.locateElementsByXPath = function(xpath, inDocument) {\n  return this.xpathEvaluator.selectNodes(\n    inDocument,\n    xpath,\n    null,\n    inDocument.createNSResolver\n      ? inDocument.createNSResolver(inDocument.documentElement)\n      : this._namespaceResolver\n  )\n}\n\nBrowserBot.prototype._namespaceResolver = function(prefix) {\n  if (prefix == 'html' || prefix == 'xhtml' || prefix == 'x') {\n    return 'http://www.w3.org/1999/xhtml'\n  } else if (prefix == 'mathml') {\n    return 'http://www.w3.org/1998/Math/MathML'\n  } else if (prefix == 'svg') {\n    return 'http://www.w3.org/2000/svg'\n  } else {\n    throw new Error('Unknown namespace: ' + prefix + '.')\n  }\n}\n\n/**\n * Returns the number of xpath results.\n */\nBrowserBot.prototype.evaluateXPathCount = function(selector, inDocument) {\n  let locator = parse_locator(selector)\n  if (locator.type == 'xpath' || locator.type == 'implicit') {\n    return bot.locators.findElements({ xpath: locator.string }, inDocument)\n      .length\n  } else {\n    //LOG.error(\"Locator does not use XPath strategy: \" + selector);\n    return 0\n  }\n}\n\n/**\n * Returns the number of css results.\n */\nBrowserBot.prototype.evaluateCssCount = function(selector, inDocument) {\n  let locator = parse_locator(selector)\n  if (locator.type == 'css' || locator.type == 'implicit') {\n    return bot.locators.findElements({ css: locator.string }, inDocument).length\n  } else {\n    //LOG.error(\"Locator does not use CSS strategy: \" + selector);\n    return 0\n  }\n}\n\n/**\n * Finds a link element with text matching the expression supplied. Expressions must\n * begin with \"link:\".\n */\nBrowserBot.prototype.locateElementByLinkText = function(linkText, inDocument) {\n  let links = inDocument.getElementsByTagName('a')\n  for (let i = 0; i < links.length; i++) {\n    let element = links[i]\n    if (PatternMatcher.matches(linkText, bot.dom.getVisibleText(element))) {\n      return element\n    }\n  }\n  return null\n}\n\nBrowserBot.prototype.locateElementByLinkText.prefix = 'link'\n\n/**\n * Returns an attribute based on an attribute locator. This is made up of an element locator\n * suffixed with @attribute-name.\n */\nBrowserBot.prototype.findAttribute = function(locator) {\n  // Split into locator + attributeName\n  let attributePos = locator.lastIndexOf('@')\n  let elementLocator = locator.slice(0, attributePos)\n  let attributeName = locator.slice(attributePos + 1)\n\n  // Find the element.\n  let element = this.findElement(elementLocator)\n  let attributeValue = bot.dom.getAttribute(element, attributeName)\n  return goog.isDefAndNotNull(attributeValue) ? attributeValue.toString() : null\n}\n\n/*\n * Select the specified option and trigger the relevant events of the element.\n */\nBrowserBot.prototype.selectOption = function(element, optionToSelect) {\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n  let changed = false\n  for (let i = 0; i < element.options.length; i++) {\n    let option = element.options[i]\n    if (option.selected && option != optionToSelect) {\n      option.selected = false\n      changed = true\n    } else if (!option.selected && option == optionToSelect) {\n      option.selected = true\n      changed = true\n    }\n  }\n\n  if (changed) {\n    bot.events.fire(element, bot.events.EventType.CHANGE)\n  }\n}\n\n/*\n * Select the specified option and trigger the relevant events of the element.\n */\nBrowserBot.prototype.addSelection = function(element, option) {\n  this.checkMultiselect(element)\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n  if (!option.selected) {\n    option.selected = true\n    bot.events.fire(element, bot.events.EventType.CHANGE)\n  }\n}\n\n/*\n * Select the specified option and trigger the relevant events of the element.\n */\nBrowserBot.prototype.removeSelection = function(element, option) {\n  this.checkMultiselect(element)\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n  if (option.selected) {\n    option.selected = false\n    bot.events.fire(element, bot.events.EventType.CHANGE)\n  }\n}\n\nBrowserBot.prototype.checkMultiselect = function(element) {\n  if (!element.multiple) {\n    throw new SeleniumError('Not a multi-select')\n  }\n}\n\nBrowserBot.prototype.replaceText = function(element, stringValue) {\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n  bot.events.fire(element, bot.events.EventType.SELECT)\n  let maxLengthAttr = element.getAttribute('maxLength')\n  let actualValue = stringValue\n  if (maxLengthAttr != null) {\n    let maxLength = parseInt(maxLengthAttr)\n    if (stringValue.length > maxLength) {\n      actualValue = stringValue.substr(0, maxLength)\n    }\n  }\n\n  if (getTagName(element) == 'body') {\n    if (element.ownerDocument && element.ownerDocument.designMode) {\n      let designMode = new String(\n        element.ownerDocument.designMode\n      ).toLowerCase()\n      if (designMode == 'on') {\n        // this must be a rich text control!\n        element.innerHTML = actualValue\n      }\n    }\n  } else {\n    element.value = actualValue\n  }\n  // DGF this used to be skipped in chrome URLs, but no longer.  Is xpcnativewrappers to blame?\n  try {\n    bot.events.fire(element, bot.events.EventType.CHANGE)\n  } catch (e) {} // eslint-disable-line no-empty\n}\n\nBrowserBot.prototype.clickElement = function(element, clientX, clientY) {\n  this._fireEventOnElement('click', element, clientX, clientY)\n}\n\nBrowserBot.prototype.doubleClickElement = function(element, clientX, clientY) {\n  this._fireEventOnElement('dblclick', element, clientX, clientY)\n}\n\n// The contextmenu event is fired when the user right-clicks to open the context menu\nBrowserBot.prototype.contextMenuOnElement = function(\n  element,\n  clientX,\n  clientY\n) {\n  this._fireEventOnElement('contextmenu', element, clientX, clientY)\n}\n\n//UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/05/26\n//UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/11/17\nBrowserBot.prototype._modifyElementTarget = function(e) {\n  let element = this.findClickableElement(e) || e\n  if (element.target) {\n    if (element.target == '_blank' || /^selenium_blank/.test(element.target)) {\n      let tagName = getTagName(element)\n      if (tagName == 'a' || tagName == 'form') {\n        const newTarget = 'win_ser_' + this.count\n        this.count += 1\n        this.browserbot.openWindow('', newTarget)\n        element.target = newTarget\n      }\n    } else {\n      const newTarget = element.target\n      this.browserbot.openWindow('', newTarget)\n      element.target = newTarget\n    }\n  }\n}\n\n//UnnamedWinIFrameExt, Jie-Lin You, SELAB, CSIE, NCKU, 2016/11/17\nBrowserBot.prototype.findClickableElement = function(e) {\n  if (!e.tagName) return null\n  let tagName = e.tagName.toLowerCase()\n  let type = e.type\n  if (\n    e.hasAttribute('onclick') ||\n    e.hasAttribute('href') ||\n    e.hasAttribute('url') ||\n    tagName == 'button' ||\n    (tagName == 'input' &&\n      (type == 'submit' ||\n        type == 'button' ||\n        type == 'image' ||\n        type == 'radio' ||\n        type == 'checkbox' ||\n        type == 'reset'))\n  ) {\n    return e\n  } else {\n    if (e.parentNode != null) {\n      return this.findClickableElement(e.parentNode)\n    } else {\n      return null\n    }\n  }\n}\n\nBrowserBot.prototype._handleClickingImagesInsideLinks = function(\n  targetWindow,\n  element\n) {\n  let itrElement = element\n  while (itrElement != null) {\n    if (itrElement.href) {\n      targetWindow.location.href = itrElement.href\n      break\n    }\n    itrElement = itrElement.parentNode\n  }\n}\n\nBrowserBot.prototype._getTargetWindow = function(element) {\n  let targetWindow = element.ownerDocument.defaultView\n  if (element.target) {\n    targetWindow = this._getFrameFromGlobal(element.target)\n  }\n  return targetWindow\n}\n\nBrowserBot.prototype._getFrameFromGlobal = function(target) {\n  if (target == '_self') {\n    return this.getCurrentWindow()\n  }\n  if (target == '_top') {\n    return this.topFrame\n  } else if (target == '_parent') {\n    return this.getCurrentWindow().parent\n  } else if (target == '_blank') {\n    // TODO should this set cleverer window defaults?\n    return this.getCurrentWindow().open('', '_blank')\n  }\n  let frameElement = this.findElementBy(\n    'implicit',\n    target,\n    this.topFrame.document,\n    this.topFrame\n  )\n  if (frameElement) {\n    return frameElement.contentWindow\n  }\n  let win = this.getWindowByName(target)\n  if (win) return win\n  return this.getCurrentWindow().open('', target)\n}\n\nBrowserBot.prototype.bodyText = function() {\n  if (!this.getDocument().body) {\n    throw new SeleniumError(\n      \"Couldn't access document.body.  Is this HTML page fully loaded?\"\n    )\n  }\n  return bot.dom.getVisibleText(this.getDocument().body)\n}\n\nBrowserBot.prototype.getAllButtons = function() {\n  let elements = this.getDocument().getElementsByTagName('input')\n  let result = []\n\n  for (let i = 0; i < elements.length; i++) {\n    if (\n      elements[i].type == 'button' ||\n      elements[i].type == 'submit' ||\n      elements[i].type == 'reset'\n    ) {\n      result.push(elements[i].id)\n    }\n  }\n\n  return result\n}\n\nBrowserBot.prototype.getAllFields = function() {\n  let elements = this.getDocument().getElementsByTagName('input')\n  let result = []\n\n  for (let i = 0; i < elements.length; i++) {\n    if (elements[i].type == 'text') {\n      result.push(elements[i].id)\n    }\n  }\n\n  return result\n}\n\nBrowserBot.prototype.getAllLinks = function() {\n  let elements = this.getDocument().getElementsByTagName('a')\n  let result = []\n\n  for (let i = 0; i < elements.length; i++) {\n    result.push(elements[i].id)\n  }\n\n  return result\n}\n\nfunction isDefined(value) {\n  return typeof value != undefined\n}\n\nBrowserBot.prototype.goBack = function() {\n  this.getCurrentWindow().history.back()\n}\n\nBrowserBot.prototype.goForward = function() {\n  this.getCurrentWindow().history.forward()\n}\n\nBrowserBot.prototype.close = function() {\n  if (browserVersion.isIE) {\n    // fix \"do you want to close this window\" warning in IE\n    // You can only close windows that you have opened.\n    // So, let's \"open\" it.\n    try {\n      this.topFrame.name = new Date().getTime()\n      window.open('', this.topFrame.name, '')\n      this.topFrame.close()\n      return\n    } catch (e) {} // eslint-disable-line no-empty\n  }\n  if (\n    browserVersion.isChrome ||\n    browserVersion.isSafari ||\n    browserVersion.isOpera\n  ) {\n    this.topFrame.close()\n  } else {\n    this.getCurrentWindow().eval('window.top.close();')\n  }\n}\n\nBrowserBot.prototype.refresh = function() {\n  this.getCurrentWindow().location.reload(true)\n}\n\n/**\n * Refine a list of elements using a filter.\n */\nBrowserBot.prototype.selectElementsBy = function(filterType, filter, elements) {\n  let filterFunction = BrowserBot.filterFunctions[filterType]\n  if (!filterFunction) {\n    throw new SeleniumError(\n      \"Unrecognised element-filter type: '\" + filterType + \"'\"\n    )\n  }\n\n  return filterFunction(filter, elements)\n}\n\nBrowserBot.filterFunctions = {}\n\nBrowserBot.filterFunctions.name = function(name, elements) {\n  let selectedElements = []\n  for (let i = 0; i < elements.length; i++) {\n    if (elements[i].name === name) {\n      selectedElements.push(elements[i])\n    }\n  }\n  return selectedElements\n}\n\nBrowserBot.filterFunctions.value = function(value, elements) {\n  let selectedElements = []\n  for (let i = 0; i < elements.length; i++) {\n    if (elements[i].value === value) {\n      selectedElements.push(elements[i])\n    }\n  }\n  return selectedElements\n}\n\nBrowserBot.filterFunctions.index = function(index, elements) {\n  index = Number(index)\n  if (isNaN(index) || index < 0) {\n    throw new SeleniumError('Illegal Index: ' + index)\n  }\n  if (elements.length <= index) {\n    throw new SeleniumError('Index out of range: ' + index)\n  }\n  return [elements[index]]\n}\n\nBrowserBot.prototype.selectElements = function(\n  filterExpr,\n  elements,\n  defaultFilterType\n) {\n  let filterType = defaultFilterType || 'value'\n\n  // If there is a filter prefix, use the specified strategy\n  let result = filterExpr.match(/^([A-Za-z]+)=(.+)/)\n  if (result) {\n    filterType = result[1].toLowerCase()\n    filterExpr = result[2]\n  }\n\n  return this.selectElementsBy(filterType, filterExpr, elements)\n}\n\n/**\n * Find an element by css selector\n */\nBrowserBot.prototype.locateElementByCss = function(locator, document) {\n  let elements = bot.locators.findElements({ css: locator }, document)\n  if (elements.length != 0) return elements[0]\n  return null\n}\n\n/* prompt */\nBrowserBot.prototype.cancelNextPrompt = function() {\n  return this.setNextPromptResult(null)\n}\n\nBrowserBot.prototype.setNextPromptResult = function(result) {\n  this.promptResponse = false\n  let self = this\n\n  window.postMessage(\n    {\n      direction: 'from-content-script',\n      command: 'setNextPromptResult',\n      target: result,\n    },\n    '*'\n  )\n\n  let response = new Promise(function(resolve, reject) {\n    let count = 0\n    let interval = setInterval(function() {\n      if (!self.promptResponse) {\n        count++\n        if (count > 60) {\n          reject('No response')\n          clearInterval(interval)\n        }\n      } else {\n        resolve()\n        self.promptResponse = false\n        clearInterval(interval)\n      }\n    }, 500)\n  })\n  return response\n}\n\nBrowserBot.prototype.getPromptMessage = function() {\n  this.promptResponse = false\n  this.promptMessage = null\n  let self = this\n  window.postMessage(\n    {\n      direction: 'from-content-script',\n      command: 'getPromptMessage',\n    },\n    '*'\n  )\n  let response = new Promise(function(resolve, reject) {\n    let count = 0\n    let interval = setInterval(function() {\n      if (!self.promptResponse) {\n        count++\n        if (count > 60) {\n          reject('No response')\n          clearInterval(interval)\n        }\n      } else {\n        resolve(self.promptMessage)\n        self.promptResponse = false\n        self.promptMessage = null\n        clearInterval(interval)\n      }\n    }, 500)\n  })\n  return response\n}\n\n// confirm\nBrowserBot.prototype.setNextConfirmationResult = function(result) {\n  this.confirmationResponse = false\n  let self = this\n  window.postMessage(\n    {\n      direction: 'from-content-script',\n      command: 'setNextConfirmationResult',\n      target: result,\n    },\n    '*'\n  )\n  let response = new Promise(function(resolve, reject) {\n    let count = 0\n    let interval = setInterval(function() {\n      if (!self.confirmationResponse) {\n        count++\n        if (count > 60) {\n          reject('No response')\n          clearInterval(interval)\n        }\n      } else {\n        resolve()\n        self.confirmationResponse = false\n        clearInterval(interval)\n      }\n    }, 500)\n  })\n  return response\n}\n\nBrowserBot.prototype.getConfirmationMessage = function() {\n  this.confirmationResponse = false\n  this.confirmationMessage = null\n  let self = this\n  window.postMessage(\n    {\n      direction: 'from-content-script',\n      command: 'getConfirmationMessage',\n    },\n    '*'\n  )\n  let response = new Promise(function(resolve, reject) {\n    let count = 0\n    let interval = setInterval(function() {\n      if (!self.confirmationResponse) {\n        count++\n        if (count > 60) {\n          reject('No response')\n          clearInterval(interval)\n        }\n      } else {\n        resolve(self.confirmationMessage)\n        self.confirmationResponse = false\n        self.confirmationMessage = null\n        clearInterval(interval)\n      }\n    }, 500)\n  })\n  return response\n}\n\nBrowserBot.prototype.getAlertMessage = function() {\n  let self = this\n  let response = new Promise(function(resolve, reject) {\n    let count = 0\n    let interval = setInterval(function() {\n      if (!self.alertResponse) {\n        count++\n        if (count > 60) {\n          reject('No response!!!!')\n          clearInterval(interval)\n        }\n      } else {\n        resolve(self.alertMessage)\n        self.alertResponse = false\n        self.alertMessage = null\n        clearInterval(interval)\n      }\n    }, 500)\n  })\n  return response\n}\n\n/*****************************************************************/\n/* BROWSER-SPECIFIC FUNCTIONS ONLY AFTER THIS LINE */\n\nexport class MozillaBrowserBot extends BrowserBot {\n  constructor(frame) {\n    super(frame)\n  }\n}\n\nexport class KonquerorBrowserBot extends BrowserBot {\n  constructor(frame) {\n    super(frame)\n  }\n}\n\nKonquerorBrowserBot.prototype.setIFrameLocation = function(iframe, location) {\n  // Window doesn't fire onload event when setting src to the current value,\n  // so we set it to blank first.\n  iframe.src = 'about:blank'\n  iframe.src = location\n}\n\nKonquerorBrowserBot.prototype._isSameDocument = function(\n  originalDocument,\n  currentDocument\n) {\n  // under Konqueror, there may be this case:\n  // originalDocument and currentDocument are different objects\n  // while their location are same.\n  if (originalDocument) {\n    return originalDocument.location == currentDocument.location\n  } else {\n    return originalDocument === currentDocument\n  }\n}\n\nexport class SafariBrowserBot extends BrowserBot {\n  constructor(frame) {\n    super(frame)\n  }\n}\n\nSafariBrowserBot.prototype.setIFrameLocation =\n  KonquerorBrowserBot.prototype.setIFrameLocation\n\nexport class OperaBrowserBot extends BrowserBot {\n  constructor(frame) {\n    super(frame)\n  }\n}\n\nOperaBrowserBot.prototype.setIFrameLocation = function(iframe, location) {\n  if (iframe.src == location) {\n    iframe.src = location + '?reload'\n  } else {\n    iframe.src = location\n  }\n}\n\nexport class IEBrowserBot extends BrowserBot {\n  constructor(frame) {\n    super(frame)\n  }\n}\n\nIEBrowserBot.prototype._handleClosedSubFrame = function(\n  testWindow,\n  doNotModify\n) {\n  if (this.proxyInjectionMode) {\n    return testWindow\n  }\n\n  try {\n    testWindow.location.href\n    this.permDenied = 0\n  } catch (e) {\n    this.permDenied++\n  }\n  if (this._windowClosed(testWindow) || this.permDenied > 4) {\n    if (this.isSubFrameSelected) {\n      //LOG.warn(\"Current subframe appears to have closed; selecting top frame\");\n      this.selectFrame('relative=top')\n      return this.getCurrentWindow(doNotModify)\n    } else {\n      let closedError = new SeleniumError('Current window or frame is closed!')\n      closedError.windowClosed = true\n      throw closedError\n    }\n  }\n  return testWindow\n}\n\nIEBrowserBot.prototype.modifyWindowToRecordPopUpDialogs = function(\n  windowToModify,\n  browserBot\n) {\n  BrowserBot.prototype.modifyWindowToRecordPopUpDialogs(\n    windowToModify,\n    browserBot\n  )\n\n  // we will call the previous version of this method from within our own interception\n  let oldShowModalDialog = windowToModify.showModalDialog\n\n  windowToModify.showModalDialog = function(url, args, features) {\n    // Get relative directory to where TestRunner.html lives\n    // A risky assumption is that the user's TestRunner is named TestRunner.html\n    let doc_location = document.location.toString()\n    let end_of_base_ref = doc_location.indexOf('TestRunner.html')\n    let base_ref = doc_location.substring(0, end_of_base_ref)\n    let runInterval = ''\n\n    // Only set run interval if options is defined\n    if (typeof window.runOptions != 'undefined') {\n      runInterval = '&runInterval=' + runOptions.runInterval // eslint-disable-line no-undef\n    }\n\n    let testRunnerURL =\n      'TestRunner.html?auto=true&singletest=' +\n      escape(browserBot.modalDialogTest) +\n      '&autoURL=' +\n      escape(url) +\n      runInterval\n    let fullURL = base_ref + testRunnerURL\n    browserBot.modalDialogTest = null\n\n    // If using proxy injection mode\n    if (this.proxyInjectionMode) {\n      fullURL = url\n    }\n    let returnValue = oldShowModalDialog(fullURL, args, features)\n    return returnValue\n  }\n}\n\nIEBrowserBot.prototype.modifySeparateTestWindowToDetectPageLoads = function(\n  windowObject\n) {\n  this.pageUnloading = false\n  let self = this\n  let pageUnloadDetector = function() {\n    self.pageUnloading = true\n  }\n  if (windowObject.addEventListener) {\n    windowObject.addEventListener('beforeunload', pageUnloadDetector, true)\n  } else {\n    windowObject.attachEvent('onbeforeunload', pageUnloadDetector)\n  }\n  BrowserBot.prototype.modifySeparateTestWindowToDetectPageLoads.call(\n    this,\n    windowObject\n  )\n}\n\nIEBrowserBot.prototype.pollForLoad = function(\n  loadFunction,\n  windowObject,\n  originalDocument,\n  originalLocation,\n  originalHref,\n  marker\n) {\n  //LOG.debug(\"IEBrowserBot.pollForLoad: \" + marker);\n  if (!this.permDeniedCount[marker]) this.permDeniedCount[marker] = 0\n  BrowserBot.prototype.pollForLoad.call(\n    this,\n    loadFunction,\n    windowObject,\n    originalDocument,\n    originalLocation,\n    originalHref,\n    marker\n  )\n  if (this.pageLoadError) {\n    if (this.pageUnloading) {\n      //LOG.debug(\"pollForLoad UNLOADING (\" + marker + \"): caught exception while firing events on unloading page: \" + this.pageLoadError.message);\n      this.reschedulePoller(\n        loadFunction,\n        windowObject,\n        originalDocument,\n        originalLocation,\n        originalHref,\n        marker\n      )\n      this.pageLoadError = null\n      return\n    } else if (\n      (this.pageLoadError.message == 'Permission denied' ||\n        /^Access is denied/.test(this.pageLoadError.message)) &&\n      this.permDeniedCount[marker]++ < 8\n    ) {\n      if (this.permDeniedCount[marker] > 4) {\n        let canAccessThisWindow\n        let canAccessCurrentlySelectedWindow\n        try {\n          windowObject.location.href\n          canAccessThisWindow = true\n        } catch (e) {} // eslint-disable-line no-empty\n        try {\n          this.getCurrentWindow(true).location.href\n          canAccessCurrentlySelectedWindow = true\n        } catch (e) {} // eslint-disable-line no-empty\n        if (canAccessCurrentlySelectedWindow & !canAccessThisWindow) {\n          //LOG.debug(\"pollForLoad (\" + marker + \") ABORTING: \" + this.pageLoadError.message + \" (\" + this.permDeniedCount[marker] + \"), but the currently selected window is fine\");\n          // returning without rescheduling\n          this.pageLoadError = null\n          return\n        }\n      }\n\n      //LOG.debug(\"pollForLoad (\" + marker + \"): \" + this.pageLoadError.message + \" (\" + this.permDeniedCount[marker] + \"), waiting to see if it goes away\");\n      this.reschedulePoller(\n        loadFunction,\n        windowObject,\n        originalDocument,\n        originalLocation,\n        originalHref,\n        marker\n      )\n      this.pageLoadError = null\n      return\n    }\n    //handy for debugging!\n    //throw this.pageLoadError;\n  }\n}\n\nIEBrowserBot.prototype._windowClosed = function(win) {\n  try {\n    let c = win.closed\n    // frame windows claim to be non-closed when their parents are closed\n    // but you can't access their document objects in that case\n    if (!c) {\n      try {\n        win.document\n      } catch (de) {\n        if (de.message == 'Permission denied') {\n          // the window is probably unloading, which means it's probably not closed yet\n          return false\n        } else if (/^Access is denied/.test(de.message)) {\n          // rare variation on \"Permission denied\"?\n          //LOG.debug(\"IEBrowserBot.windowClosed: got \" + de.message + \" (this.pageUnloading=\" + this.pageUnloading + \"); assuming window is unloading, probably not closed yet\");\n          return false\n        } else {\n          // this is probably one of those frame window situations\n          //LOG.debug(\"IEBrowserBot.windowClosed: couldn't read win.document, assume closed: \" + de.message + \" (this.pageUnloading=\" + this.pageUnloading + \")\");\n          return true\n        }\n      }\n    }\n    if (c == null) {\n      //LOG.debug(\"IEBrowserBot.windowClosed: win.closed was null, assuming closed\");\n      return true\n    }\n    return c\n  } catch (e) {\n    //LOG.debug(\"IEBrowserBot._windowClosed: Got an exception trying to read win.closed; we'll have to take a guess!\");\n\n    if (browserVersion.isHTA) {\n      if (e.message == 'Permission denied') {\n        // the window is probably unloading, which means it's not closed yet\n        return false\n      } else {\n        // there's a good chance that we've lost contact with the window object if it is closed\n        return true\n      }\n    } else {\n      // the window is probably unloading, which means it's not closed yet\n      return false\n    }\n  }\n}\n\n/**\n * In IE, getElementById() also searches by name - this is an optimisation for IE.\n */\nIEBrowserBot.prototype.locateElementByIdentifer = function(\n  identifier,\n  inDocument\n) {\n  return inDocument.getElementById(identifier)\n}\n\nSafariBrowserBot.prototype.modifyWindowToRecordPopUpDialogs = function(\n  windowToModify,\n  browserBot\n) {\n  BrowserBot.prototype.modifyWindowToRecordPopUpDialogs(\n    windowToModify,\n    browserBot\n  )\n\n  let originalOpen = windowToModify.open\n  /*\n   * Safari seems to be broken, so that when we manually trigger the onclick method\n   * of a button/href, any window.open calls aren't resolved relative to the app location.\n   * So here we replace the open() method with one that does resolve the url correctly.\n   */\n  windowToModify.open = function(url, windowName, windowFeatures, replaceFlag) {\n    if (\n      url.startsWith('http://') ||\n      url.startsWith('https://') ||\n      url.startsWith('/')\n    ) {\n      return originalOpen(url, windowName, windowFeatures, replaceFlag)\n    }\n\n    // Reduce the current path to the directory\n    let currentPath = windowToModify.location.pathname || '/'\n    currentPath = currentPath.replace(/\\/[^\\/]*$/, '/') // eslint-disable-line no-useless-escape\n\n    // Remove any leading \"./\" from the new url.\n    url = url.replace(/^\\.\\//, '')\n\n    const newUrl = currentPath + url\n\n    let openedWindow = originalOpen(\n      newUrl,\n      windowName,\n      windowFeatures,\n      replaceFlag\n    )\n    //LOG.debug(\"window.open call intercepted; window ID (which you can use with selectWindow()) is \\\"\" +  windowName + \"\\\"\");\n    if (windowName != null) {\n      openedWindow['seleniumWindowName'] = windowName\n    }\n    return openedWindow\n  }\n}\n\nMozillaBrowserBot.prototype._fireEventOnElement = function(\n  eventType,\n  element,\n  clientX,\n  clientY\n) {\n  let win = this.getCurrentWindow()\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n\n  // Add an event listener that detects if the default action has been prevented.\n  // (This is caused by a javascript onclick handler returning false)\n  // we capture the whole event, rather than the getPreventDefault() state at the time,\n  // because we need to let the entire event bubbling and capturing to go through\n  // before making a decision on whether we should force the href\n  element.addEventListener(eventType, function() {}, false)\n\n  //this._modifyElementTarget(element);\n\n  // Trigger the event.\n  this.browserbot.triggerMouseEvent(element, eventType, true, clientX, clientY)\n\n  if (this._windowClosed(win)) {\n    return\n  }\n\n  // Perform the link action if preventDefault was set.\n  // In chrome URL, the link action is already executed by triggerMouseEvent.\n  //if (!browserVersion.isChrome && savedEvent != null && savedEvent.getPreventDefault && !savedEvent.getPreventDefault()) {\n  /*\n    if (!browserVersion.isChrome && savedEvent != null && savedEvent.defaultPrevented && !savedEvent.defaultPrevented()) {\n        var targetWindow = this.browserbot._getTargetWindow(element);\n        if (element.href) {\n            targetWindow.location.href = element.href;\n        } else {\n            this.browserbot._handleClickingImagesInsideLinks(targetWindow, element);\n        }\n    }\n    */\n}\n\nOperaBrowserBot.prototype._fireEventOnElement = function(\n  eventType,\n  element,\n  clientX,\n  clientY\n) {\n  let win = this.getCurrentWindow()\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n\n  this._modifyElementTarget(element)\n\n  // Trigger the click event.\n  this.browserbot.triggerMouseEvent(element, eventType, true, clientX, clientY)\n\n  if (this._windowClosed(win)) {\n    return\n  }\n}\n\nKonquerorBrowserBot.prototype._fireEventOnElement = function(\n  eventType,\n  element,\n  clientX,\n  clientY\n) {\n  let win = this.getCurrentWindow()\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n\n  this._modifyElementTarget(element)\n\n  if (element[eventType]) {\n    element[eventType]()\n  } else {\n    this.browserbot.triggerMouseEvent(\n      element,\n      eventType,\n      true,\n      clientX,\n      clientY\n    )\n  }\n\n  if (this._windowClosed(win)) {\n    return\n  }\n}\n\nSafariBrowserBot.prototype._fireEventOnElement = function(\n  eventType,\n  element,\n  clientX,\n  clientY\n) {\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n  this._modifyElementTarget(element)\n\n  // For form element it is simple.\n  if (element[eventType]) {\n    element[eventType]()\n  }\n  // For links and other elements, event emulation is required.\n  else {\n    // todo: deal with anchors?\n    this.browserbot.triggerMouseEvent(\n      element,\n      eventType,\n      true,\n      clientX,\n      clientY\n    )\n  }\n}\n\nSafariBrowserBot.prototype.refresh = function() {\n  let win = this.getCurrentWindow()\n  if (win.location.hash) {\n    // DGF Safari refuses to refresh when there's a hash symbol in the URL\n    win.location.hash = ''\n    let actuallyReload = function() {\n      win.location.reload(true)\n    }\n    window.setTimeout(actuallyReload, 1)\n  } else {\n    win.location.reload(true)\n  }\n}\n\nIEBrowserBot.prototype._fireEventOnElement = function(\n  eventType,\n  element,\n  clientX,\n  clientY\n) {\n  let win = this.getCurrentWindow()\n  bot.events.fire(element, bot.events.EventType.FOCUS)\n\n  let wasChecked = element.checked\n\n  // Set a flag that records if the page will unload - this isn't always accurate, because\n  // <a href=\"javascript:alert('foo'):\"> triggers the onbeforeunload event, even thought the page won't unload\n  let pageUnloading = false\n  let pageUnloadDetector = function() {\n    pageUnloading = true\n  }\n  if (win.addEventListener) {\n    win.addEventListener('beforeunload', pageUnloadDetector, true)\n  } else {\n    win.attachEvent('onbeforeunload', pageUnloadDetector)\n  }\n  this._modifyElementTarget(element)\n  if (element[eventType]) {\n    element[eventType]()\n  } else {\n    this.browserbot.triggerMouseEvent(\n      element,\n      eventType,\n      true,\n      clientX,\n      clientY\n    )\n  }\n\n  // If the page is going to unload - still attempt to fire any subsequent events.\n  // However, we can't guarantee that the page won't unload half way through, so we need to handle exceptions.\n  try {\n    if (win.removeEventListener) {\n      win.removeEventListener('onbeforeunload', pageUnloadDetector, true)\n    } else {\n      win.detachEvent('onbeforeunload', pageUnloadDetector)\n    }\n\n    if (this._windowClosed(win)) {\n      return\n    }\n\n    // Onchange event is not triggered automatically in IE.\n    if (isDefined(element.checked) && wasChecked != element.checked) {\n      bot.events.fire(element, bot.events.EventType.CHANGE)\n    }\n  } catch (e) {\n    // If the page is unloading, we may get a \"Permission denied\" or \"Unspecified error\".\n    // Just ignore it, because the document may have unloaded.\n    if (pageUnloading) {\n      //LOG.logHook = function() {\n      //};\n      //LOG.warn(\"Caught exception when firing events on unloading page: \" + e.message);\n      return\n    }\n    throw e\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content/selenium-browserbot.js","// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nimport SeleniumError from './SeleniumError'\n\nexport default function PatternMatcher(pattern) {\n  this.selectStrategy(pattern)\n}\n\nPatternMatcher.prototype = {\n  selectStrategy: function(pattern) {\n    this.pattern = pattern\n    let strategyName = 'glob'\n    // by default\n    if (/^([a-z-]+):(.*)/.test(pattern)) {\n      const possibleNewStrategyName = RegExp.$1\n      const possibleNewPattern = RegExp.$2\n      if (PatternMatcher.strategies[possibleNewStrategyName]) {\n        strategyName = possibleNewStrategyName\n        pattern = possibleNewPattern\n      }\n    }\n    const matchStrategy = PatternMatcher.strategies[strategyName]\n    if (!matchStrategy) {\n      throw new SeleniumError(\n        'cannot find PatternMatcher.strategies.' + strategyName\n      )\n    }\n    this.strategy = matchStrategy\n    this.matcher = new matchStrategy(pattern)\n  },\n\n  matches: function(actual) {\n    return this.matcher.matches(actual + '')\n    // Note: appending an empty string avoids a Konqueror bug\n  },\n}\n\n/**\n * A \"static\" convenience method for easy matching\n */\nPatternMatcher.matches = function(pattern, actual) {\n  return new PatternMatcher(pattern).matches(actual)\n}\n\nPatternMatcher.strategies = {\n  /**\n   * Exact matching, e.g. \"exact:***\"\n   */\n  exact: function(expected) {\n    this.expected = expected\n    this.matches = function(actual) {\n      return actual == this.expected\n    }\n  },\n\n  /**\n   * Match by regular expression, e.g. \"regexp:^[0-9]+$\"\n   */\n  regexp: function(regexpString) {\n    this.regexp = new RegExp(regexpString)\n    this.matches = function(actual) {\n      return this.regexp.test(actual)\n    }\n  },\n\n  regex: function(regexpString) {\n    this.regexp = new RegExp(regexpString)\n    this.matches = function(actual) {\n      return this.regexp.test(actual)\n    }\n  },\n\n  regexpi: function(regexpString) {\n    this.regexp = new RegExp(regexpString, 'i')\n    this.matches = function(actual) {\n      return this.regexp.test(actual)\n    }\n  },\n\n  regexi: function(regexpString) {\n    this.regexp = new RegExp(regexpString, 'i')\n    this.matches = function(actual) {\n      return this.regexp.test(actual)\n    }\n  },\n\n  /**\n   * \"globContains\" (aka \"wildmat\") patterns, e.g. \"glob:one,two,*\",\n   * but don't require a perfect match; instead succeed if actual\n   * contains something that matches globString.\n   * Making this distinction is motivated by a bug in IE6 which\n   * leads to the browser hanging if we implement *TextPresent tests\n   * by just matching against a regular expression beginning and\n   * ending with \".*\".  The globcontains strategy allows us to satisfy\n   * the functional needs of the *TextPresent ops more efficiently\n   * and so avoid running into this IE6 freeze.\n   */\n  globContains: function(globString) {\n    this.regexp = new RegExp(PatternMatcher.regexpFromGlobContains(globString))\n    this.matches = function(actual) {\n      return this.regexp.test(actual)\n    }\n  },\n\n  /**\n   * \"glob\" (aka \"wildmat\") patterns, e.g. \"glob:one,two,*\"\n   */\n  glob: function(globString) {\n    this.regexp = new RegExp(PatternMatcher.regexpFromGlob(globString))\n    this.matches = function(actual) {\n      return this.regexp.test(actual)\n    }\n  },\n}\n\nPatternMatcher.convertGlobMetaCharsToRegexpMetaChars = function(glob) {\n  let re = glob\n  re = re.replace(/([.^$+(){}\\[\\]\\\\|])/g, '\\\\$1') // eslint-disable-line no-useless-escape\n  re = re.replace(/\\?/g, '(.|[\\r\\n])')\n  re = re.replace(/\\*/g, '(.|[\\r\\n])*')\n  return re\n}\n\nPatternMatcher.regexpFromGlobContains = function(globContains) {\n  return PatternMatcher.convertGlobMetaCharsToRegexpMetaChars(globContains)\n}\n\nPatternMatcher.regexpFromGlob = function(glob) {\n  return '^' + PatternMatcher.convertGlobMetaCharsToRegexpMetaChars(glob) + '$'\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content/PatternMatcher.js","// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n// Modified in tools.js from selenium-IDE\n\nexport function exactMatchPattern(string) {\n  if (\n    string != null &&\n    (string.match(/^\\w*:/) ||\n      string.indexOf('?') >= 0 ||\n      string.indexOf('*') >= 0)\n  ) {\n    return 'exact:' + string\n  } else {\n    return string\n  }\n}\n\nclass TargetSelector {\n  constructor(callback, cleanupCallback) {\n    this.callback = callback\n    this.cleanupCallback = cleanupCallback\n    // This is for XPCOM/XUL addon and can't be used\n    //var wm = Components.classes[\"@mozilla.org/appshell/window-mediator;1\"].getService(Components.interfaces.nsIWindowMediator);\n    //this.win = wm.getMostRecentWindow('navigator:browser').getBrowser().contentWindow;\n\n    // Instead, we simply assign global content window to this.win\n    this.win = window\n    const doc = this.win.document\n    const div = doc.createElement('div')\n    div.setAttribute('style', 'display: none;')\n    doc.body.insertBefore(div, doc.body.firstChild)\n    this.div = div\n    this.e = null\n    this.r = null\n    this.banner = doc.createElement('div')\n    this.banner.setAttribute(\n      'style',\n      'position: fixed;top: 0;left: 0;bottom: 0;right: 0;background: trasparent;z-index: 10000;'\n    )\n    const header = doc.createElement('div')\n    header.setAttribute(\n      'style',\n      \"pointer-events: none;display: flex;align-items: center;justify-content: center;flex-direction: row;position: fixed;top: 20%;left: 50%;transform: translateX(-50%);background: #f7f7f7;color: #114990;font-size: 22px;font-weight: 200;z-index: 10001;font-family: system, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;box-shadow: 0 7px 10px 0 rgba(0,0,0,0.1);border: 1px black solid; border-radius: 50px;padding: 10px;\"\n    )\n    const img = doc.createElement('img')\n    img.src = browser.runtime.getURL('/icons/icon_light128.png')\n    img.setAttribute('style', 'width: 28px;margin: 0 10px;')\n    header.appendChild(img)\n    const span = doc.createElement('span')\n    span.setAttribute(\n      'style',\n      'border-left: 1px solid #c6c6c6;padding: 3px 10px;'\n    )\n    span.innerText = 'Select an element'\n    header.appendChild(span)\n    setTimeout(() => {\n      // this has to happen after a timeout, since adding it sync will add the event\n      // before the window is focused which will case mousemove to fire before the\n      // user actually moves the mouse\n      this.banner.addEventListener(\n        'mousemove',\n        () => {\n          setTimeout(() => {\n            this.banner.style.visibility = 'hidden'\n          }, 300)\n        },\n        false\n      )\n    }, 300)\n    this.banner.appendChild(header)\n    doc.body.insertBefore(this.banner, div)\n    doc.addEventListener('mousemove', this, true)\n    doc.addEventListener('click', this, true)\n  }\n\n  cleanup() {\n    try {\n      if (this.div) {\n        if (this.div.parentNode) {\n          this.div.parentNode.removeChild(this.div)\n        }\n        this.div = null\n      }\n      if (this.header) {\n        if (this.header.parentNode) {\n          this.header.parentNode.removeChild(this.header)\n        }\n        this.header = null\n      }\n      if (this.win) {\n        const doc = this.win.document\n        doc.removeEventListener('mousemove', this, true)\n        doc.removeEventListener('click', this, true)\n      }\n    } catch (e) {\n      if (e != \"TypeError: can't access dead object\") {\n        throw e\n      }\n    }\n    this.win = null\n    if (this.cleanupCallback) {\n      this.cleanupCallback()\n    }\n  }\n\n  handleEvent(evt) {\n    switch (evt.type) {\n      case 'mousemove':\n        this.highlight(evt.target.ownerDocument, evt.clientX, evt.clientY)\n        break\n      case 'click':\n        if (evt.button == 0 && this.e && this.callback) {\n          this.callback(this.e, this.win)\n        } //Right click would cancel the select\n        evt.preventDefault()\n        evt.stopPropagation()\n        this.cleanup()\n        break\n    }\n  }\n\n  highlight(doc, x, y) {\n    if (doc) {\n      const e = doc.elementFromPoint(x, y)\n      if (e && e != this.e) {\n        this.highlightElement(e)\n      }\n    }\n  }\n\n  highlightElement(element) {\n    if (element && element != this.e && element !== this.banner) {\n      this.e = element\n    } else {\n      return\n    }\n    const r = element.getBoundingClientRect()\n    const or = this.r\n    if (r.left >= 0 && r.top >= 0 && r.width > 0 && r.height > 0) {\n      if (\n        or &&\n        r.top == or.top &&\n        r.left == or.left &&\n        r.width == or.width &&\n        r.height == or.height\n      ) {\n        return\n      }\n      this.r = r\n      const style =\n        'pointer-events: none; position: absolute; background-color: rgb(78, 171, 230); opacity: 0.4; border: 1px solid #0e0e0e; z-index: 1000000;'\n      const pos = `top:${r.top + this.win.scrollY}px; left:${r.left +\n        this.win.scrollX}px; width:${r.width}px; height:${r.height}px;`\n      this.div.setAttribute('style', style + pos)\n    } else if (or) {\n      this.div.setAttribute('style', 'display: none;')\n    }\n  }\n}\n\nexport default TargetSelector\n\n\n\n// WEBPACK FOOTER //\n// ./content/targetSelector.js","// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nconst coords = {\n  startX: 0,\n  startY: 0,\n  endX: 0,\n  endY: 0,\n}\n\nconst mouseOffset = {\n  x: 0,\n  y: 0,\n}\n\nconst STATES = {\n  create: 1,\n  update: 2,\n  resize: 3,\n}\n\nlet state = STATES.create\nlet canvasExists = false\n\nexport function editRegion(rect, cb) {\n  if (canvasExists) {\n    return cb(false)\n  }\n  const container = document.createElement('div')\n  container.id = 'selenium-container'\n  const canvas = document.createElement('div')\n  canvas.id = 'selenium-canvas'\n  const region = createRegion()\n  setStyle(canvas, region)\n  setEvents(container)\n  const buttonContainer = createButtons(cb)\n  buttonContainer.style.zIndex = '10002'\n  if (rect) {\n    region.style.left = `${rect.x}px`\n    region.style.top = `${rect.y}px`\n    region.style.width = `${rect.width}px`\n    region.style.height = `${rect.height}px`\n  }\n  container.appendChild(buttonContainer)\n  container.appendChild(canvas)\n  container.appendChild(region)\n  document.body.appendChild(container)\n  canvasExists = true\n}\n\nexport function removeRegion() {\n  if (canvasExists) {\n    document.body.removeChild(document.getElementById('selenium-container'))\n  }\n  canvasExists = false\n}\n\nfunction setStyle(canvas, region) {\n  canvas.style.position = 'fixed'\n  canvas.style.top = 0\n  canvas.style.bottom = 0\n  canvas.style.right = 0\n  canvas.style.left = 0\n  canvas.style.zIndex = '10000'\n  canvas.style.cursor = 'crosshair'\n\n  region.style.position = 'absolute'\n  region.style.zIndex = '10001'\n  region.style.backgroundColor = 'rgb(78, 171, 230)'\n  region.style.opacity = '0.4'\n  region.style.border = '1px solid #0e0e0e'\n}\n\nfunction setEvents(container) {\n  container.addEventListener('mousedown', mousedown)\n  container.addEventListener('mouseup', mouseup)\n}\n\nfunction mousedown(e) {\n  const container = document.getElementById('selenium-container')\n  const canvas = document.getElementById('selenium-canvas')\n  const region = document.getElementById('selenium-region')\n  e.stopPropagation()\n  if (e.target.tagName === 'BUTTON') return\n  if (e.target === canvas) {\n    updateRegion(e.pageX, e.pageY, e.pageX, e.pageY)\n    state = STATES.create\n    region.style.cursor = 'crosshair'\n  } else if (e.target === region) {\n    state = STATES.update\n    mouseOffset.x = e.pageX\n    mouseOffset.y = e.pageY\n    region.style.cursor = 'move'\n  } else if (e.target.parentElement === region) {\n    state = STATES.resize\n  }\n  container.addEventListener('mousemove', mousemove)\n}\n\nfunction mousemove(e) {\n  e.stopPropagation()\n  if (e.target.tagName === 'BUTTON') return\n  if (state === STATES.create || state === STATES.resize) {\n    updateRegion(undefined, undefined, e.pageX, e.pageY)\n  } else if (state === STATES.update) {\n    moveRegion(e.pageX, e.pageY)\n  }\n}\n\nfunction mouseup(e) {\n  const container = document.getElementById('selenium-container')\n  const canvas = document.getElementById('selenium-canvas')\n  const region = document.getElementById('selenium-region')\n  e.stopPropagation()\n  region.style.cursor = 'move'\n  canvas.style.cursor = 'crosshair'\n  container.removeEventListener('mousemove', mousemove)\n  showButtons()\n}\n\nfunction calculateRectFromCoords(coords) {\n  return calculateRect(\n    { x: coords.startX, y: coords.startY },\n    { x: coords.endX, y: coords.endY }\n  )\n}\n\nfunction calculateRect(p1, p2) {\n  return {\n    left: Math.min(p1.x, p2.x),\n    top: Math.min(p1.y, p2.y),\n    width: Math.abs(p1.x - p2.x),\n    height: Math.abs(p1.y - p2.y),\n  }\n}\n\nfunction updateRegion(startX, startY, endX, endY) {\n  hideButtons()\n  const region = document.getElementById('selenium-region')\n  if (startX) {\n    coords.startX = startX\n  }\n  if (startY) {\n    coords.startY = startY\n  }\n  if (endX) {\n    coords.endX = endX\n  }\n  if (endY) {\n    coords.endY = endY\n  }\n  const rect = calculateRectFromCoords(coords)\n  region.style.left = `${rect.left}px`\n  region.style.top = `${rect.top}px`\n  region.style.width = `${rect.width}px`\n  region.style.height = `${rect.height}px`\n}\n\nfunction moveRegion(mouseX, mouseY) {\n  let dx = mouseOffset.x - mouseX\n  let dy = mouseOffset.y - mouseY\n  mouseOffset.x = mouseX\n  mouseOffset.y = mouseY\n  if (coords.startX - dx < 5 || coords.endX - dx < 5) dx = 0\n  if (coords.startY - dy < 5 || coords.endY - dy < 5) dy = 0\n  updateRegion(\n    coords.startX - dx,\n    coords.startY - dy,\n    coords.endX - dx,\n    coords.endY - dy\n  )\n}\n\nfunction createRegion() {\n  const region = document.createElement('div')\n  region.id = 'selenium-region'\n\n  const cornerSize = 20\n\n  const tlc = createHotCorner(cornerSize)\n  tlc.style.top = '-5px'\n  tlc.style.left = '-5px'\n  tlc.style.cursor = 'nw-resize'\n\n  tlc.addEventListener('mousedown', () => {\n    const canvas = document.getElementById('selenium-canvas')\n    const region = document.getElementById('selenium-region')\n    canvas.style.cursor = 'nw-resize'\n    region.style.cursor = 'nw-resize'\n    updateRegion(\n      Math.max(coords.startX, coords.endX),\n      Math.max(coords.startY, coords.endY),\n      Math.min(coords.startX, coords.endX),\n      Math.min(coords.startY, coords.endY)\n    )\n  })\n\n  region.appendChild(tlc)\n\n  const trc = createHotCorner(cornerSize)\n  trc.style.top = '-5px'\n  trc.style.right = '-5px'\n  trc.style.cursor = 'ne-resize'\n\n  trc.addEventListener('mousedown', () => {\n    const canvas = document.getElementById('selenium-canvas')\n    const region = document.getElementById('selenium-region')\n    canvas.style.cursor = 'ne-resize'\n    region.style.cursor = 'ne-resize'\n    updateRegion(\n      Math.min(coords.startX, coords.endX),\n      Math.max(coords.startY, coords.endY),\n      Math.max(coords.startX, coords.endX),\n      Math.min(coords.startY, coords.endY)\n    )\n  })\n\n  region.appendChild(trc)\n\n  const blc = createHotCorner(cornerSize)\n  blc.style.bottom = '-5px'\n  blc.style.left = '-5px'\n  blc.style.cursor = 'sw-resize'\n\n  blc.addEventListener('mousedown', () => {\n    const canvas = document.getElementById('selenium-canvas')\n    const region = document.getElementById('selenium-region')\n    canvas.style.cursor = 'sw-resize'\n    region.style.cursor = 'sw-resize'\n    updateRegion(\n      Math.max(coords.startX, coords.endX),\n      Math.min(coords.startY, coords.endY),\n      Math.min(coords.startX, coords.endX),\n      Math.max(coords.startY, coords.endY)\n    )\n  })\n\n  region.appendChild(blc)\n\n  const brc = createHotCorner(cornerSize)\n  brc.style.bottom = '-5px'\n  brc.style.right = '-5px'\n  brc.style.cursor = 'se-resize'\n\n  brc.addEventListener('mousedown', () => {\n    const canvas = document.getElementById('selenium-canvas')\n    const region = document.getElementById('selenium-region')\n    canvas.style.cursor = 'se-resize'\n    region.style.cursor = 'se-resize'\n    updateRegion(\n      Math.min(coords.startX, coords.endX),\n      Math.min(coords.startY, coords.endY),\n      Math.max(coords.startX, coords.endX),\n      Math.max(coords.startY, coords.endY)\n    )\n  })\n\n  region.appendChild(brc)\n\n  return region\n}\n\nfunction createHotCorner(size) {\n  const c = document.createElement('div')\n  c.style.position = 'absolute'\n  c.style.height = `${size}px`\n  c.style.width = `${size}px`\n\n  return c\n}\n\nfunction showButtons() {\n  const canvasRect = document\n    .getElementById('selenium-canvas')\n    .getBoundingClientRect()\n  const buttonContainer = document.getElementById('region-control-panel')\n  let top = coords.startY\n  let bottom = coords.endY\n  let left = coords.startX\n  let right = coords.endX\n  let width = right - left\n  if (canvasRect.bottom - bottom <= 100) bottom = top\n  if (width < 0) left = coords.endX\n  right = coords.startX\n  width = Math.abs(width)\n  if (width < 225) width = 225\n  buttonContainer.style.position = 'absolute'\n  buttonContainer.style.top = bottom + 'px'\n  buttonContainer.style.left = left + 'px'\n  buttonContainer.style.right = right + 'px'\n  buttonContainer.style.width = width + 'px'\n  buttonContainer.style.backgroundColor = 'rgba(0, 0, 0, 0.55)'\n  buttonContainer.style.visibility = 'visible'\n}\n\nfunction hideButtons() {\n  const buttonContainer = document.getElementById('region-control-panel')\n  buttonContainer.style.visibility = 'hidden'\n}\n\nfunction createButtons(cb) {\n  const container = document.createElement('div')\n  container.id = 'region-control-panel'\n  const buttons = document.createElement('div')\n  const confirm = document.createElement('button')\n  confirm.innerText = 'Confirm'\n  confirm.addEventListener('click', () => {\n    hideButtons()\n    removeRegion()\n    const rect = calculateRectFromCoords(coords)\n    cb(\n      `x: ${rect.left}, y: ${rect.top}, width: ${rect.width}, height: ${\n        rect.height\n      }`\n    )\n  })\n  const cancel = document.createElement('button')\n  cancel.innerText = 'Cancel'\n  cancel.addEventListener('click', () => {\n    hideButtons()\n    removeRegion()\n    cb(false)\n  })\n\n  container.style.visibility = 'hidden'\n  buttons.style.display = 'flex'\n  buttons.style.alignItems = 'center'\n  buttons.style.justifyContent = 'center'\n\n  styleButton(confirm)\n  styleButton(cancel)\n\n  buttons.appendChild(cancel)\n  buttons.appendChild(confirm)\n  container.appendChild(buttons)\n  return container\n}\n\nfunction styleButton(button) {\n  button.style.color = '#656565'\n  button.style.backgroundColor = '#F5F5F5'\n  button.style.padding = '10px 20px'\n  button.style.margin = '5px 8px'\n  button.style.borderRadius = '4px'\n  button.style.outline = '0'\n  button.style.textTransform = 'capitalize'\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content/region.js","// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nimport browser from 'webextension-polyfill'\n\nlet handler, elementForInjectingScript\nexport function attach(selenium) {\n  elementForInjectingScript = document.createElement('script')\n  elementForInjectingScript.src = browser.runtime.getURL('/assets/prompt.js')\n  ;(document.head || document.documentElement).appendChild(\n    elementForInjectingScript\n  )\n\n  if (window === window.top) {\n    handler = e => {\n      return handleMessage(e, selenium)\n    }\n    window.addEventListener('message', handler)\n  }\n}\n\nexport function detach() {\n  window.postMessage(\n    {\n      direction: 'from-content-script',\n      detach: true,\n    },\n    '*'\n  )\n  elementForInjectingScript.parentNode.removeChild(elementForInjectingScript)\n  window.removeEventListener('message', handler)\n}\n\nfunction handleMessage(event, selenium) {\n  if (\n    event.source.top == window &&\n    event.data &&\n    event.data.direction == 'from-page-script'\n  ) {\n    if (event.data.response) {\n      switch (event.data.response) {\n        case 'prompt':\n          selenium.browserbot.promptResponse = true\n          if (event.data.value)\n            selenium.browserbot.promptMessage = event.data.value\n          break\n        case 'confirm':\n          selenium.browserbot.confirmationResponse = true\n          if (event.data.value)\n            selenium.browserbot.confirmationMessage = event.data.value\n          break\n        case 'alert':\n          selenium.browserbot.alertResponse = true\n          if (event.data.value)\n            selenium.browserbot.alertMessage = event.data.value\n          break\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content/prompt-injector.js"],"sourceRoot":""}